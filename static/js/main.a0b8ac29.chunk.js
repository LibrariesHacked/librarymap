(this.webpackJsonplibrarymap=this.webpackJsonplibrarymap||[]).push([[0],{112:function(e){e.exports=JSON.parse('{"api":"https://api.librarydata.uk","mobilesApi":"https://api.mobilelibraries.org/api","isochroneApi":"https://api-geography.librarydata.uk/rest/routing/isochrone/","postcodeApi":"https://api-geography.librarydata.uk/rest/postcodes/","libraryTiles":"https://api.librarydata.uk/libraries/{z}/{x}/{y}.mvt","libraryBuildingsTiles":"https://api.librarydata.uk/libraries/buildings/{z}/{x}/{y}.mvt","libraryAuthorityTiles":"https://api-geography.librarydata.uk/rest/libraryauthorities/{z}/{x}/{y}.mvt","servicesApi":"https://api-geography.librarydata.uk/rest/libraryauthorities","stopTiles":"https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt","tripTiles":"https://api.mobilelibraries.org/api/trips/{z}/{x}/{y}.mvt","travel":[{"description":"Walking time","name":"foot-walking","duration":1200,"interval":300,"colour":"#1b5e20"},{"description":"Cycling time","name":"cycling-regular","duration":900,"interval":180,"colour":"#900"},{"description":"Driving time","name":"driving-car","duration":300,"interval":60,"colour":"#b71c1c"}]}')},365:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=365},395:function(e,t,a){e.exports=a.p+"static/media/data.1208a6bf.md"},404:function(e,t,a){e.exports=a(497)},497:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(19),i=a.n(o),l=a(17),c=a(537),s=a(396),u=a.n(s),p=a(266),d=a.n(p),m=a(128),f=a(536),b=Object(r.createContext)(),h=function(e){var t=e.reducer,a=e.initialState,o=e.children;return n.a.createElement(b.Provider,{value:Object(r.useReducer)(t,a)},o)},g=function(){return Object(r.useContext)(b)},y=Object(r.createContext)(),E=function(e){var t=e.reducer,a=e.initialState,o=e.children;return n.a.createElement(y.Provider,{value:Object(r.useReducer)(t,a)},o)},v=function(){return Object(r.useContext)(y)},x=Object(r.createContext)(),O=function(e){var t=e.reducer,a=e.initialState,o=e.children;return n.a.createElement(x.Provider,{value:Object(r.useReducer)(t,a)},o)},S=function(){return Object(r.useContext)(x)},k=a(16),j=a.n(k),w=a(23),C=a(95),_=a(18),L=a(102),P=a(32),I=a(524),N=a(342),B=a(517),M=a(523),T=a(520),z=a(519),A=a(343),D=a(521),F=a(337),R=a(341),Z=a(340),H=a(522),W=a(338),J=a(339),U=a(98),q=a(139),G=a(336),Y=a(20),Q=a(498),V=a(110),$=a.n(V),X=a(374),K=a.n(X),ee=a(206),te=a.n(ee),ae=a(208),re=a.n(ae),ne=a(375),oe=a.n(ne),ie=a(75),le=a(76),ce=a(63),se=a.n(ce),ue=a(103),pe=a.n(ue),de=a(112),me=function(){function e(t){Object(ie.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.routeIds=e.route_ids,this.routeNames=e.route_names,this.mobileIds=e.mobile_ids,this.mobileNames=e.mobile_names,this.organisationId=e.organisation_id,this.organisationName=e.organisation_name,this.name=e.name,this.community=e.community,this.address=e.address,this.postcode=e.postcode,this.arrivalTimes=e.arrival_times,this.departureTimes=e.departure_times,this.routeStart=pe()(e.route_start),this.routeEnd=pe()(e.route_end),this.routeDays=e.route_days,this.routeFrequencies=e.route_frequencies,this.routeSchedule=e.route_schedule.map((function(e){return pe()(e)})),this.timetable=e.timetable,this.longitude=e.longitude,this.latitude=e.latitude,this}}]),e}();function fe(e,t,a,r){return be.apply(this,arguments)}function be(){return(be=Object(w.a)(j.a.mark((function e(t,a,r,n){var o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=de.mobilesApi+"/stops?page="+(t.page+1)+"&limit="+t.pageSize,t.orderBy&&t.orderBy.field&&(o=o+"&sort="+t.orderBy.field+"&direction="+t.orderDirection),a&&a.length>1&&(o=o+"&longitude="+a[0]+"&latitude="+a[1]),r&&""!==r&&(o=o+"&distance="+r),n.length>0&&(o=o+"&service_codes="+n.join("|")),e.next=7,se.a.get(o);case 7:if(!((i=e.sent)&&i.data&&i.data.length>0)){e.next=12;break}return e.abrupt("return",{stops:i.data.map((function(e){return(new me).fromJson(e)})),total:parseInt(i.headers["x-total-count"]),page:parseInt(i.headers["x-page"])});case 12:return e.abrupt("return",{stops:[],total:0,page:1});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(w.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.a.get(de.mobilesApi+"/stops/"+t);case 2:if(!(a=e.sent)||!a.data){e.next=7;break}return e.abrupt("return",(new me).fromJson(a.data));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ye=a(112),Ee=Object(G.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},dialogContentActions:{backgroundColor:"#ffebee",border:"1px solid #ffcdd2",borderRadius:3,padding:4},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)},tablePaper:{}}}));var ve=function(){var e=v(),t=Object(_.a)(e,2),a=t[0].currentStopId,o=t[1],i=S(),l=Object(_.a)(i,2),c=l[0].stopDialogOpen,s=l[1],u=Object(r.useState)({}),p=Object(_.a)(u,2),d=p[0],m=p[1];Object(r.useEffect)((function(){function e(){return(e=Object(w.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(t);case 2:a=e.sent,m(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=a&&function(t){e.apply(this,arguments)}(a)}),[a]);var f=function(){o({type:"SetCurrentStop",currentStopId:null,currentPoint:null}),s({type:"SetStopDialog",stopDialogOpen:!1})},b=Object(Y.a)(),h=Ee(),g=Object(Q.a)(b.breakpoints.down("sm"));return n.a.createElement(B.a,{fullScreen:g,disableBackdropClick:!0,open:c,onClose:f,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:h.dialog}},Object.keys(d).length>0&&d.routeDays?n.a.createElement(n.a.Fragment,null,n.a.createElement(z.a,{id:"dlg-title"},d.name),n.a.createElement(T.a,null,n.a.createElement(U.a,{component:"h3",variant:"subtitle1"},"Mobile library stop in "+d.community+" "+d.organisationName),n.a.createElement(U.a,{component:"p",variant:"body2"},d.address),n.a.createElement(D.a,null,"Schedules"),n.a.createElement(H.a,{component:q.a,elevation:0,className:h.tablePaper},n.a.createElement(F.a,{size:"small"},n.a.createElement(W.a,null,n.a.createElement(J.a,null,n.a.createElement(Z.a,null,"Frequency"),n.a.createElement(Z.a,{align:"right"},"Next visit"))),n.a.createElement(R.a,null,d.routeFrequencies.map((function(e,t){return n.a.createElement(J.a,{key:"tc_rs_"+t},n.a.createElement(Z.a,{component:"th",scope:"row"},e),n.a.createElement(Z.a,{align:"right"},d.routeSchedule[0].format("dddd Do MMMM h:mma")))}))))),n.a.createElement("br",null),n.a.createElement("div",{className:h.dialogContentActions},n.a.createElement(N.a,{onClick:function(){return window.open(d.timetable,"_blank")},color:"primary",startIcon:n.a.createElement(te.a,null)},"Go to website"),n.a.createElement(N.a,{onClick:function(){return window.open(ye.api+"/stops/"+d.id+"/ics")},className:h.button,color:"primary",startIcon:n.a.createElement(K.a,null)},"Get calendar"),n.a.createElement(N.a,{onClick:function(){return window.open(ye.api+"/stops/"+d.id+"/pdf","_blank")},className:h.button,color:"primary",startIcon:n.a.createElement(oe.a,null)},"Print"),n.a.createElement(N.a,{onClick:function(){s({type:"SetMapPosition",mapPosition:[d.longitude,d.latitude],mapZoom:14})},className:h.button,color:"primary",startIcon:n.a.createElement(re.a,null),component:L.b,to:"/map"},"See on map")))):n.a.createElement(A.a,{className:h.progress,color:"primary",size:30}),n.a.createElement(M.a,null,n.a.createElement(N.a,{onClick:function(){return f()},color:"secondary",endIcon:n.a.createElement($.a,null)},"Close")))},xe=a(112),Oe={LAL:"Local authority library","LAL-":"Local authority run - unstaffed",CL:"Commissioned library",CRL:"Community run library",IL:"Independent library"},Se=function(){function e(t){Object(ie.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.localAuthority=e["Local authority"],this.localAuthorityCode=e["Local authority code"],this.name=e["Library name"],this.address1=e["Address 1"],this.address2=e["Address 2"],this.address3=e["Address 3"],this.postcode=e.Postcode,this.postcodeLongitude=e["Postcode longitude"],this.postcodeLatitude=e["Postcode latitude"],this.uprn=e["Unique property reference number"],this.uprnLongitude=e["Unique property reference number longitude"],this.uprnLongitude=e["Unique property reference number latitude"],this.statutory=e.Statutory,this.type=e["Library type"],this.typeDescription=Oe[e["Library type"]],this.yearOpened=e["Year opened"],this.yearClosed=e["Year closed"],this.mondayStaffedHours=e["Monday staffed hours"],this.tuesdayStaffedHours=e["Tuesday staffed hours"],this.wednesdayStaffedHours=e["Wednesday staffed hours"],this.thursdayStaffedHours=e["Thursday staffed hours"],this.fridayStaffedHours=e["Friday staffed hours"],this.saturdaydayStaffedHours=e["Saturday staffed hours"],this.sundayStaffedHours=e["Sunday staffed hours"],this.mondayUnstaffedHours=e["Monday unstaffed hours"],this.tuesdayUnstaffedHours=e["Tuesday unstaffed hours"],this.wednesdayUnstaffedHours=e["Wednesday unstaffed hours"],this.thursdayUnstaffedHours=e["Thursday unstaffed hours"],this.fridayUnstaffedHours=e["Friday unstaffed hours"],this.saturdaydayUnstaffedHours=e["Saturday unstaffed hours"],this.sundayUnstaffedHours=e["Sunday unstaffed hours"],this.colocated=e["Co-located"],this.colocatedWith=e["Co-located with"],this.notes=e.Notes,this.url=e.URL,this.emailAddress=e["Email address"],this.longitude=e.Longitude,this.latitude=e.Latitude,this}}]),e}();function ke(e,t,a,r){return je.apply(this,arguments)}function je(){return(je=Object(w.a)(j.a.mark((function e(t,a,r,n){var o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=xe.api+"/libraries?page="+(t.page+1)+"&limit="+t.pageSize,t.orderBy&&t.orderBy.field&&(o=o+"&sort="+t.orderBy.field+"&direction="+t.orderDirection),a&&a.length>1&&(o=o+"&longitude="+a[0]+"&latitude="+a[1]),r&&""!==r&&(o=o+"&distance="+r),n.length>0&&(o=o+"&service_codes="+n.join("|")),e.next=7,se.a.get(o);case 7:if(!((i=e.sent)&&i.data&&i.data.length>0)){e.next=12;break}return e.abrupt("return",{libraries:i.data.map((function(e){return(new Se).fromJson(e)})),total:parseInt(i.headers["x-total-count"]),page:parseInt(i.headers["x-page"])});case 12:return e.abrupt("return",{libraries:[],total:0,page:1});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=Object(w.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.a.get(xe.api+"/libraries/"+t);case 2:if(!(a=e.sent)||!a.data){e.next=7;break}return e.abrupt("return",(new Se).fromJson(a.data));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _e=Object(G.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},dialogContentActions:{backgroundColor:"#ffebee",border:"1px solid #ffcdd2",borderRadius:3,padding:4},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)}}}));var Le=function(){var e=v(),t=Object(_.a)(e,2),a=t[0].currentLibraryId,o=t[1],i=S(),l=Object(_.a)(i,2),c=l[0].libraryDialogOpen,s=l[1],u=Object(r.useState)({}),p=Object(_.a)(u,2),d=p[0],m=p[1];Object(r.useEffect)((function(){function e(){return(e=Object(w.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(t);case 2:a=e.sent,m(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=a&&function(t){e.apply(this,arguments)}(a)}),[a]);var f=function(){o({type:"SetCurrentLibrary",currentLibraryId:null,currentPoint:null}),s({type:"SetLibraryDialog",libraryDialogOpen:!1})},b=Object(Y.a)(),h=_e(),g=Object(Q.a)(b.breakpoints.down("sm"));return n.a.createElement(B.a,{fullScreen:g,disableBackdropClick:!0,open:c,onClose:f,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:h.dialog}},Object.keys(d).length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(z.a,{id:"dlg-title"},d.name),n.a.createElement(T.a,null,n.a.createElement(U.a,{component:"h3",variant:"subtitle1"},d.typeDescription+" in "+d.localAuthority+". "),n.a.createElement(U.a,{component:"p",variant:"body2"},[d.address1,d.address2,d.address3,d.postcode].filter((function(e){return Boolean(e)})).join(", ")),n.a.createElement(D.a,{disableSticky:!0},"Actions"),n.a.createElement("div",{className:h.dialogContentActions},n.a.createElement(N.a,{onClick:function(){return window.open(d.timetable,"_blank")},color:"primary",startIcon:n.a.createElement(te.a,null)},"Go to website"),n.a.createElement(N.a,{onClick:function(){s({type:"SetMapPosition",mapPosition:[d.longitude,d.latitude],mapZoom:14})},className:h.button,color:"primary",startIcon:n.a.createElement(re.a,null),component:L.b,to:"/map"},"See on map")))):n.a.createElement(A.a,{className:h.progress,color:"primary",size:30}),n.a.createElement(M.a,null,n.a.createElement(N.a,{onClick:function(){return f()},color:"secondary",endIcon:n.a.createElement($.a,null)},"Close")))},Pe=a(525),Ie=a(371),Ne=a(370),Be=a(265),Me=a(527),Te=a(538),ze=a(346),Ae=a(344),De=a(382),Fe=a.n(De),Re=a(274),Ze=a.n(Re),He=a(275),We=a.n(He),Je=a(383),Ue=a.n(Je),qe=a(380),Ge=a.n(qe),Ye=a(231),Qe=a.n(Ye),Ve=a(381),$e=a.n(Ve),Xe=a(209),Ke=a.n(Xe),et=a(230),tt=a.n(et),at=a(400),rt=a(195),nt=a(345),ot=a(119),it=a(377),lt=a.n(it),ct=a(378),st=a.n(ct),ut=a(112);function pt(e){return dt.apply(this,arguments)}function dt(){return(dt=Object(w.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.a.get(ut.postcodeApi+t);case 2:return a=e.sent,e.abrupt("return",{location:[a.data.longitude,a.data.latitude],organisation:a.data.library_service_name});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e){new URLSearchParams(window.location.search).delete("service"),e.push(window.location.pathname)}var ft=Object(G.a)((function(e){return{grow:{flexGrow:1},iconButton:{padding:e.spacing(1)},inputInput:{paddingTop:e.spacing(1),paddingRight:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(1),fontWeight:e.typography.fontWeightBold},search:{position:"relative",border:"1px solid #E0E0E0",borderRadius:e.shape.borderRadius,backgroundColor:Object(ot.fade)(e.palette.common.white,.8),"&:hover":{backgroundColor:Object(ot.fade)(e.palette.common.white,.9)},marginLeft:0,marginRight:e.spacing(0),display:"flex",maxWidth:215}}}));var bt=Object(P.withRouter)((function(e){var t=e.settings,a=g(),o=Object(_.a)(a,2),i=(o[0].services,o[1],v()),l=Object(_.a)(i,2),c=l[0],s=c.searchType,u=c.searchPostcode,p=(c.searchDistance,l[1]),d=S(),m=Object(_.a)(d,2),f=m[0].loadingPostcode,b=m[1],h=Object(r.useState)(u),y=Object(_.a)(h,2),E=y[0],x=y[1],O=Object(r.useState)(null),k=Object(_.a)(O,2),C=k[0],L=k[1],P=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current}({searchPostcode:u});Object(r.useEffect)((function(){P&&u!==P.searchPostcode&&x(u)}),[u]);var I=function(){return L(null)},N=function(e){I(),p({type:"SetSearchDistance",searchDistance:e}),"postcode"===s&&B()},B=function(){var t=Object(w.a)(j.a.mark((function t(){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b({type:"ToggleLoadingPostcode"}),""!==E){t.next=4;break}return b({type:"ShowNotification",notificationMessage:"You must enter a postcode"}),t.abrupt("return");case 4:if(!function(e){return/^[A-Z]{1,2}\d[A-Z\d]? ?\d[A-Z]{2}$/.test(e)}(E.trim())){t.next=13;break}return t.next=8,pt(E.trim());case 8:a=t.sent,mt(e.history),p({type:"SetPostcodeSearch",searchPostcode:E,searchPosition:a.location}),t.next=14;break;case 13:b({type:"ShowNotification",notificationMessage:"Is that a valid postcode? Please check."});case 14:b({type:"ToggleLoadingPostcode"});case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),M=ft();return n.a.createElement("div",{className:M.search},n.a.createElement(at.a,{placeholder:"Postcode",classes:{input:M.inputInput},value:E,onChange:function(e){return x(e.target.value.toUpperCase())}}),n.a.createElement("div",{className:M.grow}),"postcode"===s?n.a.createElement(Ae.a,{title:"Clear search"},n.a.createElement(Be.a,{className:M.iconButton,onClick:function(){return p({type:"ClearAll"})}},n.a.createElement(lt.a,null))):null,n.a.createElement(Ae.a,{title:"Search by postcode"},n.a.createElement(Be.a,{color:"primary",className:M.iconButton,disabled:f,onClick:function(){return B()}},n.a.createElement(Ke.a,null))),t?n.a.createElement(Ae.a,{title:"Change search settings"},n.a.createElement(Be.a,{className:M.iconButton,color:"secondary",onClick:function(e){!function(e){L(e.currentTarget)}(e)}},n.a.createElement(st.a,null))):null,n.a.createElement(rt.a,{id:"mnu-settings",anchorEl:C,keepMounted:!0,open:Boolean(C),onClose:function(){return I()}},n.a.createElement(D.a,{disableSticky:!0},"Search distance"),n.a.createElement(nt.a,{onClick:function(){return N(1609)}},"1 mile"),n.a.createElement(nt.a,{onClick:function(){return N(4827)}},"3 miles"),n.a.createElement(nt.a,{onClick:function(){return N(8045)}},"5 miles"),n.a.createElement(nt.a,{onClick:function(){return N(16090)}},"10 miles"),n.a.createElement(nt.a,{onClick:function(){return N(32180)}},"20 miles"),n.a.createElement(nt.a,{onClick:function(){return N(80450)}},"50 miles")))})),ht=a(379),gt=a.n(ht),yt=Object(G.a)((function(e){return{button:{marginRight:e.spacing(1)},chip:{marginRight:e.spacing(1)}}}));var Et=Object(P.withRouter)((function(e){var t=g(),a=Object(_.a)(t,1)[0],o=a.services,i=a.serviceLookup,l=v(),c=Object(_.a)(l,2),s=c[0].serviceFilter,u=c[1],p=S(),d=Object(_.a)(p,2);Object(C.a)(d[0]);var m=d[1],f=Object(r.useState)(null),b=Object(_.a)(f,2),h=b[0],y=b[1],E=function(){return y(null)},x=function(t){var a=JSON.parse(t.bbox).coordinates[0];u({type:"FilterByService",service:t}),m({type:"FitToBounds",bounds:[a[0],a[2]]}),function(e,t){var a=new URLSearchParams(window.location.search);a.set("service",t),e.push(window.location.pathname+"?"+a.toString())}(e.history,t.systemName),E()},O=yt();return n.a.createElement(n.a.Fragment,null,0===s.length?n.a.createElement(Ae.a,{title:"Choose library service"},n.a.createElement(N.a,{color:"primary",className:O.button,onClick:function(e){return t=e.currentTarget,y(t);var t},startIcon:n.a.createElement(gt.a,null)},"Choose service")):n.a.createElement(Ie.a,{className:O.chip,color:"primary",onDelete:function(){u({type:"ClearAll"}),mt(e.history)},label:i[s[0]].name}),n.a.createElement(rt.a,{id:"menu-library-service",anchorEl:h,keepMounted:!0,open:Boolean(h),onClose:function(){return E()}},o.sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return n.a.createElement(nt.a,{key:"mnu_itm_org_"+e.code,onClick:function(){return x(e)}},e.name)}))))})),vt=Object(G.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"white",position:"relative"},appBarTransparent:{zIndex:e.zIndex.drawer+1,backgroundColor:"rgba(250, 250, 250, 0.8)",position:"relative"},grow:{flexGrow:1},siteTitle:{margin:e.spacing(1),padding:e.spacing(1),display:"inline-block",verticalAlign:"middle",color:e.palette.primary.main,backgroundColor:"rgba(250, 250, 250, 0.8)",border:"1px solid #e5e5e5",borderRadius:26},siteTitleIcon:{verticalAlign:"sub"},title:{margin:e.spacing(2),display:"inline-block",verticalAlign:"middle"},topIcon:{backgroundColor:"rgba(250, 250, 250, 0.8)",border:"1px solid #e5e5e5","&:hover":{backgroundColor:"rgba(250, 250, 250, 0.8)"}},topTitle:{position:"relative",zIndex:e.zIndex.drawer+1}}}));var xt=function(e){var t=e.site,a=v(),o=Object(_.a)(a,2),i=o[0].currentServiceSystemName,l=(o[1],Object(r.useState)(!1)),c=Object(_.a)(l,2),s=c[0],u=c[1],p=Object(r.useState)(t),d=Object(_.a)(p,2),m=d[0],f=d[1],b=Object(P.useLocation)(),h=vt(),g=function(e){return i?e+"?service="+i:e},y=[{title:"Library lab",url:"https://www.librarylab.uk",icon:n.a.createElement(tt.a,null),links:[{title:"About library lab",short:"Lab",icon:n.a.createElement(tt.a,null),to:"/"}]},{title:"Libraries at home",url:"https://www.librariesathome.co.uk",icon:n.a.createElement(Ge.a,null),links:[{title:"Find service",short:"Find",icon:n.a.createElement(Ke.a,null),to:g("/")},{title:"Watch library TV",short:"Watch",icon:n.a.createElement($e.a,null),to:"/watch"},{title:"Read blogs",short:"Read",icon:n.a.createElement(Fe.a,null),to:"/read"},{title:"Listen podcasts",short:"Listen",icon:n.a.createElement(Ue.a,null),to:"/listen"}]},{title:"Mobile libraries",url:"https://www.mobilelibraries.org",icon:n.a.createElement(Ze.a,null),links:[{title:"Find my stop",short:"Stops",icon:n.a.createElement(We.a,null),to:"/stops"},{title:"Mobile vans",short:"Vans",icon:n.a.createElement(Ze.a,null),to:"/"},{title:"Map of stops",short:"Map",icon:n.a.createElement(Qe.a,null),to:"/map"}]},{title:"Library map",url:"https://www.librarymap.co.uk",icon:n.a.createElement(Qe.a,null),links:[{title:"Find my library",short:"Find",icon:n.a.createElement(We.a,null),to:g("/")},{title:"Map of libraries",short:"Map",icon:n.a.createElement(Qe.a,null),to:g("/map")}]}],E="/map"===b.pathname?h.appBarTransparent:h.appBar;return n.a.createElement(n.a.Fragment,null,n.a.createElement(I.a,{maxWidth:"lg",className:h.topTitle},n.a.createElement(ze.a,null,n.a.createElement(Be.a,{className:h.topIcon,color:"primary",onClick:function(){u(!s),f(t)}},s?n.a.createElement($.a,null):n.a.createElement(tt.a,null)),n.a.createElement("span",{className:h.grow}),"/map"===b.pathname?n.a.createElement(Et,null):null,n.a.createElement(Ie.a,{label:y[t].title,color:"secondary"}))),s?n.a.createElement(Pe.a,{position:"static",color:"default",elevation:0,className:E},n.a.createElement(I.a,{maxWidth:"lg"},n.a.createElement(Te.a,{centered:!0,value:m,onChange:function(e,t){f(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"secondary"},y.map((function(e,t){return n.a.createElement(Me.a,{key:"tb_site_"+t,label:e.title,icon:e.icon})}))))):null,n.a.createElement(Pe.a,{position:"static",color:"inherit",elevation:0,className:E},n.a.createElement(I.a,{maxWidth:"lg"},n.a.createElement(ze.a,null,n.a.createElement(Ne.a,{mdUp:!0},y[m].links.map((function(e,a){return n.a.createElement(Ae.a,{title:e.title,key:"icnb_menu_lg_"+a},n.a.createElement(N.a,{component:L.b,to:m===t?e.to:y[m].url+e.to,disableRipple:b.pathname===e.to,disableFocusRipple:b.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon},e.short))}))),n.a.createElement(Ne.a,{smDown:!0},y[m].links.map((function(e,a){return n.a.createElement(Ae.a,{title:e.title,key:"icnb_menu_lg_"+a},n.a.createElement(N.a,{component:L.b,to:m===t?e.to:y[m].url+e.to,disableRipple:b.pathname===e.to,disableFocusRipple:b.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon},e.title))}))),n.a.createElement("span",{className:h.grow}),"/map"===b.pathname?n.a.createElement(bt,null):null))))},Ot=a(384),St=a.n(Ot),kt=a(528),jt=a(529),wt=a(530),Ct=a(385),_t=a.n(Ct),Lt=Object(G.a)((function(e){return{root:{paddingTop:e.spacing(5),marginTop:e.spacing(3),marginBottom:e.spacing(5),width:"100%"},grid:{marginTop:e.spacing(2)},loveIcon:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},footerText:{verticalAlign:"middle",display:"inline-flex"},footerRight:{textAlign:"right"},tapTarget:{lineHeight:2.2,fontSize:16}}}));var Pt=function(){var e=Lt();return n.a.createElement("div",{className:e.root},n.a.createElement(kt.a,null),n.a.createElement(jt.a,{container:!0,spacing:3,className:e.grid},n.a.createElement(jt.a,{item:!0,xs:12,sm:6,md:6,lg:6,xl:6},n.a.createElement(U.a,{variant:"body1",className:e.footerText},"A library lab project built by Libraries Hacked."),n.a.createElement("br",null),n.a.createElement(U.a,{variant:"button"},n.a.createElement(wt.a,{component:St.a,to:"/data",title:"Maintaining the data used on this site and licensing",className:e.tapTarget},"Data"),n.a.createElement("br",null),n.a.createElement(wt.a,{href:"https://github.com/LibrariesHacked/librarymap",target:"_blank",title:"Project on GitHub",className:e.tapTarget},"GitHub"),n.a.createElement("br",null),n.a.createElement(wt.a,{href:"https://www.librarylab.co.uk",target:"_blank",title:"About the library lab projects and documentation for each",className:e.tapTarget},"About Library lab"))),n.a.createElement(jt.a,{className:e.footerRight,item:!0,xs:12,sm:6,md:6,lg:6,xl:6},n.a.createElement(U.a,{variant:"body1",className:e.footerText},"To the memory of Paul Rowe ",n.a.createElement(_t.a,{color:"primary",className:e.loveIcon})),n.a.createElement("br",null),n.a.createElement(U.a,{variant:"button"},n.a.createElement(wt.a,{href:"https://www.mind.org.uk/donate/",title:"Donate to Mind",className:e.tapTarget,target:"_blank"},"Donate to Mind")))))},It=a(532),Nt=a(533),Bt=a(348),Mt=a(29),Tt=a(278),zt=a.n(Tt),At=a(387),Dt=a.n(At),Ft=a(389),Rt=a.n(Ft),Zt=a(388),Ht=a.n(Zt),Wt=a(539),Jt=a(386),Ut=a.n(Jt),qt=Object(G.a)((function(e){return{avatar:{margin:0},avatarOn:{margin:0,cursor:"pointer",backgroundColor:e.palette.primary.main}}}));var Gt=function(){var e=v(),t=Object(_.a)(e,1)[0].searchType,a=qt();return n.a.createElement(Ae.a,{title:"Me"},n.a.createElement(Wt.a,{className:"gps"===t?a.avatarOn:a.avatar},n.a.createElement(Ut.a,null)))},Yt=a(347),Qt=a(531),Vt=Object(G.a)((function(){return{dialog:{border:"1px solid #E0E0E0"}}}));var $t=function(){var e=S(),t=Object(_.a)(e,2),a=t[0],r=a.mapSettings,o=a.mapSettingsDialogOpen,i=t[1],l=function(){i({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!1})},c=Vt(),s=Object(Y.a)(),u=Object(Q.a)(s.breakpoints.down("sm"));return n.a.createElement(B.a,{fullScreen:u,disableBackdropClick:!0,open:o,onClose:l,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:c.dialog}},n.a.createElement(z.a,null,"Map settings"),n.a.createElement(T.a,null,n.a.createElement(D.a,{disableSticky:!0},"Display"),n.a.createElement(Yt.a,{control:n.a.createElement(Qt.a,{checked:r.libraries,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"libraries"})},name:"sw_libraries",color:"primary"}),label:"Libraries"}),n.a.createElement("br",null),n.a.createElement(Yt.a,{control:n.a.createElement(Qt.a,{checked:r.mobileLibraryStops,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"mobileLibraryStops"})},name:"sw_mobile_library_stops",color:"primary"}),label:"Mobile library stops"}),n.a.createElement("br",null),n.a.createElement(Yt.a,{control:n.a.createElement(Qt.a,{checked:r.authorityBoundary,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"authorityBoundary"})},name:"sw_authority_boundary",color:"primary"}),label:"Library service boundaries"})),n.a.createElement(M.a,null,n.a.createElement(N.a,{onClick:l,color:"secondary",endIcon:n.a.createElement($.a,null)},"Close")))},Xt=a(112),Kt=function(){function e(t){Object(ie.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e,t){return this.transport=t,this.geo=e,this.display=!0,this}}]),e}();function ea(e,t){return ta.apply(this,arguments)}function ta(){return(ta=Object(w.a)(j.a.mark((function e(t,a){var r,n,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Xt.travel.filter((function(e){return e.name===a}))[0],n=Xt.isochroneApi+a+"?longitude="+t[0]+"&latitude="+t[1]+"&interval="+r.interval+"&duration="+r.duration,e.next=4,se.a.get(n);case 4:if(!(o=e.sent)||!o.data){e.next=9;break}return e.abrupt("return",(new Kt).fromJson(o.data,a));case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var aa=Object(G.a)((function(e){return{listItemRoot:{minWidth:34},menu:{border:"1px solid #E0E0E0"},settings:{position:"absolute",bottom:e.spacing(4),right:e.spacing(4)}}})),ra=a(112),na=Object(Mt.f)({minZoom:5,maxZoom:18,customAttribution:"Contains public sector information licensed under the Open Government Licence"}),oa=[ra.libraryTiles],ia=[ra.libraryBuildingsTiles],la=[ra.libraryAuthorityTiles],ca=[ra.stopTiles],sa=[ra.tripTiles];var ua=function(){var e=g(),t=Object(_.a)(e,2),a=t[0].isochrones,o=t[1],i=v(),l=Object(_.a)(i,2),c=l[0],s=c.searchType,u=c.searchPosition,p=c.currentStopId,d=c.currentLibraryId,m=c.currentPoint,f=c.currentService,b=l[1],h=S(),y=Object(_.a)(h,2),E=y[0],x=E.mapZoom,O=E.mapPosition,k=E.mapSettings,C=E.mapSettingsDialogOpen,L=E.mapBounds,P=E.isochronesMenuOpen,I=E.isochronesMenuAnchor,N=y[1];Object(r.useEffect)((function(){}),[]);var B=function(){var e=Object(w.a)(j.a.mark((function e(t){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.features&&t.features.length>0&&t.features[0].properties)){e.next=7;break}return a=t.features[0].properties.id,e.next=4,we(a);case 4:r=e.sent,b({type:"SetCurrentLibrary",currentLibraryId:a,currentPoint:[r.longitude,r.latitude]}),N({type:"SetIsochronesMenu",isochronesMenuOpen:!0,isochronesMenuAnchor:{left:t.point.x,top:t.point.y}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(w.a)(j.a.mark((function e(t){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.features&&t.features.length>0&&t.features[0].properties)){e.next=7;break}return a=t.features[0].properties.id,e.next=4,he(a);case 4:r=e.sent,b({type:"SetCurrentStop",currentStopId:a,currentPoint:[r.longitude,r.latitude]}),N({type:"SetIsochronesMenu",isochronesMenuOpen:!0,isochronesMenuAnchor:{left:t.point.x,top:t.point.y}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(w.a)(j.a.mark((function e(t){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a[m]||!a[m][t]){e.next=4;break}o({type:"SetIsochroneDisplay",point:m,transport:t,display:!a[m][t].display}),e.next=8;break;case 4:return e.next=6,ea(m,t);case 6:r=e.sent,o({type:"AddIsochrone",point:m,transport:t,isochrone:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){return N({type:"SetIsochronesMenu",isochronesMenuOpen:!1,isochronesMenuAnchor:null})},A=aa(),D={"cycling-regular":n.a.createElement(Dt.a,{fontSize:"small",color:a[m]&&a[m]["cycling-regular"]&&a[m]["cycling-regular"].display?"primary":"secondary"}),"driving-car":n.a.createElement(Ht.a,{fontSize:"small",color:a[m]&&a[m]["driving-car"]&&a[m]["driving-car"].display?"primary":"secondary"}),"foot-walking":n.a.createElement(Rt.a,{fontSize:"small",color:a[m]&&a[m]["foot-walking"]&&a[m]["foot-walking"].display?"primary":"secondary"})};return n.a.createElement(n.a.Fragment,null,n.a.createElement(na,{style:"style.json",center:O,zoom:x,maxZoom:18,pitch:[0],bearing:[0],fitBounds:L,containerStyle:{top:0,bottom:0,right:0,left:0,height:"100vh",width:"100vw",position:"absolute"}},f&&f.geom?n.a.createElement(Mt.a,{data:JSON.parse(f.geom),linePaint:{"line-opacity":.4,"line-width":2,"line-color":"#455a64"}}):null,Object.keys(a).map((function(e){return Object.keys(a[e]).filter((function(t){return a[e][t].display})).map((function(t,r){return n.a.createElement("span",{key:"sp_isotransport_"+r},n.a.createElement(Mt.a,{data:a[e][t].geo,fillPaint:{"fill-opacity":.1,"fill-antialias":!0,"fill-color":ra.travel.filter((function(e){return e.name===t}))[0].colour},fillOnClick:function(e){}}),n.a.createElement(Mt.a,{data:a[e][t].geo,linePaint:{"line-opacity":.4,"line-width":2,"line-color":ra.travel.filter((function(e){return e.name===t}))[0].colour}}),n.a.createElement(Mt.a,{data:a[e][t].geo,symbolLayout:{"text-field":["concat",["to-string",["/",["get","value"],60]]," min"],"text-font":["Source Sans Pro Bold"],"symbol-placement":"line","text-allow-overlap":!1,"text-padding":2,"text-max-angle":90,"text-size":{base:1.2,stops:[[8,12],[22,30]]},"text-letter-spacing":.1},symbolPaint:{"text-halo-color":"rgba(255, 255, 255, 0.9)","text-halo-width":4,"text-halo-blur":2,"text-color":ra.travel.filter((function(e){return e.name===t}))[0].colour}}),n.a.createElement(Mt.a,{data:a[e][t].geo,symbolLayout:{"text-field":["concat",["get","total_pop"]],"text-font":["Source Sans Pro Bold"],"symbol-placement":"line","text-allow-overlap":!1,"text-keep-upright":!1,"text-padding":2,"text-max-angle":0,"text-offset":[0,1],"text-size":{base:1.2,stops:[[10,8],[22,14]]},"text-letter-spacing":.1},symbolPaint:{"text-halo-color":"rgba(255, 255, 255, 0.9)","text-halo-width":0,"text-halo-blur":0,"text-color":ra.travel.filter((function(e){return e.name===t}))[0].colour}}))}))})),n.a.createElement(Mt.d,{id:"src_libraries_buildings",tileJsonSource:{type:"vector",tiles:ia}}),n.a.createElement(Mt.b,{id:"lyr_library_buildings_lines",type:"line",sourceId:"src_libraries_buildings",sourceLayer:"library_buildings",minZoom:14,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#455a64","line-opacity":.8,"line-width":["interpolate",["linear"],["zoom"],14,2,18,3]}}),n.a.createElement(Mt.b,{id:"lyr_library_buildings_fill",type:"fill",sourceId:"src_libraries_buildings",sourceLayer:"library_buildings",minZoom:14,paint:{"fill-color":"#455a64","fill-opacity":.3}}),n.a.createElement(Mt.d,{id:"src_library_authorities",tileJsonSource:{type:"vector",tiles:la}}),k.authorityBoundary?n.a.createElement(n.a.Fragment,null,n.a.createElement(Mt.b,{id:"lyr_library_authorities_lines",type:"line",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],6,1,18,4]}}),n.a.createElement(Mt.b,{id:"lyr_library_authorities_fill",type:"fill",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,paint:{"fill-color":"#ccc","fill-opacity":.1}})):null,n.a.createElement(Mt.d,{id:"src_trips",tileJsonSource:{type:"vector",tiles:sa}}),n.a.createElement(Mt.b,{id:"lyr_trips_lines",type:"line",sourceId:"src_trips",sourceLayer:"trip",minZoom:14,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-offset":["interpolate",["linear"],["zoom"],14,1,18,4],"line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],14,1,18,4],"line-dasharray":[2,.5]}}),n.a.createElement(Mt.d,{id:"src_stops",tileJsonSource:{type:"vector",tiles:ca}}),k.mobileLibraryStops?n.a.createElement(n.a.Fragment,null,n.a.createElement(Mt.b,{id:"lyr_stops_circles",type:"circle",sourceId:"src_stops",sourceLayer:"stop",minZoom:5,layout:{},paint:{"circle-radius":["interpolate",["linear"],["zoom"],5,2,18,8],"circle-color":"#455a64","circle-stroke-width":["interpolate",["linear"],["zoom"],5,1,18,3],"circle-stroke-color":"#ffffff","circle-opacity":.5},onClick:M}),n.a.createElement(Mt.b,{id:"lyr_stops_labels",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:13,layout:{"text-ignore-placement":!1,"text-field":["concat","Mobile: ",["get","name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,12,18,18],"text-offset":["interpolate",["linear"],["zoom"],13,["literal",[0,1.5]],18,["literal",[0,2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:M}),n.a.createElement(Mt.b,{id:"lyr_stops_next_visiting",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:14,layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","next_visiting"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],14,10,18,16],"text-offset":["interpolate",["linear"],["zoom"],13,["literal",[0,-1.5]],18,["literal",[0,-2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:M})):null,n.a.createElement(Mt.d,{id:"src_libraries",tileJsonSource:{type:"vector",tiles:oa}}),k.libraries?n.a.createElement(n.a.Fragment,null,n.a.createElement(Mt.b,{id:"lyr_libraries_closed_name_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:12,filter:["has","Year closed"],layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","Library name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],12,10,18,14],"text-offset":["interpolate",["linear"],["zoom"],12,["literal",[0,1.5]],18,["literal",[0,2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0,"text-halo-blur":0,"text-color":"#d32f2f","text-opacity":.9},onClick:B}),n.a.createElement(Mt.b,{id:"lyr_libraries_closed_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:12,filter:["has","Year closed"],layout:{"text-ignore-placement":!1,"text-field":["concat","Closed ",["get","Year closed"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],12,10,18,14],"text-offset":["interpolate",["linear"],["zoom"],12,["literal",[0,-1.5]],18,["literal",[0,-2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0,"text-halo-blur":1,"text-color":"#d32f2f","text-opacity":.9},onClick:B}),n.a.createElement(Mt.b,{id:"lyr_libraries_closed_circles",type:"circle",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:11,filter:["has","Year closed"],paint:{"circle-radius":["interpolate",["linear"],["zoom"],12,3,18,8],"circle-color":"#b71c1c","circle-stroke-width":["interpolate",["linear"],["zoom"],12,1,18,3],"circle-stroke-color":"#ffffff","circle-stroke-opacity":.9,"circle-opacity":.6},onClick:B}),n.a.createElement(Mt.b,{id:"lyr_libraries_open_type_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:13,filter:["!",["has","Year closed"]],layout:{"text-ignore-placement":!1,"text-field":["match",["get","Library type"],"LAL","Local authority library","LAL-","Local authority run - unstaffed","CL","Commissioned library","CRL","Community run library","IL","Independent library","Unknown library"],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,12,18,16],"text-offset":["interpolate",["linear"],["zoom"],13,["literal",[0,-1.5]],18,["literal",[0,-2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:B}),n.a.createElement(Mt.b,{id:"lyr_libraries_open_name_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:10,filter:["!",["has","Year closed"]],layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","Library name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],10,14,18,18],"text-offset":["interpolate",["linear"],["zoom"],10,["literal",[0,1.5]],18,["literal",[0,2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73","text-opacity":1},onClick:B}),n.a.createElement(Mt.b,{id:"lyr_libraries_open_circles",type:"circle",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:5,filter:["!",["has","Year closed"]],paint:{"circle-radius":["interpolate",["linear"],["zoom"],5,3,18,12],"circle-color":["match",["get","Library type"],"LAL","#1b5e20","LAL-","#388e3c","CL","#0d47a1","CRL","#e65100","ICL","#bf360c","#bf360c"],"circle-stroke-width":["interpolate",["linear"],["zoom"],5,1,18,4],"circle-stroke-color":"#ffffff","circle-stroke-opacity":["interpolate",["linear"],["zoom"],5,.8,18,1],"circle-opacity":["interpolate",["linear"],["zoom"],5,.4,18,.9]},onClick:B})):null,u&&u.length>1?n.a.createElement(Mt.c,{key:"mk_me",coordinates:[u[0],u[1]]},n.a.createElement(Gt,{searchType:s})):null,n.a.createElement(Mt.e,{position:"bottom-left"})),n.a.createElement(Ae.a,{title:"Map settings"},n.a.createElement(It.a,{size:"small",className:A.settings,color:"primary",style:{color:"white",border:"1px solid #FFFFFF"},onClick:function(){return N({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!0})}},n.a.createElement(zt.a,null))),n.a.createElement($t,{mapSettings:k,mapSettingsDialogOpen:C}),n.a.createElement(rt.a,{id:"mnu-isochrones",anchorPosition:I,anchorReference:"anchorPosition",elevation:0,className:A.menu,keepMounted:!0,open:P,onClose:z},n.a.createElement(nt.a,{dense:!0,onClick:function(){z(),p&&N({type:"SetStopDialog",stopDialogOpen:!0}),d&&N({type:"SetLibraryDialog",libraryDialogOpen:!0})}},n.a.createElement(Nt.a,{classes:{root:A.listItemRoot}},n.a.createElement(zt.a,{fontSize:"small"})),n.a.createElement(Bt.a,{primary:"More info"})),ra.travel.map((function(e,t){return n.a.createElement(nt.a,{dense:!0,key:"mnu_trv_"+t,onClick:function(){return T(e.name)}},n.a.createElement(Nt.a,{classes:{root:A.listItemRoot}},D[e.name]),n.a.createElement(Bt.a,{primary:e.description}))}))))},pa=a(534),da=a(390),ma=a.n(da);var fa=function(){var e=S(),t=Object(_.a)(e,2),a=t[0],r=a.notificationOpen,o=a.notificationMessage,i=t[1],l=function(){i({type:"SetNotification",notificationOpen:!1})};return n.a.createElement(pa.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:r,autoHideDuration:3e3,onClose:l,ContentProps:{"aria-describedby":"message-id"},message:n.a.createElement("span",{id:"message-id"},o),action:[n.a.createElement(Be.a,{key:"close","aria-label":"close",onClick:l},n.a.createElement(ma.a,{color:"inherit"}))]})},ba=a(166),ha=a.n(ba),ga=a(222),ya=a.n(ga),Ea=a(221),va=a.n(Ea),xa=a(220),Oa=a.n(xa),Sa=a(218),ka=a.n(Sa),ja=a(217),wa=a.n(ja),Ca=a(219),_a=a.n(Ca),La=a(223),Pa=a.n(La);var Ia=Object(G.a)((function(e){return{hoursChip:{margin:e.spacing(1)},table:{backgroundColor:"rgba(0, 0, 0, 0)",border:"1px solid #E0E0E0"}}}));var Na=function(){var e=v(),t=Object(_.a)(e,2),a=t[0],o=a.searchDistance,i=a.searchPosition,l=a.serviceFilter,c=t[1],s=S(),u=Object(_.a)(s,2);Object(C.a)(u[0]);var p=u[1],d=n.a.createRef();Object(r.useEffect)((function(){d.current.onQueryChange()}),[i,o,l]);var m=Ia(),f=Object(Y.a)();return n.a.createElement("div",null,n.a.createElement(D.a,{disableSticky:!0},"Libraries"),n.a.createElement(ha.a,{tableRef:d,components:{Container:function(e){return n.a.createElement(q.a,Object.assign({},e,{elevation:0,className:m.table}))}},icons:{Filter:wa.a,FirstPage:ka.a,LastPage:_a.a,NextPage:Oa.a,PreviousPage:va.a,SortArrow:ya.a},options:{padding:Object(Q.a)(f.breakpoints.up("sm"))?"default":"dense",search:!1,loadingType:"overlay",actionsColumnIndex:0,filtering:!1,toolbar:!1,headerStyle:{backgroundColor:"#fafafa",color:"#737373",border:"0px"}},columns:[{title:"",field:"name",filtering:!1,sorting:!1,render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ae.a,{title:"See more stop details"},n.a.createElement(Be.a,{size:"small",onClick:function(){return c({type:"SetCurrentLibrary",currentLibraryId:e.id}),void p({type:"SetLibraryDialog",libraryDialogOpen:!0})}},n.a.createElement(Pa.a,null))))},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Name",field:"name",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Service",field:"localAuthority",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Address",field:"address1",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"},render:function(e){return[e.address1,e.address2,e.address3].filter(Boolean).join(", ")}},{title:"Postcode",field:"postcode",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Today",field:"mondayStaffedHours",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"},render:function(e){return function(e){var t=e[pe()().format("dddd").toLowerCase()+"StaffedHours"];return t?t.split(","):[]}(e).map((function(e,t){return n.a.createElement(Ie.a,{key:"chp_"+t,color:"secondary",className:m.hoursChip,size:"small",label:e})}))}}],data:function(e){return new Promise((function(t){function a(){return(a=Object(w.a)(j.a.mark((function a(){var r;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ke(e,i,o,l);case 2:r=a.sent,t({data:r.libraries,page:r.page-1,totalCount:r.total});case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}))}}))},Ba=Object(G.a)((function(e){return{hoursChip:{margin:e.spacing(1)},table:{backgroundColor:"rgba(0, 0, 0, 0)",border:"1px solid #E0E0E0"}}}));var Ma=function(){var e=v(),t=Object(_.a)(e,2),a=t[0],o=a.searchDistance,i=a.searchPosition,l=a.serviceFilter,c=t[1],s=S(),u=Object(_.a)(s,2);Object(C.a)(u[0]);var p=u[1],d=n.a.createRef();Object(r.useEffect)((function(){d.current.onQueryChange()}),[i,o,l]);var m=Ba(),f=Object(Y.a)();return n.a.createElement("div",null,n.a.createElement(D.a,{disableSticky:!0},"Mobile library stops"),n.a.createElement(ha.a,{tableRef:d,components:{Container:function(e){return n.a.createElement(q.a,Object.assign({},e,{elevation:0,className:m.table}))}},icons:{Filter:wa.a,FirstPage:ka.a,LastPage:_a.a,NextPage:Oa.a,PreviousPage:va.a,SortArrow:ya.a},options:{padding:Object(Q.a)(f.breakpoints.up("sm"))?"default":"dense",search:!1,loadingType:"overlay",actionsColumnIndex:0,filtering:!1,toolbar:!1,headerStyle:{backgroundColor:"#fafafa",color:"#737373",border:"0px"}},columns:[{title:"",field:"name",filtering:!1,sorting:!1,render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ae.a,{title:"See more stop details"},n.a.createElement(Be.a,{size:"small",onClick:function(){return c({type:"SetCurrentStop",currentStopId:e.id}),void p({type:"SetStopDialog",stopDialogOpen:!0})}},n.a.createElement(Pa.a,null))))},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Name",field:"name",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Service",field:"organisationName",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Community",field:"community",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Address",field:"address",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}}],data:function(e){return new Promise((function(t){function a(){return(a=Object(w.a)(j.a.mark((function a(){var r;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fe(e,i,o,l);case 2:r=a.sent,t({data:r.stops,page:r.page-1,totalCount:r.total});case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}))}}))},Ta=Object(G.a)((function(e){return{search:{alignContent:"center",textAlign:"center",display:"table",marginLeft:"auto",marginRight:"auto",marginBottom:"10px"},subtitle:{textAlign:"center",marginBottom:"5px"},title:{textAlign:"center"}}}));var za=function(){var e=Ta();return n.a.createElement("div",null,n.a.createElement(U.a,{component:"h2",variant:"h6",color:"secondary",className:e.title},"Find my library"),n.a.createElement(U.a,{component:"p",variant:"subtitle1",className:e.subtitle},"Search by postcode or library service"),n.a.createElement("div",{className:e.search},n.a.createElement(bt,{settings:!0})),n.a.createElement("div",{className:e.search},n.a.createElement(Et,null)),n.a.createElement(Na,null),n.a.createElement("br",null),n.a.createElement(Ma,null))},Aa=a(397),Da=a(393),Fa=a(4),Ra=Object(G.a)((function(e){return{listItem:{marginTop:e.spacing(1)},root:{"& table":{display:"block",wordBreak:"normal",width:"100%",overflowX:"auto",WebkitOverflowScrolling:"touch",borderCollapse:"collapse",marginBottom:"16px",borderSpacing:0,overflow:"hidden","& .prop-name":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace'},"& .required":{color:"light"===e.palette.type?"#006500":"#a5ffa5"},"& .prop-type":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',color:"light"===e.palette.type?"#932981":"#ffb6ec"},"& .prop-default":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',borderBottom:"1px dotted ".concat(e.palette.divider)}},"& td":Object(l.a)(Object(l.a)({},e.typography.body2),{},{borderBottom:"1px solid ".concat(e.palette.divider),padding:16,color:e.palette.text.primary}),"& th":{fontSize:14,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium,color:e.palette.text.primary,whiteSpace:"pre",borderBottom:"1px solid ".concat(e.palette.divider),padding:16}}}})),Za={overrides:{h1:{component:U.a,props:{gutterBottom:!0,variant:"h4",color:"secondary"}},h2:{component:U.a,props:{gutterBottom:!0,variant:"h5",color:"textPrimary"}},h3:{component:U.a,props:{gutterBottom:!0,variant:"h6",color:"textPrimary"}},h4:{component:U.a,props:{gutterBottom:!0,variant:"h6",paragraph:!0,color:"textPrimary"}},p:{component:U.a,props:{paragraph:!0,color:"textPrimary"}},a:{component:wt.a},li:{component:Object(Fa.a)(Ra)((function(e){var t=e.classes,a=Object(Aa.a)(e,["classes"]);return n.a.createElement("li",{className:t.listItem},n.a.createElement(U.a,Object.assign({component:"span"},a)))}))}}};var Ha=n.a.memo((function(e){var t=e.page,a=Object(r.useState)(""),o=Object(_.a)(a,2),i=o[0],l=o[1],c=Ra();return Object(r.useEffect)((function(){function e(){return(e=Object(w.a)(j.a.mark((function e(){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t);case 2:return a=e.sent,e.next=5,a.text();case 5:r=e.sent,l(r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),n.a.createElement(Da.a,Object.assign({className:c.root,options:Za},e),i)})),Wa=a(395),Ja=a.n(Wa),Ua=a(112),qa=function(){function e(t){Object(ie.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e){return this.code=e.utla19cd,this.name=e.utla19nm,this.nameWales=e.utla19nmw,this.systemName=e.utla19nm.split(", ").reverse().join(" ").replace(/[. ,:-]+/g,"-").toLowerCase(),this.geom=e.geom,this.bbox=e.bbox,this}}]),e}();function Ga(){return Ya.apply(this,arguments)}function Ya(){return(Ya=Object(w.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.a.get(Ua.servicesApi);case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=7;break}return e.abrupt("return",t.data.map((function(e){return(new qa).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qa=Object(G.a)((function(e){return{content:{flexGrow:1,padding:e.spacing(2)},root:{flexGrow:1}}}));var Va=function(){var e=g(),t=Object(_.a)(e,2);Object(C.a)(t[0]);var a=t[1],o=v(),i=Object(_.a)(o,2);Object(C.a)(i[0]);var l=i[1],c=S(),s=Object(_.a)(c,2);Object(C.a)(s[0]);var u=s[1];Object(r.useEffect)((function(){function e(){return(e=Object(w.a)(j.a.mark((function e(){var t,r,n,o,i,c,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ga();case 2:t=e.sent,r={},n={},t.forEach((function(e){r[e.code]=e,n[e.systemName]=e})),a({type:"AddServices",services:t,serviceLookup:r}),o=new URLSearchParams(window.location.search),(i=o.get("service"))&&n[i]&&(c=n[i],s=JSON.parse(c.bbox).coordinates[0],l({type:"FilterByService",service:c}),u({type:"FitToBounds",bounds:[s[0],s[2]]}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var p=Qa();return n.a.createElement(L.a,null,n.a.createElement("div",{className:p.root},n.a.createElement(xt,{loading:!1,site:3}),n.a.createElement(I.a,{maxWidth:"lg"},n.a.createElement("main",{className:p.content},n.a.createElement(P.Route,{path:"/",exact:!0,render:function(){return n.a.createElement(za,null)}}),n.a.createElement(P.Route,{path:"/map",exact:!0,render:function(){return n.a.createElement(ua,null)}}),n.a.createElement(P.Route,{path:"/data",exact:!0,render:function(){return n.a.createElement(Ha,{page:Ja.a})}}),n.a.createElement(P.Route,{path:["/http:","/https:"],component:function(e){return window.location.replace(e.location.pathname.substr(1)),null}}))),n.a.createElement(I.a,{maxWidth:"lg"},n.a.createElement(Pt,null)),n.a.createElement(fa,null)),n.a.createElement(ve,null),n.a.createElement(Le,null))},$a={services:[],serviceLookup:{},isochrones:{}},Xa=function(e,t){var a=e.isochrones;switch(t.type){case"AddServices":return Object(l.a)(Object(l.a)({},e),{},{services:t.services,serviceLookup:t.serviceLookup});case"AddIsochrone":return a[t.point]||(a[t.point]={}),a[t.point][t.transport]=t.isochrone,console.log(a),Object(l.a)(Object(l.a)({},e),{},{isochrones:a});case"SetIsochroneDisplay":return a[t.point][t.transport].display=t.display,Object(l.a)(Object(l.a)({},e),{},{isochrones:a});case"SetIsochroneLoading":return a[t.point]||(a[t.point]={}),a[t.point][t.transport]={geo:null,display:!1,loading:!0},Object(l.a)(Object(l.a)({},e),{},{isochrones:a});default:return e}},Ka={searchPostcode:"",searchType:"",searchDistance:1609,searchPosition:[],currentStopId:null,currentLibraryId:null,currentPoint:[],serviceFilter:[],serviceFilterBbox:null,serviceFilterBoundary:null,currentService:null,currentServiceSystemName:null},er=function(e,t){switch(t.type){case"SetCurrentStop":return Object(l.a)(Object(l.a)({},e),{},{currentStopId:t.currentStopId,currentPoint:t.currentPoint});case"SetCurrentLibrary":return Object(l.a)(Object(l.a)({},e),{},{currentLibraryId:t.currentLibraryId,currentPoint:t.currentPoint});case"SetSearchDistance":return Object(l.a)(Object(l.a)({},e),{},{searchDistance:t.searchDistance});case"SetPostcodeSearch":return Object(l.a)(Object(l.a)({},e),{},{serviceFilter:[],currentService:null,currentServiceSystemName:null,searchPostcode:t.searchPostcode,searchPosition:t.searchPosition,searchType:"postcode"});case"FilterByService":return Object(l.a)(Object(l.a)({},e),{},{serviceFilter:[t.service.code],currentService:t.service,currentServiceSystemName:t.service.systemName,searchPostcode:"",searchPosition:[],searchType:"service"});case"ClearAll":return Object(l.a)(Object(l.a)({},e),{},{serviceFilter:[],searchPostcode:"",searchPosition:[],searchType:""});default:return e}},tr={notificationOpen:!1,notificationMessage:"",mapZoom:[7],mapPosition:[-1.155414,52.691432],mapBounds:null,mapSettings:{libraries:!0,mobileLibraryStops:!0,authorityBoundary:!1},mapSettingsDialogOpen:!1,libraryDialogOpen:!1,stopDialogOpen:!1,loadingPostcode:!1,loadingServices:!1,isochronesMenuOpen:!1,isochronesMenuAnchor:null},ar=function(e,t){switch(t.type){case"SetNotificationMessage":return Object(l.a)(Object(l.a)({},e),{},{notificationMessage:t.notificationMessage});case"SetNotification":return Object(l.a)(Object(l.a)({},e),{},{notificationOpen:t.notificationOpen});case"ShowNotification":return Object(l.a)(Object(l.a)({},e),{},{notificationOpen:!0,notificationMessage:t.notificationMessage});case"SetStopDialog":return Object(l.a)(Object(l.a)({},e),{},{stopDialogOpen:t.stopDialogOpen});case"SetLibraryDialog":return Object(l.a)(Object(l.a)({},e),{},{libraryDialogOpen:t.libraryDialogOpen});case"SetMapSettingsDialog":return Object(l.a)(Object(l.a)({},e),{},{mapSettingsDialogOpen:t.mapSettingsDialogOpen});case"ToggleMapSetting":var a=e.mapSettings;return a[t.mapSetting]=!a[t.mapSetting],Object(l.a)(Object(l.a)({},e),{},{mapSettings:a});case"FitToBounds":return Object(l.a)(Object(l.a)({},e),{},{mapBounds:t.bounds});case"ToggleLoadingPostcode":return Object(l.a)(Object(l.a)({},e),{},{loadingPostcode:!e.loadingPostcode});case"ToggleLoadingServices":return Object(l.a)(Object(l.a)({},e),{},{loadingServices:!e.loadingServices});case"SetPostcodeSearch":return Object(l.a)(Object(l.a)({},e),{},{loadingPostcode:!1,mapPosition:t.mapPosition,mapZoom:[13]});case"SetMapPosition":return Object(l.a)(Object(l.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[t.mapZoom]});case"SetIsochronesMenu":return Object(l.a)(Object(l.a)({},e),{},{isochronesMenuOpen:t.isochronesMenuOpen,isochronesMenuAnchor:t.isochronesMenuAnchor});default:return e}},rr=Object(m.a)({palette:{primary:{main:d.a[800]},secondary:{main:u.a[600]}},overrides:{MuiButton:{text:{textTransform:"none"},root:{textTransform:"none"}},MuiTypography:{button:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}}}});var nr=function(){return n.a.createElement(h,{initialState:$a,reducer:Xa},n.a.createElement(E,{initialState:Ka,reducer:er},n.a.createElement(O,{initialState:tr,reducer:ar},n.a.createElement(f.a,{theme:rr},n.a.createElement(c.a,null),n.a.createElement(Va,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(496);i.a.render(n.a.createElement(nr,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[404,1,2]]]);
//# sourceMappingURL=main.a0b8ac29.chunk.js.map