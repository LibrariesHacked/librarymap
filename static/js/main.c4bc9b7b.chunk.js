(this.webpackJsonplibrarymap=this.webpackJsonplibrarymap||[]).push([[0],{260:function(e){e.exports=JSON.parse('{"api":"https://api.librarydata.uk/","postcodeApi":"https://api-geography.librarydata.uk/rest/postcodes/","libraryAuthorityTiles":"https://api-geography.librarydata.uk/rest/libraryauthorities/{z}/{x}/{y}.mvt"}')},287:function(e,t,a){e.exports=a(510)},510:function(e,t,a){"use strict";a.r(t);a(288),a(297);var n=a(0),r=a.n(n),o=a(15),i=a.n(o),c=a(27),l=a(577),s=a(278),m=a.n(s),u=a(277),p=a.n(u),d=a(279),b=a(576),h=Object(n.createContext)(),g=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(h.Provider,{value:Object(n.useReducer)(t,a)},o)},E=function(){return Object(n.useContext)(h)},f=Object(n.createContext)(),y=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(f.Provider,{value:Object(n.useReducer)(t,a)},o)},O=function(){return Object(n.useContext)(f)},j=Object(n.createContext)(),v=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(j.Provider,{value:Object(n.useReducer)(t,a)},o)},w=function(){return Object(n.useContext)(j)},S=a(81),k=a(21),x=a(97),C=a(25),N=a(564),P=a(559),T=a(565),_=a(569),M=a(570),B=a(580),D=a(562),R=a(566),L=a(578),z=a(567),F=a(583),W=a(280),Z=a(273),I=a.n(Z),A=a(179),G=a.n(A),J=a(267),U=a.n(J),q=a(271),H=a.n(q),V=a(180),Y=a.n(V),$=a(272),K=a.n($),Q=a(269),X=a.n(Q),ee=a(270),te=a.n(ee),ae=a(268),ne=a.n(ae),re=a(140),oe=a.n(re),ie=a(75),ce=a.n(ie),le=a(112),se=a(581),me=a(563),ue=a(582),pe=a(585),de=a(176),be=a(265),he=a.n(be),ge=a(266),Ee=a.n(ge),fe=a(263),ye=a.n(fe),Oe=a(260);function je(e){return ve.apply(this,arguments)}function ve(){return(ve=Object(le.a)(ce.a.mark((function e(t){var a;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(Oe.postcodeApi+t);case 2:return a=e.sent,e.abrupt("return",{location:[a.data.longitude,a.data.latitude],organisation:a.data.library_service_name});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we=Object(P.a)((function(e){return{grow:{flexGrow:1},iconButton:{padding:10},inputInput:{paddingTop:e.spacing(),paddingRight:e.spacing(),paddingBottom:e.spacing(),paddingLeft:e.spacing(2),fontWeight:500},search:{position:"relative",border:"1px solid #E0E0E0",borderRadius:e.shape.borderRadius,backgroundColor:Object(de.fade)(e.palette.common.white,.8),"&:hover":{backgroundColor:Object(de.fade)(e.palette.common.white,.9)},marginLeft:0,marginRight:e.spacing(),display:"flex",maxWidth:240}}}));var Se=function(){var e=E(),t=Object(k.a)(e,2);Object(S.a)(t[0]),t[1];var a=O(),o=Object(k.a)(a,2),i=o[0],c=i.searchType,l=i.searchPostcode,s=(i.searchDistance,o[1]),m=w(),u=Object(k.a)(m,2);Object(S.a)(u[0]);var p=u[1],d=Object(n.useState)(l),b=Object(k.a)(d,2),h=b[0],g=b[1],f=Object(n.useState)(null),y=Object(k.a)(f,2),j=y[0],v=y[1],x=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}({searchPostcode:l});Object(n.useEffect)((function(){x&&l!==x.searchPostcode&&g(l)}),[l]);var C=function(){return v(null)},N=function(e){C(),s({type:"SetSearchDistance",searchDistance:e}),"postcode"===c&&P()},P=function(){var e=Object(le.a)(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==h){e.next=3;break}return p({type:"ShowNotification",notificationMessage:"You must enter a postcode"}),e.abrupt("return");case 3:return p({type:"LoadingPostcode"}),e.next=6,je(h);case 6:(t=e.sent).location&&2===t.location.length?(s({type:"SetPostcodeSearch",searchPostcode:h,searchPosition:t.location}),p({type:"SetPostcodeSearch",mapPosition:t.location})):p({type:"ShowNotification",notificationMessage:"Could not find postcode"});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=we();return r.a.createElement("div",{className:T.search},r.a.createElement(se.a,{placeholder:"Postcode",classes:{input:T.inputInput},value:h,onChange:function(e){return g(e.target.value)}}),r.a.createElement("div",{className:T.grow}),"postcode"===c?r.a.createElement(F.a,{title:"Clear search"},r.a.createElement(D.a,{className:T.iconButton,onClick:function(){return s({type:"ClearAll"})}},r.a.createElement(he.a,null))):null,r.a.createElement(F.a,{title:"Search by postcode"},r.a.createElement(D.a,{color:"primary",className:T.iconButton,onClick:function(){return P()}},r.a.createElement(oe.a,null))),r.a.createElement(F.a,{title:"Change search settings"},r.a.createElement(D.a,{className:T.iconButton,color:"secondary",onClick:function(e){!function(e){v(e.currentTarget)}(e)}},r.a.createElement(Ee.a,null))),r.a.createElement(ue.a,{id:"mnu-settings",anchorEl:j,keepMounted:!0,open:Boolean(j),onClose:function(){return C()}},r.a.createElement(me.a,{disableSticky:!0},"Search distance"),r.a.createElement(pe.a,{onClick:function(){return N(1609)}},"1 mile"),r.a.createElement(pe.a,{onClick:function(){return N(4827)}},"3 miles"),r.a.createElement(pe.a,{onClick:function(){return N(8045)}},"5 miles"),r.a.createElement(pe.a,{onClick:function(){return N(16090)}},"10 miles"),r.a.createElement(pe.a,{onClick:function(){return N(32180)}},"20 miles"),r.a.createElement(pe.a,{onClick:function(){return N(80450)}},"50 miles")))},ke=Object(P.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1},appBarTransparent:{zIndex:e.zIndex.drawer+1,backgroundColor:"rgba(250, 250, 250, 0.8)"},grow:{flexGrow:1},iconTitle:{marginLeft:e.spacing(1)},progress:{margin:e.spacing(1)},tabBar:{borderTop:"1px solid #e8e8e8",borderBottom:"1px solid #e8e8e8"},title:{margin:e.spacing(2),display:"inline-block",verticalAlign:"middle"}}}));var xe=function(){var e=w(),t=Object(k.a)(e,1)[0],a=t.loadingOrganisations,o=t.loadingMobiles,i=t.loadingRoutes,c=t.loadingMobileLocations,l=t.loadingNearestMobiles,s=t.loadingPostcode,m=Object(n.useState)(!1),u=Object(k.a)(m,2),p=u[0],d=u[1],b=Object(n.useState)(2),h=Object(k.a)(b,2),g=h[0],E=h[1],f=a||o||i||c||l||s,y=Object(C.e)(),O=ke(),j=[{title:"Libraries at home",url:"https://www.librariesathome.co.uk",icon:r.a.createElement(U.a,null),links:[{title:r.a.createElement("span",{className:O.iconTitle},"Search"),short:r.a.createElement("span",{className:O.iconTitle},"Search"),icon:r.a.createElement(oe.a,null),to:"https://www.librariesathome.co.uk"},{title:r.a.createElement("span",{className:O.iconTitle},"Watch"),short:r.a.createElement("span",{className:O.iconTitle},"Watch"),icon:r.a.createElement(ne.a,null),to:"https://www.librariesathome.co.uk/watch"},{title:r.a.createElement("span",{className:O.iconTitle},"Read"),short:r.a.createElement("span",{className:O.iconTitle},"Read"),icon:r.a.createElement(X.a,null),to:"https://www.librariesathome.co.uk/read"},{title:r.a.createElement("span",{className:O.iconTitle},"Listen"),short:r.a.createElement("span",{className:O.iconTitle},"Listen"),icon:r.a.createElement(te.a,null),to:"https://www.librariesathome.co.uk/listen"}]},{title:"Mobile libraries",url:"https://www.mobilelibraries.org",icon:r.a.createElement(G.a,null),links:[{title:r.a.createElement("span",{className:O.iconTitle},"Mobile vans"),short:r.a.createElement("span",{className:O.iconTitle},"Vans"),icon:r.a.createElement(G.a,null),to:"https://www.mobilelibraries.org/"},{title:r.a.createElement("span",{className:O.iconTitle},"Stop locations"),short:r.a.createElement("span",{className:O.iconTitle},"Stops"),icon:r.a.createElement(H.a,null),to:"https://www.mobilelibraries.org/stops"},{title:r.a.createElement("span",{className:O.iconTitle},"Map"),short:r.a.createElement("span",{className:O.iconTitle},"Map"),icon:r.a.createElement(Y.a,null),to:"https://www.mobilelibraries.org/map"}]},{title:"Library map",url:"https://www.librarymap.co.uk",icon:r.a.createElement(K.a,null),links:[{title:r.a.createElement("span",{className:O.iconTitle},"Library map"),short:r.a.createElement("span",{className:O.iconTitle},"Map"),icon:r.a.createElement(Y.a,null),to:"/"}]}],v=g,S=j[v].url;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{maxWidth:"lg"},r.a.createElement(D.a,{color:"primary",onClick:function(){d(!p)}},r.a.createElement(I.a,null)),r.a.createElement(W.a,{color:"secondary",variant:"h6",component:"h1",className:O.title},j[v].title)),p?r.a.createElement(T.a,{position:"static",color:"default",elevation:0},r.a.createElement(N.a,{maxWidth:"lg"},r.a.createElement(L.a,{className:O.tabBar,value:g,onChange:function(e,t){E(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary"},j.map((function(e,t){return r.a.createElement(R.a,{key:"tb_site_"+t,label:e.title,icon:e.icon})}))))):null,r.a.createElement(T.a,{position:"/"===y.pathname?"fixed":"static",color:"inherit",elevation:0,className:"/"===y.pathname?O.appBarTransparent:O.appBar},r.a.createElement(N.a,{maxWidth:"lg"},r.a.createElement(z.a,null,r.a.createElement(B.a,{smUp:!0},j[g].links.map((function(e,t){return r.a.createElement(F.a,{title:e.title,key:"icnb_menu_md_"+t},r.a.createElement(D.a,{component:x.b,to:e.to.replace(S,""),disableRipple:y.pathname===e.to.replace(S,""),disableFocusRipple:y.pathname===e.to.replace(S,""),color:y.pathname===e.to.replace(S,"")?"secondary":"primary"},e.icon))}))),r.a.createElement(B.a,{xsDown:!0,mdUp:!0},j[g].links.map((function(e,t){return r.a.createElement(F.a,{title:e.title,key:"icnb_menu_lg_"+t},r.a.createElement(_.a,{component:x.b,to:e.to.replace(S,""),disableRipple:y.pathname===e.to.replace(S,""),disableFocusRipple:y.pathname===e.to.replace(S,""),color:y.pathname===e.to.replace(S,"")?"secondary":"primary",size:"large"},e.icon,e.short))}))),r.a.createElement(B.a,{smDown:!0},j[g].links.map((function(e,t){return r.a.createElement(F.a,{title:e.title,key:"icnb_menu_lg_"+t},r.a.createElement(_.a,{component:x.b,to:e.to.replace(S,""),disableRipple:y.pathname===e.to.replace(S,""),disableFocusRipple:y.pathname===e.to.replace(S,""),color:y.pathname===e.to.replace(S,"")?"secondary":"primary",size:"large"},e.icon,e.title))}))),f?r.a.createElement(M.a,{className:O.progress,color:"primary",size:30}):null,r.a.createElement("span",{className:O.grow}),"/map"===y.pathname?r.a.createElement(Se,null):null))))},Ce=a(575),Ne=a(82),Pe=a(275),Te=a.n(Pe),_e=a(587),Me=a(274),Be=a.n(Me),De=Object(P.a)((function(e){return{avatar:{margin:0},avatarOn:{margin:0,cursor:"pointer",backgroundColor:e.palette.primary.main}}}));var Re=function(){var e=O(),t=Object(k.a)(e,1)[0].searchType,a=De();return r.a.createElement(F.a,{title:"Me"},r.a.createElement(_e.a,{className:"gps"===t?a.avatarOn:a.avatar},r.a.createElement(Be.a,null)))},Le=a(586),ze=a(574),Fe=a(572),We=a(571),Ze=a(573),Ie=a(588),Ae=a(568),Ge=a(35),Je=Object(P.a)((function(){return{dialog:{border:"1px solid #E0E0E0"}}}));var Ue=function(){var e=w(),t=Object(k.a)(e,2),a=t[0],n=a.mapSettings,o=a.mapSettingsDialogOpen,i=t[1],c=function(){i({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!1})},l=Je(),s=Object(Ge.a)(),m=Object(Ae.a)(s.breakpoints.down("sm"));return r.a.createElement(Le.a,{fullScreen:m,disableBackdropClick:!0,open:o,onClose:c,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:l.dialog}},r.a.createElement(We.a,null,"Map settings"),r.a.createElement(Fe.a,null,r.a.createElement(Ze.a,{control:r.a.createElement(Ie.a,{checked:n.authorityBoundary,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"authorityBoundary"})},name:"sw_authority_boundary",color:"primary"}),label:"Library service boundaries"})),r.a.createElement(ze.a,null,r.a.createElement(_.a,{onClick:c,color:"secondary"},"Close")))},qe=Object(P.a)((function(e){return{settings:{position:"absolute",bottom:e.spacing(4),right:e.spacing(4)}}})),He=a(260),Ve=Object(Ne.e)({minZoom:5,maxZoom:18,customAttribution:"Contains public sector information licensed under the Open Government Licence"}),Ye=[He.libraryAuthorityTiles];var $e=function(){var e=E(),t=Object(k.a)(e,2);Object(S.a)(t[0]),t[1];var a=O(),o=Object(k.a)(a,2),i=o[0],c=i.searchType,l=i.searchPosition,s=(o[1],w()),m=Object(k.a)(s,2),u=m[0],p=u.mapZoom,d=u.mapPosition,b=u.mapSettings,h=u.mapSettingsDialogOpen,g=m[1];Object(n.useEffect)((function(){}),[]);var f=qe();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ve,{style:"style.json",center:d,zoom:p,maxZoom:17,pitch:[0],bearing:[0],fitBounds:null,containerStyle:{top:0,bottom:0,right:0,left:0,height:"100vh",width:"100vw",position:"absolute"}},r.a.createElement(Ne.c,{id:"src_library_authorities",tileJsonSource:{type:"vector",tiles:Ye}}),b.authorityBoundary?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne.a,{id:"lyr_library_authorities_lines",type:"line",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],6,1,22,4]}}),r.a.createElement(Ne.a,{id:"lyr_library_authorities_fill",type:"fill",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,paint:{"fill-color":"#ccc","fill-opacity":.1}})):null,l&&l.length>1?r.a.createElement(Ne.b,{key:"mk_me",coordinates:[l[0],l[1]]},r.a.createElement(Re,{searchType:c})):null,r.a.createElement(Ne.d,{position:"bottom-left"})),r.a.createElement(F.a,{title:"Map settings"},r.a.createElement(Ce.a,{size:"small",className:f.settings,color:"primary",style:{color:"white",border:"1px solid #FFFFFF"},onClick:function(){return g({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!0})}},r.a.createElement(Te.a,null))),r.a.createElement(Ue,{mapSettings:b,mapSettingsDialogOpen:h}))},Ke=a(584),Qe=a(276),Xe=a.n(Qe);var et=function(){var e=w(),t=Object(k.a)(e,2),a=t[0],n=a.notificationOpen,o=a.notificationMessage,i=t[1],c=function(){i({type:"SetNotification",notificationOpen:!1})};return r.a.createElement(Ke.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n,autoHideDuration:3e3,onClose:c,ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},o),action:[r.a.createElement(D.a,{key:"close","aria-label":"close",onClick:c},r.a.createElement(Xe.a,{color:"inherit"}))]})},tt=Object(P.a)((function(e){return{content:{flexGrow:1,padding:e.spacing(2)},root:{flexGrow:1}}}));var at=function(){var e=E(),t=Object(k.a)(e,2);Object(S.a)(t[0]),t[1],Object(n.useEffect)((function(){}),[]);var a=tt();return r.a.createElement(x.a,null,r.a.createElement("div",{className:a.root},r.a.createElement(xe,null),r.a.createElement(N.a,{maxWidth:"lg"},r.a.createElement("main",{className:a.content},r.a.createElement(C.a,{path:"/",exact:!0,render:function(){return r.a.createElement($e,null)}}),r.a.createElement(C.a,{path:["/http:","/https:"],component:function(e){return window.location.replace(e.location.pathname.substr(1)),null}}))),r.a.createElement(et,null)))},nt={},rt=function(e,t){return t.type,e},ot={searchPostcode:"",searchType:"",searchDistance:1609,searchPosition:[]},it=function(e,t){switch(t.type){case"SetSearchDistance":return Object(c.a)(Object(c.a)({},e),{},{searchDistance:t.searchDistance});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{searchPostcode:t.searchPostcode,searchPosition:t.searchPosition,searchType:"postcode"});default:return e}},ct={notificationOpen:!1,notificationMessage:"",mapZoom:[7],mapPosition:[-1.155414,52.691432],mapSettings:{authorityBoundary:!1},mapSettingsDialogOpen:!1,loadingPostcode:!1},lt=function(e,t){switch(t.type){case"SetNotificationMessage":return Object(c.a)(Object(c.a)({},e),{},{notificationMessage:t.notificationMessage});case"SetNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:t.notificationOpen});case"ShowNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:!0,notificationMessage:t.notificationMessage});case"SetStopDialog":return Object(c.a)(Object(c.a)({},e),{},{stopDialogOpen:t.stopDialogOpen});case"SetMapSettingsDialog":return Object(c.a)(Object(c.a)({},e),{},{mapSettingsDialogOpen:t.mapSettingsDialogOpen});case"ToggleMapSetting":var a=e.mapSettings;return a[t.mapSetting]=!a[t.mapSetting],Object(c.a)(Object(c.a)({},e),{},{mapSettings:a});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{loadingPostcode:!1,mapPosition:t.mapPosition,mapZoom:[13]});case"SetMapPosition":return Object(c.a)(Object(c.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[t.mapZoom]});default:return e}},st=Object(d.a)({palette:{primary:{main:p.a[800]},secondary:{main:m.a[700]}},overrides:{MuiButton:{text:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}},MuiTableCell:{root:{borderBottom:"none"}}}});var mt=function(){return r.a.createElement(g,{initialState:nt,reducer:rt},r.a.createElement(y,{initialState:ot,reducer:it},r.a.createElement(v,{initialState:ct,reducer:lt},r.a.createElement(b.a,{theme:st},r.a.createElement(l.a,null),r.a.createElement(at,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(mt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[287,1,2]]]);
//# sourceMappingURL=main.c4bc9b7b.chunk.js.map