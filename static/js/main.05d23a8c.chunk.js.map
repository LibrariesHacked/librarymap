{"version":3,"sources":["context/applicationState.js","context/searchState.js","context/viewState.js","models/stop.js","StopDetails.js","models/library.js","LibraryDetails.js","helpers/geo.js","PostcodeSearch.js","AppHeader.js","Libraries.js","MeAvatar.js","MapSettings.js","LibraryMap.js","Notification.js","LibraryMapApplication.js","App.js","serviceWorker.js","index.js"],"names":["ApplicationStateContext","createContext","ApplicationStateProvider","reducer","initialState","children","Provider","value","useReducer","useApplicationStateValue","useContext","SearchStateContext","SearchStateProvider","useSearchStateValue","ViewStateContext","ViewStateProvider","useViewStateValue","config","require","Stop","obj","Object","assign","this","json","id","routeIds","route_ids","routeNames","route_names","mobileIds","mobile_ids","mobileNames","mobile_names","organisationId","organisation_id","organisationName","organisation_name","name","community","address","postcode","arrivalTimes","arrival_times","departureTimes","departure_times","routeStart","moment","route_start","routeEnd","route_end","routeDays","route_days","routeFrequencies","route_frequencies","routeSchedule","route_schedule","map","s","timetable","longitude","latitude","getStopById","a","axios","get","mobilesApi","response","data","fromJson","useStyles","makeStyles","theme","button","margin","spacing","dialog","border","leftIcon","marginRight","list","width","maxWidth","backgroundColor","palette","background","paper","progress","StopDetails","currentStopId","stopDialogOpen","dispatchView","useState","stop","setStop","useEffect","stopId","stopModel","stopData","getStop","close","type","useTheme","classes","fullScreen","useMediaQuery","breakpoints","down","Dialog","disableBackdropClick","open","onClose","aria-labelledby","BackdropProps","invisible","PaperProps","elevation","className","DialogTitle","DialogContent","ListSubheader","length","format","Divider","Button","onClick","window","api","color","startIcon","mapPosition","mapZoom","component","Link","to","CircularProgress","size","DialogActions","Library","localAuthority","localAuthorityCode","address1","address2","address3","Postcode","postcodeLongitude","postcodeLatitude","uprn","uprnLongitude","statutory","Statutory","yearOpened","yearClosed","mondayStaffedHours","tuesdayStaffedHours","wednesdayStaffedHours","thursdayStaffedHours","fridayStaffedHours","saturdaydayStaffedHours","sundayStaffedHours","mondayUnstaffedHours","tuesdayUnstaffedHours","wednesdayUnstaffedHours","thursdayUnstaffedHours","fridayUnstaffedHours","saturdaydayUnstaffedHours","sundayUnstaffedHours","colocated","colocatedWith","notes","Notes","url","URL","emailAddress","Longitude","Latitude","getQueryLibraries","query","searchPosition","distance","page","pageSize","orderBy","field","orderDirection","libraries","total","parseInt","headers","stops","getLibraryById","LibraryDetails","currentLibraryId","libraryDialogOpen","library","setLibrary","libraryId","libraryModel","libraryData","getLibrary","getPostcode","postcodeApi","location","organisation","library_service_name","grow","flexGrow","iconButton","padding","inputInput","paddingTop","paddingRight","paddingBottom","paddingLeft","fontWeight","search","position","borderRadius","shape","fade","common","white","marginLeft","display","PostcodeSearch","searchType","searchPostcode","dispatchSearch","searchDistance","tempPostcode","setTempPostcode","anchor","setAnchor","prevProps","ref","useRef","current","usePrevious","closeSettingsMenu","setSearchDistance","postcodeSearch","notificationMessage","geoHelper","postcodeData","InputBase","placeholder","input","onChange","e","target","Tooltip","title","IconButton","currentTarget","openSettingsMenu","Menu","anchorEl","keepMounted","Boolean","disableSticky","MenuItem","appBar","zIndex","drawer","iconTitle","tabBar","borderTop","borderBottom","verticalAlign","topIcon","topTitle","AppHeader","props","loading","site","appsOpen","setAppsOpen","tabValue","setTabValue","useLocation","sites","icon","links","short","Typography","variant","AppBar","Tabs","v","scrollButtons","indicatorColor","textColor","idx","Tab","key","label","Toolbar","Hidden","smUp","link","disableRipple","pathname","disableFocusRipple","xsDown","mdUp","smDown","formControl","minWidth","root","table","Libraries","tableRef","React","createRef","onQueryChange","style","components","Container","Paper","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","options","up","loadingType","actionsColumnIndex","filtering","toolbar","headerStyle","columns","hidden","cellStyle","Promise","resolve","reject","totalCount","getLibraries","avatar","avatarOn","cursor","primary","main","MeAvatar","Avatar","MapSettings","mapSettings","mapSettingsDialogOpen","closeDialog","FormControlLabel","control","Switch","checked","authorityBoundary","mapSetting","settings","bottom","right","Map","ReactMapboxGl","minZoom","maxZoom","customAttribution","libraryTiles","libraryBuildingsTiles","libraryAuthorityTiles","stopTiles","tripTiles","LibraryMap","clickLibrary","clickStop","features","properties","center","zoom","pitch","bearing","fitBounds","containerStyle","top","left","height","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","filter","coordinates","Fab","Notification","notificationOpen","handleClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","message","action","aria-label","content","LibraryMapApplication","path","exact","render","replace","substr","initialApplicationState","applicationReducer","state","initialSearchState","searchReducer","initialViewState","loadingPostcode","viewReducer","createMuiTheme","deepOrange","secondary","blueGrey","overrides","MuiButton","text","textTransform","MuiTab","MuiTableCell","App","ThemeProvider","CssBaseline","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console"],"mappings":"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","file":"static/js/main.05d23a8c.chunk.js","sourcesContent":["import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ApplicationStateContext = createContext()\r\n\r\nexport const ApplicationStateProvider = ({ reducer, initialState, children }) => (\r\n  <ApplicationStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ApplicationStateContext.Provider>\r\n)\r\n\r\nexport const useApplicationStateValue = () => useContext(ApplicationStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const SearchStateContext = createContext()\r\n\r\nexport const SearchStateProvider = ({ reducer, initialState, children }) => (\r\n  <SearchStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </SearchStateContext.Provider>\r\n)\r\n\r\nexport const useSearchStateValue = () => useContext(SearchStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ViewStateContext = createContext()\r\n\r\nexport const ViewStateProvider = ({ reducer, initialState, children }) => (\r\n  <ViewStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ViewStateContext.Provider>\r\n)\r\n\r\nexport const useViewStateValue = () => useContext(ViewStateContext)\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Stop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.routeIds = json.route_ids\r\n    this.routeNames = json.route_names\r\n    this.mobileIds = json.mobile_ids\r\n    this.mobileNames = json.mobile_names\r\n    this.organisationId = json.organisation_id\r\n    this.organisationName = json.organisation_name\r\n    this.name = json.name\r\n    this.community = json.community\r\n    this.address = json.address\r\n    this.postcode = json.postcode\r\n    this.arrivalTimes = json.arrival_times\r\n    this.departureTimes = json.departure_times\r\n    this.routeStart = moment(json.route_start)\r\n    this.routeEnd = moment(json.route_end)\r\n    this.routeDays = json.route_days\r\n    this.routeFrequencies = json.route_frequencies\r\n    this.routeSchedule = json.route_schedule.map(s => moment(s))\r\n    this.timetable = json.timetable\r\n    this.longitude = json.longitude\r\n    this.latitude = json.latitude\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getQueryStops (query, organisationFilters, mobileFilters, routeFilters, searchPosition, distance) {\r\n  let url = config.mobilesApi + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize\r\n  if (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection\r\n\r\n  if (mobileFilters.length > 0) url = url + '&mobile_ids=' + mobileFilters.join('|')\r\n  if (organisationFilters.length > 0) url = url + '&organisation_ids=' + organisationFilters.join('|')\r\n  if (routeFilters.length > 0) url = url + '&route_ids=' + routeFilters.join('|')\r\n\r\n  if (searchPosition && searchPosition.length > 1) url = url + '&longitude=' + searchPosition[0] + '&latitude=' + searchPosition[1]\r\n  if (distance && distance !== '') url = url + '&distance=' + distance\r\n\r\n  const response = await axios.get(url)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return {\r\n      stops: response.data.map(s => (new Stop()).fromJson(s)),\r\n      total: parseInt(response.headers['x-total-count']),\r\n      page: parseInt(response.headers['x-page'])\r\n    }\r\n  } else {\r\n    return { stops: [], total: 0, page: 1 }\r\n  }\r\n}\r\n\r\nexport async function getAllStops () {\r\n  const response = await axios.get(config.api + '/stops')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(s => (new Stop()).fromJson(s))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getStopById (id) {\r\n  const response = await axios.get(config.mobilesApi + '/stops/' + id)\r\n  if (response && response.data) {\r\n    return (new Stop()).fromJson(response.data)\r\n  } else {\r\n    return {}\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as stopModel from './models/stop'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  list: {\r\n    width: '100%',\r\n    maxWidth: 360,\r\n    backgroundColor: theme.palette.background.paper\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction StopDetails () {\r\n  const [{ currentStopId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ stopDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [stop, setStop] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getStop (stopId) {\r\n      const stopData = await stopModel.getStopById(stopId)\r\n      setStop(stopData)\r\n    }\r\n    if (currentStopId != null) getStop(currentStopId)\r\n  }, [currentStopId])\r\n\r\n  const getStopCalendar = () => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = () => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  const goToWebsite = () => window.open(stop.timetable, '_blank')\r\n\r\n  const viewMapStop = () => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [stop.longitude, stop.latitude], mapZoom: 14 })\r\n  }\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: false })\r\n  }\r\n\r\n  const theme = useTheme()\r\n  const classes = useStyles()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={stopDialogOpen}\r\n      onClose={close}\r\n      aria-labelledby='dlg-title'\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      {stop && stop.routeDays\r\n        ? (\r\n          <>\r\n            <DialogTitle id='dlg-title'>{stop.name + '. ' + stop.community}</DialogTitle>\r\n            <DialogContent>\r\n              <ListSubheader>{(stop.routeSchedule && stop.routeSchedule.length > 0 ? stop.routeSchedule[0].format('dddd Do MMMM h:mma') : '')}</ListSubheader>\r\n              <br />\r\n              <Divider />\r\n              <br />\r\n              <Button onClick={getStopCalendar} className={classes.button} color='primary' startIcon={<EventIcon />}>Calendar</Button>\r\n              <Button onClick={getStopPdf} className={classes.button} color='primary' startIcon={<PrintIcon />}>Timetable</Button>\r\n              <Button onClick={viewMapStop} className={classes.button} color='primary' startIcon={<LocationOnIcon />} component={Link} to='/map'>Map</Button>\r\n            </DialogContent>\r\n          </>\r\n        ) : <CircularProgress className={classes.progress} color='primary' size={30} />}\r\n      <DialogActions>\r\n        <Button onClick={() => goToWebsite()} color='primary'>Website</Button>\r\n        <Button onClick={() => close()} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default StopDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Library {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.localAuthority = json['Local authority']\r\n    this.localAuthorityCode = json['Local authority code']\r\n    this.name = json['Library name']\r\n    this.address1 = json['Address 1']\r\n    this.address2 = json['Address 2']\r\n    this.address3 = json['Address 3']\r\n    this.postcode = json.Postcode\r\n    this.postcodeLongitude = json['Postcode longitude']\r\n    this.postcodeLatitude = json['Postcode latitude']\r\n    this.uprn = json['Unique property reference number']\r\n    this.uprnLongitude = json['Unique property reference number longitude']\r\n    this.uprnLongitude = json['Unique property reference number latitude']\r\n    this.statutory = json.Statutory\r\n    this.type = json['Library type']\r\n    this.yearOpened = json['Year opened']\r\n    this.yearClosed = json['Year closed']\r\n    this.mondayStaffedHours = json['Monday staffed hours']\r\n    this.tuesdayStaffedHours = json['Tuesday staffed hours']\r\n    this.wednesdayStaffedHours = json['Wednesday staffed hours']\r\n    this.thursdayStaffedHours = json['Thursday staffed hours']\r\n    this.fridayStaffedHours = json['Friday staffed hours']\r\n    this.saturdaydayStaffedHours = json['Saturday staffed hours']\r\n    this.sundayStaffedHours = json['Sunday staffed hours']\r\n    this.mondayUnstaffedHours = json['Monday unstaffed hours']\r\n    this.tuesdayUnstaffedHours = json['Tuesday unstaffed hours']\r\n    this.wednesdayUnstaffedHours = json['Wednesday unstaffed hours']\r\n    this.thursdayUnstaffedHours = json['Thursday unstaffed hours']\r\n    this.fridayUnstaffedHours = json['Friday unstaffed hours']\r\n    this.saturdaydayUnstaffedHours = json['Saturday unstaffed hours']\r\n    this.sundayUnstaffedHours = json['Sunday unstaffed hours']\r\n    this.colocated = json['Co-located']\r\n    this.colocatedWith = json['Co-located with']\r\n    this.notes = json.Notes\r\n    this.url = json.URL\r\n    this.emailAddress = json['Email address']\r\n    this.longitude = json.Longitude\r\n    this.latitude = json.Latitude\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getQueryLibraries (query, searchPosition, distance) {\r\n  let url = config.api + '/libraries?page=' + (query.page + 1) + '&limit=' + query.pageSize\r\n  if (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection\r\n\r\n  if (searchPosition && searchPosition.length > 1) url = url + '&longitude=' + searchPosition[0] + '&latitude=' + searchPosition[1]\r\n  if (distance && distance !== '') url = url + '&distance=' + distance\r\n\r\n  const response = await axios.get(url)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return {\r\n      libraries: response.data.map(s => (new Library()).fromJson(s)),\r\n      total: parseInt(response.headers['x-total-count']),\r\n      page: parseInt(response.headers['x-page'])\r\n    }\r\n  } else {\r\n    return { stops: [], total: 0, page: 1 }\r\n  }\r\n}\r\n\r\nexport async function getAllLibraries () {\r\n  const response = await axios.get(config.api + '/libraries')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(s => (new Library()).fromJson(s))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getLibraryById (id) {\r\n  const response = await axios.get(config.api + '/libraries/' + id)\r\n  if (response && response.data) {\r\n    return (new Library()).fromJson(response.data)\r\n  } else {\r\n    return {}\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as libraryModel from './models/library'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  list: {\r\n    width: '100%',\r\n    maxWidth: 360,\r\n    backgroundColor: theme.palette.background.paper\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction LibraryDetails () {\r\n  const [{ currentLibraryId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ libraryDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [library, setLibrary] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getLibrary (libraryId) {\r\n      const libraryData = await libraryModel.getLibraryById(libraryId)\r\n      setLibrary(libraryData)\r\n    }\r\n    if (currentLibraryId != null) getLibrary(currentLibraryId)\r\n  }, [currentLibraryId])\r\n\r\n  const goToWebsite = () => window.open(library.timetable, '_blank')\r\n\r\n  const viewMapLibrary = () => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [library.longitude, library.latitude], mapZoom: 14 })\r\n  }\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetLibraryDialog', libraryDialogOpen: false })\r\n  }\r\n\r\n  const theme = useTheme()\r\n  const classes = useStyles()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={libraryDialogOpen}\r\n      onClose={close}\r\n      aria-labelledby='dlg-title'\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      {library\r\n        ? (\r\n          <>\r\n            <DialogTitle id='dlg-title'>Library</DialogTitle>\r\n            <DialogContent>\r\n              <Button onClick={viewMapLibrary} className={classes.button} color='primary' startIcon={<LocationOnIcon />} component={Link} to='/map'>Map</Button>\r\n            </DialogContent>\r\n          </>\r\n        ) : <CircularProgress className={classes.progress} color='primary' size={30} />}\r\n      <DialogActions>\r\n        <Button onClick={() => goToWebsite()} color='primary'>Website</Button>\r\n        <Button onClick={() => close()} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default LibraryDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getPosition (options = {}) {\r\n  return new Promise((resolve, reject) => {\r\n    navigator.geolocation.getCurrentPosition(resolve, reject, options)\r\n  })\r\n}\r\n\r\nexport async function getCurrentPosition () {\r\n  var options = {\r\n    enableHighAccuracy: true,\r\n    timeout: 10000,\r\n    maximumAge: 0\r\n  }\r\n\r\n  const position = await getPosition(options)\r\n  return [position.coords.longitude, position.coords.latitude]\r\n}\r\n\r\nexport async function getPostcode (postcode) {\r\n  const response = await axios.get(config.postcodeApi + postcode)\r\n  return {\r\n    location: [response.data.longitude, response.data.latitude],\r\n    organisation: response.data.library_service_name\r\n  }\r\n};\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport ClearIcon from '@material-ui/icons/ClearTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport SettingsIcon from '@material-ui/icons/SettingsTwoTone'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as geoHelper from './helpers/geo'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  iconButton: {\r\n    padding: 10\r\n  },\r\n  inputInput: {\r\n    paddingTop: theme.spacing(),\r\n    paddingRight: theme.spacing(),\r\n    paddingBottom: theme.spacing(),\r\n    paddingLeft: theme.spacing(2),\r\n    fontWeight: 500\r\n  },\r\n  search: {\r\n    position: 'relative',\r\n    border: '1px solid #E0E0E0',\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.8),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.9)\r\n    },\r\n    marginLeft: 0,\r\n    marginRight: theme.spacing(),\r\n    display: 'flex',\r\n    maxWidth: 240\r\n  }\r\n}))\r\n\r\nfunction usePrevious (value) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    ref.current = value\r\n  })\r\n  return ref.current\r\n}\r\n\r\nfunction PostcodeSearch () {\r\n  const [{ }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [tempPostcode, setTempPostcode] = useState(searchPostcode)\r\n  const [anchor, setAnchor] = useState(null)\r\n\r\n  const prevProps = usePrevious({ searchPostcode })\r\n  useEffect(() => {\r\n    if (prevProps && searchPostcode !== prevProps.searchPostcode) setTempPostcode(searchPostcode)\r\n  }, [searchPostcode]) // eslint-disable-line\r\n\r\n  const openSettingsMenu = (e) => setAnchor(e.currentTarget)\r\n\r\n  const closeSettingsMenu = () => setAnchor(null)\r\n\r\n  const setSearchDistance = (searchDistance) => {\r\n    closeSettingsMenu()\r\n    dispatchSearch({ type: 'SetSearchDistance', searchDistance: searchDistance })\r\n    if (searchType === 'postcode') postcodeSearch()\r\n  }\r\n\r\n  const postcodeSearch = async () => {\r\n    if (tempPostcode === '') {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'You must enter a postcode' })\r\n      return\r\n    }\r\n\r\n    dispatchView({ type: 'LoadingPostcode' })\r\n    const postcodeData = await geoHelper.getPostcode(tempPostcode)\r\n    if (postcodeData.location && postcodeData.location.length === 2) {\r\n      dispatchSearch({ type: 'SetPostcodeSearch', searchPostcode: tempPostcode, searchPosition: postcodeData.location })\r\n      dispatchView({ type: 'SetPostcodeSearch', mapPosition: postcodeData.location })\r\n    } else {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'Could not find postcode' })\r\n    }\r\n  }\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.search}>\r\n      <InputBase\r\n        placeholder='Postcode'\r\n        classes={{\r\n          input: classes.inputInput\r\n        }}\r\n        value={tempPostcode}\r\n        onChange={(e) => setTempPostcode(e.target.value)}\r\n      />\r\n      <div className={classes.grow} />\r\n      {searchType === 'postcode'\r\n        ? (\r\n          <Tooltip title='Clear search'>\r\n            <IconButton\r\n              className={classes.iconButton}\r\n              onClick={() => dispatchSearch({ type: 'ClearAll' })}\r\n            >\r\n              <ClearIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        )\r\n        : null}\r\n      <Tooltip title='Search by postcode'>\r\n        <IconButton\r\n          color='primary'\r\n          className={classes.iconButton}\r\n          onClick={() => postcodeSearch()}\r\n        >\r\n          <SearchIcon />\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Tooltip title='Change search settings'>\r\n        <IconButton\r\n          className={classes.iconButton}\r\n          color='secondary'\r\n          onClick={(e) => { openSettingsMenu(e) }}\r\n        >\r\n          <SettingsIcon />\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Menu\r\n        id='mnu-settings'\r\n        anchorEl={anchor}\r\n        keepMounted\r\n        open={Boolean(anchor)}\r\n        onClose={() => closeSettingsMenu()}\r\n      >\r\n        <ListSubheader disableSticky>Search distance</ListSubheader>\r\n        <MenuItem onClick={() => setSearchDistance(1609)}>1 mile</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(4827)}>3 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(8045)}>5 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(16090)}>10 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(32180)}>20 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(80450)}>50 miles</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PostcodeSearch\r\n","import React, { useState } from 'react'\r\n\r\nimport { Link, useLocation } from 'react-router-dom'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Button from '@material-ui/core/Button'\r\nimport Container from '@material-ui/core/Container'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport BusinessIcon from '@material-ui/icons/BusinessTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport WeekendIcon from '@material-ui/icons/WeekendTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\nimport MapIcon from '@material-ui/icons/MapTwoTone'\r\nimport BookIcon from '@material-ui/icons/BookTwoTone'\r\nimport HeadsetIcon from '@material-ui/icons/HeadsetTwoTone'\r\nimport MovieIcon from '@material-ui/icons/MovieTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport WidgetsIcon from '@material-ui/icons/WidgetsTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    position: 'relative'\r\n  },\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  iconTitle: {\r\n    marginLeft: theme.spacing(1)\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  tabBar: {\r\n    borderTop: '1px solid #e8e8e8',\r\n    borderBottom: '1px solid #e8e8e8'\r\n  },\r\n  title: {\r\n    margin: theme.spacing(2),\r\n    display: 'inline-block',\r\n    verticalAlign: 'middle'\r\n  },\r\n  topIcon: {\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    border: '1px solid #e5e5e5',\r\n    '&:hover': {\r\n      backgroundColor: 'rgba(250, 250, 250, 0.8)'\r\n    }\r\n  },\r\n  topTitle: {\r\n    position: 'relative',\r\n    zIndex: theme.zIndex.drawer + 1\r\n  }\r\n}))\r\n\r\nfunction AppHeader (props) {\r\n  const { loading, site } = props\r\n\r\n  const [appsOpen, setAppsOpen] = useState(false)\r\n  const [tabValue, setTabValue] = useState(site)\r\n\r\n  const location = useLocation()\r\n  const classes = useStyles()\r\n\r\n  const sites = [\r\n    {\r\n      title: 'Libraries at home',\r\n      url: 'https://www.librariesathome.co.uk',\r\n      icon: <WeekendIcon />,\r\n      links: [\r\n        {\r\n          title: <span className={classes.iconTitle}>Search</span>,\r\n          short: <span className={classes.iconTitle}>Search</span>,\r\n          icon: <SearchIcon />,\r\n          to: '/'\r\n        },\r\n        {\r\n          title: <span className={classes.iconTitle}>Watch</span>,\r\n          short: <span className={classes.iconTitle}>Watch</span>,\r\n          icon: <MovieIcon />,\r\n          to: '/watch'\r\n        },\r\n        {\r\n          title: <span className={classes.iconTitle}>Read</span>,\r\n          short: <span className={classes.iconTitle}>Read</span>,\r\n          icon: <BookIcon />,\r\n          to: '/read'\r\n        },\r\n        {\r\n          title: <span className={classes.iconTitle}>Listen</span>,\r\n          short: <span className={classes.iconTitle}>Listen</span>,\r\n          icon: <HeadsetIcon />,\r\n          to: '/listen'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Mobile libraries',\r\n      url: 'https://www.mobilelibraries.org',\r\n      icon: <DirectionBusIcon />,\r\n      links: [\r\n        {\r\n          title: <span className={classes.iconTitle}>Mobile vans</span>,\r\n          short: <span className={classes.iconTitle}>Vans</span>,\r\n          icon: <DirectionBusIcon />,\r\n          to: '/'\r\n        },\r\n        {\r\n          title: <span className={classes.iconTitle}>Stop locations</span>,\r\n          short: <span className={classes.iconTitle}>Stops</span>,\r\n          icon: <LocationOnIcon />,\r\n          to: '/stops'\r\n        },\r\n        {\r\n          title: <span className={classes.iconTitle}>Map</span>,\r\n          short: <span className={classes.iconTitle}>Map</span>,\r\n          icon: <MapIcon />,\r\n          to: '/map'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Library map',\r\n      url: 'https://www.librarymap.co.uk',\r\n      icon: <MapIcon />,\r\n      links: [\r\n        {\r\n          title: <span className={classes.iconTitle}>Libraries</span>,\r\n          short: <span className={classes.iconTitle}>Libraries</span>,\r\n          icon: <BusinessIcon />,\r\n          to: '/'\r\n        },\r\n        {\r\n          title: <span className={classes.iconTitle}>Library map</span>,\r\n          short: <span className={classes.iconTitle}>Map</span>,\r\n          icon: <MapIcon />,\r\n          to: '/map'\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n\r\n  return (\r\n    <>\r\n      <Container maxWidth='lg' className={classes.topTitle}>\r\n        <IconButton className={classes.topIcon} color='primary' onClick={() => { setAppsOpen(!appsOpen); setTabValue(site) }}>\r\n          <WidgetsIcon />\r\n        </IconButton>\r\n        <Typography color='secondary' variant='h6' component='h1' className={classes.title}>{sites[site].title}</Typography>\r\n      </Container>\r\n      {appsOpen ? (\r\n        <AppBar position='static' color='default' elevation={0} className={classes.appBar}>\r\n          <Container maxWidth='lg'>\r\n            <Tabs\r\n              className={classes.tabBar}\r\n              value={tabValue}\r\n              onChange={(e, v) => { setTabValue(v) }}\r\n              variant='scrollable'\r\n              scrollButtons='on'\r\n              indicatorColor='primary'\r\n              textColor='primary'\r\n            >\r\n              {sites.map((s, idx) => {\r\n                return (\r\n                  <Tab key={'tb_site_' + idx} label={s.title} icon={s.icon} />\r\n                )\r\n              })}\r\n            </Tabs>\r\n          </Container>\r\n        </AppBar>\r\n      ) : null}\r\n      <AppBar\r\n        position='static'\r\n        color='inherit'\r\n        elevation={0}\r\n        className={classes.appBar}\r\n      >\r\n        <Container maxWidth='lg'>\r\n          <Toolbar>\r\n            <Hidden smUp>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_md_' + idx}>\r\n                    <IconButton\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color={(tabValue === site && location.pathname === link.to ? 'secondary' : 'primary')}\r\n                    >\r\n                      {link.icon}\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <Hidden xsDown mdUp>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color={(tabValue === site && location.pathname === link.to ? 'secondary' : 'primary')}\r\n                      size='large'\r\n                    >\r\n                      {link.icon}{link.short}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <Hidden smDown>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color={(tabValue === site && location.pathname === link.to ? 'secondary' : 'primary')}\r\n                      size='large'\r\n                    >\r\n                      {link.icon}{link.title}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            {loading ? <CircularProgress className={classes.progress} color='primary' size={30} /> : null}\r\n            <span className={classes.grow} />\r\n            {location.pathname === '/map' ? <PostcodeSearch /> : null}\r\n          </Toolbar>\r\n        </Container>\r\n      </AppBar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default AppHeader\r\n","import React, { useEffect } from 'react'\r\n\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Paper from '@material-ui/core/Paper'\r\n\r\nimport MaterialTable from 'material-table'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpwardTwoTone'\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeftTwoTone'\r\nimport ChevronRight from '@material-ui/icons/ChevronRightTwoTone'\r\nimport FirstPage from '@material-ui/icons/FirstPageTwoTone'\r\nimport FilterList from '@material-ui/icons/FilterListTwoTone'\r\nimport LastPage from '@material-ui/icons/LastPageTwoTone'\r\n\r\nimport * as libraryModel from './models/library'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 200\r\n  },\r\n  margin: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  root: {\r\n    flexGrow: 1,\r\n    maxWidth: '100%'\r\n  },\r\n  table: {\r\n    backgroundColor: 'rgba(0, 0, 0, 0)',\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction Libraries () {\r\n  const [{ searchType, searchPostcode, searchDistance, searchPosition }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const tableRef = React.createRef()\r\n\r\n  useEffect(() => {\r\n    tableRef.current.onQueryChange()\r\n  }, [searchPosition, searchDistance]) // eslint-disable-line\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  return (\r\n    <div style={{ maxWidth: '100%' }}>\r\n      <ListSubheader disableSticky>Libraries</ListSubheader>\r\n      <MaterialTable\r\n        tableRef={tableRef}\r\n        components={{\r\n          Container: props => <Paper {...props} elevation={0} className={classes.table} />\r\n        }}\r\n        icons={{\r\n          Filter: FilterList,\r\n          FirstPage: FirstPage,\r\n          LastPage: LastPage,\r\n          NextPage: ChevronRight,\r\n          PreviousPage: ChevronLeft,\r\n          SortArrow: ArrowUpward\r\n        }}\r\n        options={{\r\n          padding: useMediaQuery(theme.breakpoints.up('sm')) ? 'default' : 'dense',\r\n          search: false,\r\n          loadingType: 'overlay',\r\n          actionsColumnIndex: 0,\r\n          filtering: false,\r\n          toolbar: false,\r\n          headerStyle: {\r\n            backgroundColor: '#fafafa',\r\n            color: '#737373',\r\n            border: '0px'\r\n          }\r\n        }}\r\n        columns={[\r\n          {\r\n            title: 'Service',\r\n            field: 'localAuthority',\r\n            filtering: false,\r\n            hidden: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Name',\r\n            field: 'name',\r\n            filtering: false,\r\n            hidden: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Type',\r\n            field: 'type',\r\n            filtering: false,\r\n            hidden: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Closed',\r\n            field: 'yearClosed',\r\n            filtering: false,\r\n            hidden: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Co-located with',\r\n            field: 'colocatedWith',\r\n            filtering: false,\r\n            hidden: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          }\r\n        ]}\r\n        data={query =>\r\n          new Promise((resolve, reject) => {\r\n            async function getLibraries () {\r\n              const libraryData = await libraryModel.getQueryLibraries(query, searchPosition, searchDistance)\r\n              resolve({\r\n                data: libraryData.libraries,\r\n                page: (libraryData.page - 1),\r\n                totalCount: libraryData.total\r\n              })\r\n            }\r\n            getLibraries()\r\n          })}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Libraries\r\n","import React from 'react'\r\n\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nimport Face from '@material-ui/icons/FaceTwoTone'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  avatar: {\r\n    margin: 0\r\n  },\r\n  avatarOn: {\r\n    margin: 0,\r\n    cursor: 'pointer',\r\n    backgroundColor: theme.palette.primary.main\r\n  }\r\n}))\r\n\r\nfunction MeAvatar () {\r\n  const [{ searchType }] = useSearchStateValue()\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip title='Me'>\r\n      <Avatar\r\n        className={searchType === 'gps' ? classes.avatarOn : classes.avatar}\r\n      >\r\n        <Face />\r\n      </Avatar>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MeAvatar\r\n","import React from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport { useTheme, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction MapSettings () {\r\n  const [{ mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue()\r\n\r\n  const closeDialog = () => {\r\n    dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: false })\r\n  }\r\n\r\n  const handleAuthorityBoundaryChange = () => {\r\n    dispatchView({ type: 'ToggleMapSetting', mapSetting: 'authorityBoundary' })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={mapSettingsDialogOpen}\r\n      onClose={closeDialog}\r\n      BackdropProps={{\r\n        invisible: true\r\n      }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Map settings</DialogTitle>\r\n      <DialogContent>\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={mapSettings.authorityBoundary}\r\n              onChange={handleAuthorityBoundaryChange}\r\n              name='sw_authority_boundary'\r\n              color='primary'\r\n            />\r\n          }\r\n          label='Library service boundaries'\r\n        />\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={closeDialog} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default MapSettings\r\n","import React, { useEffect } from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from 'react-mapbox-gl'\r\n\r\nimport LayersIcon from '@material-ui/icons/LayersTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport MeAvatar from './MeAvatar'\r\nimport MapSettings from './MapSettings'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  settings: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4)\r\n  }\r\n}))\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst Map = ReactMapboxGl({\r\n  minZoom: 5,\r\n  maxZoom: 18,\r\n  customAttribution: 'Contains public sector information licensed under the Open Government Licence'\r\n})\r\n\r\nconst libraryTiles = [config.libraryTiles]\r\nconst libraryBuildingsTiles = [config.libraryBuildingsTiles]\r\nconst libraryAuthorityTiles = [config.libraryAuthorityTiles]\r\nconst stopTiles = [config.stopTiles]\r\nconst tripTiles = [config.tripTiles]\r\n\r\nfunction LibraryMap () {\r\n  const [{ }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPosition }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ mapZoom, mapPosition, mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  var clickLibrary = () => {\r\n    // Do nothing\r\n  }\r\n\r\n  useEffect(() => {\r\n  }, [])\r\n\r\n  const clickStop = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentStop', stopId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <Map\r\n        style='style.json' // eslint-disable-line\r\n        center={mapPosition}\r\n        zoom={mapZoom}\r\n        maxZoom={18}\r\n        pitch={[0]}\r\n        bearing={[0]}\r\n        fitBounds={null}\r\n        containerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n      >\r\n        <Source\r\n          id='src_libraries_buildings'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: libraryBuildingsTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_library_buildings_lines'\r\n          type='line'\r\n          sourceId='src_libraries_buildings'\r\n          sourceLayer='library_buildings'\r\n          minZoom={15}\r\n          layout={{\r\n            'line-join': 'round',\r\n            'line-cap': 'square'\r\n          }}\r\n          paint={{\r\n            'line-color': '#455a64',\r\n            'line-opacity': 1,\r\n            'line-width': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              15, 3,\r\n              18, 4\r\n            ]\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_library_buildings_fill'\r\n          type='fill'\r\n          sourceId='src_libraries_buildings'\r\n          sourceLayer='library_buildings'\r\n          minZoom={15}\r\n          paint={{\r\n            'fill-color': '#455a64',\r\n            'fill-opacity': 0.4\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_library_authorities'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: libraryAuthorityTiles\r\n          }}\r\n        />\r\n        {mapSettings.authorityBoundary\r\n          ? (\r\n            <>\r\n              <Layer\r\n                id='lyr_library_authorities_lines'\r\n                type='line'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                layout={{\r\n                  'line-join': 'round',\r\n                  'line-cap': 'square'\r\n                }}\r\n                paint={{\r\n                  'line-color': '#a7a39b',\r\n                  'line-opacity': 1,\r\n                  'line-width': [\r\n                    'interpolate',\r\n                    [\r\n                      'linear'\r\n                    ],\r\n                    [\r\n                      'zoom'\r\n                    ],\r\n                    6, 1,\r\n                    18, 4\r\n                  ]\r\n                }}\r\n              />\r\n              <Layer\r\n                id='lyr_library_authorities_fill'\r\n                type='fill'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                paint={{\r\n                  'fill-color': '#ccc',\r\n                  'fill-opacity': 0.1\r\n                }}\r\n              />\r\n            </>\r\n          ) : null}\r\n        <Source\r\n          id='src_trips'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: tripTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_trips_lines'\r\n          type='line'\r\n          sourceId='src_trips'\r\n          sourceLayer='trip'\r\n          minZoom={14}\r\n          layout={{\r\n            'line-join': 'round',\r\n            'line-cap': 'square'\r\n          }}\r\n          paint={{\r\n            'line-color': '#a7a39b',\r\n            'line-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              14, 1,\r\n              18, 4\r\n            ],\r\n            'line-opacity': 1,\r\n            'line-width': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              14, 1,\r\n              18, 4\r\n            ],\r\n            'line-dasharray': [\r\n              2,\r\n              0.5\r\n            ]\r\n          }}\r\n          onClick={() => { }}\r\n        />\r\n        <Source\r\n          id='src_stops'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: stopTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_circles'\r\n          type='circle'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={5}\r\n          layout={{}}\r\n          paint={{\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 2,\r\n              18, 8\r\n            ],\r\n            'circle-color': '#455a64',\r\n            'circle-stroke-width': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 1,\r\n              18, 3\r\n            ],\r\n            'circle-stroke-color': '#ffffff',\r\n            'circle-opacity': 0.5\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_labels'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['concat', 'Mobile: ', ['get', 'name']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 12,\r\n              18, 18\r\n            ],\r\n            'text-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, ['literal', [0, 1.5]],\r\n              18, ['literal', [0, 2]]\r\n            ]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_next_visiting'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={14}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'next_visiting']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              14, 10,\r\n              18, 16\r\n            ],\r\n            'text-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, ['literal', [0, -1.5]],\r\n              18, ['literal', [0, -2]]\r\n            ]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Source\r\n          id='src_libraries'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: libraryTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_libraries_closed_name_labels'\r\n          type='symbol'\r\n          sourceId='src_libraries'\r\n          sourceLayer='libraries'\r\n          minZoom={12}\r\n          filter={['has', 'Year closed']}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'Library name']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              12, 10,\r\n              18, 14\r\n            ],\r\n            'text-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              12, ['literal', [0, 1.5]],\r\n              18, ['literal', [0, 2]]\r\n            ]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 0,\r\n            'text-halo-blur': 0,\r\n            'text-color': '#d32f2f',\r\n            'text-opacity': 0.9\r\n          }}\r\n          onClick={clickLibrary}\r\n        />\r\n        <Layer\r\n          id='lyr_libraries_closed_labels'\r\n          type='symbol'\r\n          sourceId='src_libraries'\r\n          sourceLayer='libraries'\r\n          minZoom={12}\r\n          filter={['has', 'Year closed']}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['concat', 'Closed ', ['get', 'Year closed']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              12, 10,\r\n              18, 14\r\n            ],\r\n            'text-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              12, ['literal', [0, -1.5]],\r\n              18, ['literal', [0, -2]]\r\n            ]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 0,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#d32f2f',\r\n            'text-opacity': 0.9\r\n          }}\r\n          onClick={clickLibrary}\r\n        />\r\n        <Layer\r\n          id='lyr_libraries_closed_circles'\r\n          type='circle'\r\n          sourceId='src_libraries'\r\n          sourceLayer='libraries'\r\n          minZoom={11}\r\n          filter={['has', 'Year closed']}\r\n          paint={{\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              12, 3,\r\n              18, 8\r\n            ],\r\n            'circle-color': '#b71c1c',\r\n            'circle-stroke-width': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              12, 1,\r\n              18, 3\r\n            ],\r\n            'circle-stroke-color': '#ffffff',\r\n            'circle-stroke-opacity': 0.9,\r\n            'circle-opacity': 0.6\r\n          }}\r\n          onClick={clickLibrary}\r\n        />\r\n        <Layer\r\n          id='lyr_libraries_open_type_labels'\r\n          type='symbol'\r\n          sourceId='src_libraries'\r\n          sourceLayer='libraries'\r\n          minZoom={13}\r\n          filter={['!', ['has', 'Year closed']]}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['match', ['get', 'Library type'], 'LAL', 'Local authority library', 'LAL-', 'Local authority run - unstaffed', 'CL', 'Commissioned library', 'CRL', 'Community run library', 'ICL', 'Independent community library', 'Unknown library'],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 12,\r\n              18, 16\r\n            ],\r\n            'text-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, ['literal', [0, -1.5]],\r\n              18, ['literal', [0, -2]]\r\n            ]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickLibrary}\r\n        />\r\n        <Layer\r\n          id='lyr_libraries_open_name_labels'\r\n          type='symbol'\r\n          sourceId='src_libraries'\r\n          sourceLayer='libraries'\r\n          minZoom={10}\r\n          filter={['!', ['has', 'Year closed']]}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'Library name']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              10, 14,\r\n              18, 18\r\n            ],\r\n            'text-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              10, ['literal', [0, 1.5]],\r\n              18, ['literal', [0, 2]]\r\n            ]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73',\r\n            'text-opacity': 1\r\n          }}\r\n          onClick={clickLibrary}\r\n        />\r\n        <Layer\r\n          id='lyr_libraries_open_circles'\r\n          type='circle'\r\n          sourceId='src_libraries'\r\n          sourceLayer='libraries'\r\n          minZoom={5}\r\n          filter={['!', ['has', 'Year closed']]}\r\n          paint={{\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 3,\r\n              18, 12\r\n            ],\r\n            'circle-color': ['match', ['get', 'Library type'], 'LAL', '#1b5e20', 'LAL-', '#388e3c', 'CL', '#0d47a1', 'CRL', '#e65100', 'ICL', '#bf360c', '#bf360c'],\r\n            'circle-stroke-width': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 1,\r\n              18, 4\r\n            ],\r\n            'circle-stroke-color': '#ffffff',\r\n            'circle-stroke-opacity': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 0.8,\r\n              18, 1\r\n            ],\r\n            'circle-opacity': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 0.4,\r\n              18, 0.9\r\n            ]\r\n          }}\r\n          onClick={clickLibrary}\r\n        />\r\n        {searchPosition && searchPosition.length > 1\r\n          ? (\r\n            <Marker\r\n              key='mk_me'\r\n              coordinates={[searchPosition[0], searchPosition[1]]}\r\n            >\r\n              <MeAvatar searchType={searchType} />\r\n            </Marker>\r\n          )\r\n          : null}\r\n        <ZoomControl position='bottom-left' />\r\n      </Map>\r\n      <Tooltip\r\n        title='Map settings'\r\n      >\r\n        <Fab\r\n          size='small'\r\n          className={classes.settings}\r\n          color='primary'\r\n          style={{\r\n            color: 'white',\r\n            border: '1px solid #FFFFFF'\r\n          }}\r\n          onClick={() => dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: true })}\r\n        >\r\n          <LayersIcon />\r\n        </Fab>\r\n      </Tooltip>\r\n      <MapSettings\r\n        mapSettings={mapSettings}\r\n        mapSettingsDialogOpen={mapSettingsDialogOpen}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default LibraryMap\r\n","import React from 'react'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Snackbar from '@material-ui/core/Snackbar'\r\n\r\nimport CloseIcon from '@material-ui/icons/CloseTwoTone'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nfunction Notification () {\r\n  const [{ notificationOpen, notificationMessage }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const handleClose = () => {\r\n    dispatchView({ type: 'SetNotification', notificationOpen: false })\r\n  }\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'left'\r\n      }}\r\n      open={notificationOpen}\r\n      autoHideDuration={3000}\r\n      onClose={handleClose}\r\n      ContentProps={{\r\n        'aria-describedby': 'message-id'\r\n      }}\r\n      message={<span id='message-id'>{notificationMessage}</span>}\r\n      action={[\r\n        <IconButton\r\n          key='close'\r\n          aria-label='close'\r\n          onClick={handleClose}\r\n        >\r\n          <CloseIcon color='inherit' />\r\n        </IconButton>\r\n      ]}\r\n    />\r\n  )\r\n}\r\n\r\nexport default Notification\r\n","import React, { useEffect } from 'react'\r\nimport { BrowserRouter, Route } from 'react-router-dom'\r\n\r\nimport Container from '@material-ui/core/Container'\r\nimport StopDetails from './StopDetails'\r\nimport LibraryDetails from './LibraryDetails'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport AppHeader from './AppHeader'\r\nimport Libraries from './Libraries'\r\nimport LibraryMap from './LibraryMap'\r\nimport Notification from './Notification'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction LibraryMapApplication () {\r\n  const [{ }, dispatchApplicationState] = useApplicationStateValue() //eslint-disable-line\r\n\r\n  useEffect(() => {\r\n    // Initial data setup\r\n  }, []) //eslint-disable-line\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <div className={classes.root}>\r\n        <AppHeader loading={false} site={2} />\r\n        <Container maxWidth='lg'>\r\n          <main className={classes.content}>\r\n            <Route path='/' exact render={() => <Libraries />} />\r\n            <Route path='/map' exact render={() => <LibraryMap />} />\r\n            <Route path={['/http:', '/https:']} component={props => { window.location.replace(props.location.pathname.substr(1)); return null }} />\r\n          </main>\r\n        </Container>\r\n        <Notification />\r\n      </div>\r\n      <StopDetails />\r\n      <LibraryDetails />\r\n    </BrowserRouter>\r\n  )\r\n}\r\n\r\nexport default LibraryMapApplication\r\n","import React from 'react'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport blueGrey from '@material-ui/core/colors/blueGrey'\nimport deepOrange from '@material-ui/core/colors/deepOrange'\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\n\nimport { ApplicationStateProvider } from './context/applicationState'\nimport { SearchStateProvider } from './context/searchState'\nimport { ViewStateProvider } from './context/viewState'\n\nimport LibraryMapApplication from './LibraryMapApplication'\n\nconst initialApplicationState = {\n\n}\n\nconst applicationReducer = (state, action) => {\n  switch (action.type) {\n    default:\n      return state\n  }\n}\n\nconst initialSearchState = {\n  searchPostcode: '',\n  searchType: '',\n  searchDistance: 1609,\n  searchPosition: [],\n  currentStopId: null,\n  currentLibraryId: null\n}\n\nconst searchReducer = (state, action) => {\n  switch (action.type) {\n    case 'SetCurrentStop':\n      return {\n        ...state,\n        currentStopId: action.stopId\n      }\n    case 'SetCurrentLibrary':\n      return {\n        ...state,\n        currentLibraryId: action.libraryId\n      }\n    case 'SetSearchDistance':\n      return {\n        ...state,\n        searchDistance: action.searchDistance\n      }\n    case 'SetPostcodeSearch':\n      return {\n        ...state,\n        searchPostcode: action.searchPostcode,\n        searchPosition: action.searchPosition,\n        searchType: 'postcode'\n      }\n    default:\n      return state\n  }\n}\n\nconst initialViewState = {\n  notificationOpen: false,\n  notificationMessage: '',\n  mapZoom: [7],\n  mapPosition: [-1.155414, 52.691432],\n  mapSettings: {\n    authorityBoundary: false\n  },\n  mapSettingsDialogOpen: false,\n  libraryDialogOpen: false,\n  stopDialogOpen: false,\n  loadingPostcode: false\n}\n\nconst viewReducer = (state, action) => {\n  switch (action.type) {\n    case 'SetNotificationMessage':\n      return { ...state, notificationMessage: action.notificationMessage }\n    case 'SetNotification':\n      return { ...state, notificationOpen: action.notificationOpen }\n    case 'ShowNotification':\n      return { ...state, notificationOpen: true, notificationMessage: action.notificationMessage }\n    case 'SetStopDialog':\n      return { ...state, stopDialogOpen: action.stopDialogOpen }\n    case 'SetLibraryDialog':\n      return { ...state, libraryDialogOpen: action.libraryDialogOpen }\n    case 'SetMapSettingsDialog':\n      return { ...state, mapSettingsDialogOpen: action.mapSettingsDialogOpen }\n    case 'ToggleMapSetting': {\n      const settings = state.mapSettings\n      settings[action.mapSetting] = !settings[action.mapSetting]\n      return { ...state, mapSettings: settings }\n    }\n    case 'SetPostcodeSearch':\n      return { ...state, loadingPostcode: false, mapPosition: action.mapPosition, mapZoom: [13] }\n    case 'SetMapPosition':\n      return { ...state, mapPosition: action.mapPosition, mapZoom: [action.mapZoom] }\n    default:\n      return state\n  }\n}\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: deepOrange[800]\n    },\n    secondary: {\n      main: blueGrey[700]\n    }\n  },\n  overrides: {\n    MuiButton: {\n      text: {\n        textTransform: 'none'\n      }\n    },\n    MuiTab: {\n      root: {\n        textTransform: 'none'\n      }\n    },\n    MuiTableCell: {\n      root: {\n        borderBottom: 'none'\n      }\n    }\n  }\n})\n\nfunction App () {\n  return (\n    <ApplicationStateProvider initialState={initialApplicationState} reducer={applicationReducer}>\n      <SearchStateProvider initialState={initialSearchState} reducer={searchReducer}>\n        <ViewStateProvider initialState={initialViewState} reducer={viewReducer}>\n          <ThemeProvider theme={theme}>\n            <CssBaseline />\n            <LibraryMapApplication />\n          </ThemeProvider>\n        </ViewStateProvider>\n      </SearchStateProvider>\n    </ApplicationStateProvider>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  window.fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister()\n      })\n      .catch(error => {\n        console.error(error.message)\n      })\n  }\n}\n","import 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport App from './App'\n\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\nserviceWorker.unregister()\n"],"sourceRoot":""}