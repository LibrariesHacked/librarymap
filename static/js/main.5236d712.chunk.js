(this.webpackJsonplibrarymap=this.webpackJsonplibrarymap||[]).push([[0],{111:function(e){e.exports=JSON.parse('{"api":"https://api.librarydata.uk","mobilesApi":"https://api.mobilelibraries.org/api","isochroneApi":"https://api-geography.librarydata.uk/rest/routing/isochrone/","postcodeApi":"https://api-geography.librarydata.uk/rest/postcodes/","libraryTiles":"https://api.librarydata.uk/libraries/{z}/{x}/{y}.mvt","libraryBuildingsTiles":"https://api.librarydata.uk/libraries/buildings/{z}/{x}/{y}.mvt","libraryAuthorityTiles":"https://api-geography.librarydata.uk/rest/libraryauthorities/{z}/{x}/{y}.mvt","servicesApi":"https://api-geography.librarydata.uk/rest/libraryauthorities","stopTiles":"https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt","tripTiles":"https://api.mobilelibraries.org/api/trips/{z}/{x}/{y}.mvt","travel":[{"description":"Walking time","name":"foot-walking","duration":1200,"interval":300,"colour":"#1b5e20"},{"description":"Cycling time","name":"cycling-regular","duration":900,"interval":180,"colour":"#900"},{"description":"Driving time","name":"driving-car","duration":300,"interval":60,"colour":"#b71c1c"}]}')},510:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"getPosition",(function(){return xt})),r.d(n,"getCurrentPosition",(function(){return Ot})),r.d(n,"getCurrentPostcode",(function(){return vt})),r.d(n,"getPostcode",(function(){return St})),r.d(n,"getServiceDataFromPostcode",(function(){return kt})),r.d(n,"getNearestLibrary",(function(){return wt})),r.d(n,"getNearestMobileLibrary",(function(){return Ct})),r.d(n,"validatePostcode",(function(){return Lt}));var a=r(0),i=r.n(a),o=r(20),s=r.n(o),c=r(15),l=r(554),u=r(291),d=r.n(u),p=r(280),b=r.n(p),f=r(119),j=r(553),h=r(2),m=Object(a.createContext)(),y=function(e){var t=e.reducer,r=e.initialState,n=e.children;return Object(h.jsx)(m.Provider,{value:Object(a.useReducer)(t,r),children:n})},g=function(){return Object(a.useContext)(m)},x=Object(a.createContext)(),O=function(e){var t=e.reducer,r=e.initialState,n=e.children;return Object(h.jsx)(x.Provider,{value:Object(a.useReducer)(t,r),children:n})},v=function(){return Object(a.useContext)(x)},S=Object(a.createContext)(),k=function(e){var t=e.reducer,r=e.initialState,n=e.children;return Object(h.jsx)(S.Provider,{value:Object(a.useReducer)(t,r),children:n})},w=function(){return Object(a.useContext)(S)},C=r(13),L=r.n(C),_=r(21),P=r(86),N=r(19),I=r(62),B=r(34),M=r(542),T=r(356),z=r(534),A=r(540),D=r(537),F=r(536),R=r(357),E=r(538),Z=r(351),H=r(355),W=r(354),J=r(539),U=r(352),G=r(353),q=r(89),Y=r(148),Q=r(350),V=r(23),$=r(511),K=r(106),X=r.n(K),ee=r(385),te=r.n(ee),re=r(104),ne=r.n(re),ae=r(105),ie=r.n(ae),oe=r(386),se=r.n(oe),ce=r(74),le=r(75),ue=r(48),de=r.n(ue),pe=r(80),be=r.n(pe),fe=r(111),je=function(){function e(t){Object(ce.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.routeIds=e.route_ids,this.routeNames=e.route_names,this.mobileIds=e.mobile_ids,this.mobileNames=e.mobile_names,this.organisationId=e.organisation_id,this.organisationName=e.organisation_name,this.name=e.name,this.community=e.community,this.address=e.address,this.postcode=e.postcode,this.arrivalTimes=e.arrival_times,this.departureTimes=e.departure_times,this.routeStart=be()(e.route_start),this.routeEnd=be()(e.route_end),this.routeDays=e.route_days,this.routeFrequencies=e.route_frequencies,this.routeSchedule=e.route_schedule.map((function(e){return be()(e)})),this.timetable=e.timetable,this.longitude=e.longitude,this.latitude=e.latitude,this}}]),e}();function he(e,t,r,n){return me.apply(this,arguments)}function me(){return(me=Object(_.a)(L.a.mark((function e(t,r,n,a){var i,o;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=fe.mobilesApi+"/stops?page="+(t.page+1)+"&limit="+t.pageSize,t.orderBy&&t.orderBy.field&&(i=i+"&sort="+t.orderBy.field+"&direction="+t.orderDirection),r&&r.length>1&&(i=i+"&longitude="+r[0]+"&latitude="+r[1]),n&&""!==n&&(i=i+"&distance="+n),a.length>0&&(i=i+"&service_codes="+a.join("|")),e.next=7,de.a.get(i);case 7:if(!((o=e.sent)&&o.data&&o.data.length>0)){e.next=12;break}return e.abrupt("return",{stops:o.data.map((function(e){return(new je).fromJson(e)})),total:parseInt(o.headers["x-total-count"]),page:parseInt(o.headers["x-page"])});case 12:return e.abrupt("return",{stops:[],total:0,page:1});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.get(fe.mobilesApi+"/stops/"+t);case 2:if(!(r=e.sent)||!r.data){e.next=7;break}return e.abrupt("return",(new je).fromJson(r.data));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe=r(111),Oe=Object(Q.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},dialogContentActions:{backgroundColor:"#fff3e0",border:"1px solid #ffe0b2",borderRadius:3,padding:4},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)},tablePaper:{}}}));var ve=function(){var e=v(),t=Object(N.a)(e,2),r=t[0].currentStopId,n=t[1],i=w(),o=Object(N.a)(i,2),s=o[0].stopDialogOpen,c=o[1],l=Object(a.useState)({}),u=Object(N.a)(l,2),d=u[0],p=u[1];Object(a.useEffect)((function(){function e(){return(e=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(t);case 2:r=e.sent,p(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=r&&function(t){e.apply(this,arguments)}(r)}),[r]);var b=function(){n({type:"SetCurrentStop",currentStopId:null,currentPoint:null}),c({type:"SetStopDialog",stopDialogOpen:!1})},f=Object(V.a)(),j=Oe(),m=Object($.a)(f.breakpoints.down("sm"));return Object(h.jsxs)(z.a,{fullScreen:m,disableBackdropClick:!0,open:s,onClose:b,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:j.dialog},children:[Object.keys(d).length>0&&d.routeDays?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(F.a,{id:"dlg-title",children:d.name}),Object(h.jsxs)(D.a,{children:[Object(h.jsx)(q.a,{component:"h3",variant:"subtitle1",children:"Mobile library stop in "+d.community+" "+d.organisationName}),Object(h.jsx)(q.a,{component:"p",variant:"body2",children:d.address}),Object(h.jsx)(E.a,{children:"Schedules"}),Object(h.jsx)(J.a,{component:Y.a,elevation:0,className:j.tablePaper,children:Object(h.jsxs)(Z.a,{size:"small",children:[Object(h.jsx)(U.a,{children:Object(h.jsxs)(G.a,{children:[Object(h.jsx)(W.a,{children:"Frequency"}),Object(h.jsx)(W.a,{align:"right",children:"Next visit"})]})}),Object(h.jsx)(H.a,{children:d.routeFrequencies.map((function(e,t){return Object(h.jsxs)(G.a,{children:[Object(h.jsx)(W.a,{component:"th",scope:"row",children:e}),Object(h.jsx)(W.a,{align:"right",children:d.routeSchedule[0].format("dddd Do MMMM h:mma")})]},"tc_rs_"+t)}))})]})}),Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:j.dialogContentActions,children:[Object(h.jsx)(T.a,{onClick:function(){return window.open(d.timetable,"_blank")},color:"primary",startIcon:Object(h.jsx)(ne.a,{}),children:"Go to website"}),Object(h.jsx)(T.a,{onClick:function(){return window.open(xe.mobilesApi+"/stops/"+d.id+"/ics")},className:j.button,color:"primary",startIcon:Object(h.jsx)(te.a,{}),children:"Get calendar"}),Object(h.jsx)(T.a,{onClick:function(){return window.open(xe.mobilesApi+"/stops/"+d.id+"/pdf","_blank")},className:j.button,color:"primary",startIcon:Object(h.jsx)(se.a,{}),children:"Print"}),Object(h.jsx)(T.a,{onClick:function(){c({type:"SetMapPosition",mapPosition:[d.longitude,d.latitude],mapZoom:16})},className:j.button,color:"primary",startIcon:Object(h.jsx)(ie.a,{}),component:I.b,to:"/map",children:"See on map"})]})]})]}):Object(h.jsx)(R.a,{className:j.progress,color:"primary",size:30}),Object(h.jsx)(A.a,{children:Object(h.jsx)(T.a,{onClick:function(){return b()},color:"secondary",endIcon:Object(h.jsx)(X.a,{}),children:"Close"})})]})},Se=r(111),ke={LAL:"Local authority library","LAL-":"Local authority run - unstaffed",CL:"Commissioned library",CRL:"Community run library",IL:"Independent library"},we=function(){function e(t){Object(ce.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.localAuthority=e["Local authority"],this.localAuthorityCode=e["Local authority code"],this.name=e["Library name"],this.address1=e["Address 1"],this.address2=e["Address 2"],this.address3=e["Address 3"],this.postcode=e.Postcode,this.postcodeLongitude=e["Postcode longitude"],this.postcodeLatitude=e["Postcode latitude"],this.uprn=e["Unique property reference number"],this.uprnLongitude=e["Unique property reference number longitude"],this.uprnLongitude=e["Unique property reference number latitude"],this.statutory=e.Statutory,this.type=e["Type of library"],this.typeDescription=ke[e["Type of library"]],this.yearOpened=e["Year opened"],this.yearClosed=e["Year closed"],this.mondayStaffedHours=e["Monday staffed hours"],this.tuesdayStaffedHours=e["Tuesday staffed hours"],this.wednesdayStaffedHours=e["Wednesday staffed hours"],this.thursdayStaffedHours=e["Thursday staffed hours"],this.fridayStaffedHours=e["Friday staffed hours"],this.saturdaydayStaffedHours=e["Saturday staffed hours"],this.sundayStaffedHours=e["Sunday staffed hours"],this.mondayUnstaffedHours=e["Monday unstaffed hours"],this.tuesdayUnstaffedHours=e["Tuesday unstaffed hours"],this.wednesdayUnstaffedHours=e["Wednesday unstaffed hours"],this.thursdayUnstaffedHours=e["Thursday unstaffed hours"],this.fridayUnstaffedHours=e["Friday unstaffed hours"],this.saturdaydayUnstaffedHours=e["Saturday unstaffed hours"],this.sundayUnstaffedHours=e["Sunday unstaffed hours"],this.colocated=e["Co-located"],this.colocatedWith=e["Co-located with"],this.notes=e.Notes,this.url=e.URL,this.emailAddress=e["Email address"],this.longitude=e.Longitude,this.latitude=e.Latitude,this}}]),e}();function Ce(e,t,r,n,a){return Le.apply(this,arguments)}function Le(){return(Le=Object(_.a)(L.a.mark((function e(t,r,n,a,i){var o,s,c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Se.api+"/libraries?page="+(t.page+1)+"&limit="+t.pageSize+"&closed="+i,s={name:"Library name",localAuthority:"Local authority"},t.orderBy&&t.orderBy.field&&(o=o+"&sort="+s[t.orderBy.field]+"&direction="+t.orderDirection),r&&r.length>1&&(o=o+"&longitude="+r[0]+"&latitude="+r[1]),n&&""!==n&&(o=o+"&distance="+n),a.length>0&&(o=o+"&service_codes="+a.join("|")),e.next=8,de.a.get(o);case 8:if(!((c=e.sent)&&c.data&&c.data.length>0)){e.next=13;break}return e.abrupt("return",{libraries:c.data.map((function(e){return(new we).fromJson(e)})),total:parseInt(c.headers["x-total-count"]),page:parseInt(c.headers["x-page"])});case 13:return e.abrupt("return",{libraries:[],total:0,page:1});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.get(Se.api+"/libraries/"+t);case 2:if(!(r=e.sent)||!r.data){e.next=7;break}return e.abrupt("return",(new we).fromJson(r.data));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ne=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function Ie(e,t){var r=""!==e[t+"StaffedHours"]?e[t+"StaffedHours"]:null,n=""!==e[t+"UnstaffedHours"]?e[t+"UnstaffedHours"]:null;return{day:t,staffed:r?r.split(",").filter((function(e){return"00:00-00:00"!==e})).map((function(e){return e.split("-")})):null,unstaffed:n?n.split(",").filter((function(e){return"00:00-00:00"!==e})).map((function(e){return e.split("-")})):null}}function Be(e){var t=[];return Ne.forEach((function(r){t.push(Ie(e,r))})),t}var Me=Object(Q.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},dialogContentActions:{backgroundColor:"#fff3e0",border:"1px solid #ffe0b2",borderRadius:3,padding:4},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)},table:{},tablePaper:{padding:e.spacing(1),border:"1px solid",borderColor:e.palette.outline.main}}}));var Te=function(){var e=v(),t=Object(N.a)(e,2),r=t[0].currentLibraryId,n=t[1],i=w(),o=Object(N.a)(i,2),s=o[0].libraryDialogOpen,c=o[1],l=Object(a.useState)({}),u=Object(N.a)(l,2),d=u[0],p=u[1];Object(a.useEffect)((function(){function e(){return(e=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(t);case 2:r=e.sent,p(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=r&&function(t){e.apply(this,arguments)}(r)}),[r]);var b=function(){n({type:"SetCurrentLibrary",currentLibraryId:null,currentPoint:null}),c({type:"SetLibraryDialog",libraryDialogOpen:!1})},f=Object(V.a)(),j=Me(),m=Object($.a)(f.breakpoints.down("sm"));return Object(h.jsxs)(z.a,{fullScreen:m,disableBackdropClick:!0,open:s,onClose:b,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:j.dialog},children:[Object.keys(d).length>0?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(F.a,{id:"dlg-title",children:d.name}),Object(h.jsxs)(D.a,{children:[Object(h.jsx)(q.a,{component:"h3",variant:"subtitle1",children:d.typeDescription+" in "+d.localAuthority+". "}),Object(h.jsx)(q.a,{component:"p",variant:"body2",children:[d.address1,d.address2,d.address3,d.postcode].filter((function(e){return Boolean(e)})).join(", ")}),Object(h.jsx)(J.a,{component:Y.a,elevation:0,className:j.tablePaper,children:Object(h.jsx)(Z.a,{size:"small",className:j.table,children:Object(h.jsx)(H.a,{children:Be(d).map((function(e,t){return Object(h.jsxs)(G.a,{children:[Object(h.jsx)(W.a,{children:e.day}),Object(h.jsx)(W.a,{children:e.staffed})]},"tc_rs_"+t)}))})})}),Object(h.jsx)("br",{}),Object(h.jsx)(E.a,{disableSticky:!0,children:"Actions"}),Object(h.jsxs)("div",{className:j.dialogContentActions,children:[Object(h.jsx)(T.a,{onClick:function(){return window.open(d.url,"_blank")},color:"primary",startIcon:Object(h.jsx)(ne.a,{}),children:"Go to website"}),Object(h.jsx)(T.a,{onClick:function(){c({type:"SetMapPosition",mapPosition:[d.longitude,d.latitude],mapZoom:16})},className:j.button,color:"primary",startIcon:Object(h.jsx)(ie.a,{}),component:I.b,to:"/map",children:"See on map"})]})]})]}):Object(h.jsx)(R.a,{className:j.progress,color:"primary",size:30}),Object(h.jsx)(A.a,{children:Object(h.jsx)(T.a,{onClick:function(){return b()},color:"secondary",endIcon:Object(h.jsx)(X.a,{}),children:"Close"})})]})},ze=r(543),Ae=r(381),De=r(277),Fe=r(545),Re=r(555),Ee=r(360),Ze=r(358),He=r(394),We=r.n(He),Je=r(286),Ue=r.n(Je),Ge=r(287),qe=r.n(Ge),Ye=r(395),Qe=r.n(Ye),Ve=r(392),$e=r.n(Ve),Ke=r(241),Xe=r.n(Ke),et=r(393),tt=r.n(et),rt=r(222),nt=r.n(rt),at=r(240),it=r.n(at),ot=r(379),st=r(272),ct=r(541),lt=r(409),ut=r(211),dt=r(359),pt=r(118),bt=r(389),ft=r.n(bt),jt=r(390),ht=r.n(jt),mt=r(391),yt=r.n(mt),gt=r(111),xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,r){navigator.geolocation.getCurrentPosition(t,r,e)}))},Ot=function(){var e=Object(_.a)(L.a.mark((function e(){var t,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={enableHighAccuracy:!0,timeout:1e4,maximumAge:0},e.next=3,xt(t);case 3:return r=e.sent,e.abrupt("return",[r.coords.longitude,r.coords.latitude]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vt=function(){var e=Object(_.a)(L.a.mark((function e(t,r){var n,a,i;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://api.postcodes.io/postcodes?lon=".concat(t,"&lat=").concat(r),e.prev=1,e.next=4,de.a.get(n);case 4:if(200!==(a=e.sent).status){e.next=9;break}if(!((i=a.data.result).length>0)){e.next=9;break}return e.abrupt("return",i[0].postcode);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,r){return e.apply(this,arguments)}}(),St=function(){var e=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.get(gt.postcodeApi+t);case 2:return r=e.sent,e.abrupt("return",{location:[r.data.longitude,r.data.latitude],library_service_name:r.data.library_service_name,library_service:r.data.library_service});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),kt=function(){var e=Object(_.a)(L.a.mark((function e(t,r){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,St(t);case 2:if(n=e.sent,!((a=r.filter((function(e){return e.Code===n.library_service}))).length>0)){e.next=6;break}return e.abrupt("return",{service:a[0],location:n.location});case 6:return e.abrupt("return",{});case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),wt=function(){var e=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.get(gt.libraryApi+"?latitude="+t[1]+"&longitude="+t[0]);case 2:return r=e.sent,e.abrupt("return",r&&r.data&&r.data.length>0?r.data[0]:null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ct=function(){var e=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.get(gt.mobileLibraryApi+"?latitude="+t[1]+"&longitude="+t[0]);case 2:return r=e.sent,e.abrupt("return",r&&r.data&&r.data.length>0?r.data[0]:null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Lt=function(e){return/^[A-Z]{1,2}\d[A-Z\d]? ?\d[A-Z]{2}$/.test(e.trim())};function _t(e){new URLSearchParams(window.location.search).delete("service"),e.push(window.location.pathname)}var Pt=Object(Q.a)((function(e){return{grow:{flexGrow:1},iconButton:{padding:e.spacing()},iconProgress:{margin:e.spacing()},inputInput:{paddingTop:e.spacing(),paddingRight:e.spacing(),paddingBottom:e.spacing(),paddingLeft:e.spacing(2),fontWeight:e.typography.fontWeightBold},search:{position:"relative",border:"1px solid #E0E0E0",borderColor:e.palette.outline.main,borderRadius:e.shape.borderRadius,backgroundColor:Object(pt.fade)(e.palette.common.white,.8),"&:hover":{backgroundColor:Object(pt.fade)(e.palette.common.white,.9)},marginLeft:0,marginRight:e.spacing(),display:"flex",maxWidth:240}}}));var Nt=Object(B.g)((function(e){var t=e.settings,r=v(),i=Object(N.a)(r,2),o=i[0],s=o.searchType,c=o.searchPostcode,l=o.searchPosition,u=i[1],d=w(),p=Object(N.a)(d,2),b=p[0],f=b.loadingPostcode,j=b.loadingLocation,m=p[1],y=Object(a.useState)(c||""),g=Object(N.a)(y,2),x=g[0],O=g[1],S=Object(a.useState)(null),k=Object(N.a)(S,2),C=k[0],P=k[1],I=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current}({searchPostcode:c});Object(a.useEffect)((function(){I&&c!==I.searchPostcode&&O(c)}),[c,I]);var B=function(){var e=Object(_.a)(L.a.mark((function e(){var t,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=16;break}if(m({type:"ToggleLoadingLocation"}),!(l.length>0)){e.next=6;break}e.t0=l,e.next=9;break;case 6:return e.next=8,Ot();case 8:e.t0=e.sent;case 9:return t=e.t0,u({type:"SetLocation",searchPosition:t}),e.next=13,M(t);case 13:r=e.sent,m({type:"ToggleLoadingLocation"}),r&&""!==r&&D(r);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(_.a)(L.a.mark((function e(t){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=6;break}return e.next=3,vt.apply(n,Object(ot.a)(t));case 3:return r=e.sent,O(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){return P(null)},z=function(e){T(),u({type:"SetSearchDistance",searchDistance:e}),"postcode"===s&&D(x)},A=function(){O(""),u({type:"ClearAll"}),_t(e.history)},D=function(){var e=Object(_.a)(L.a.mark((function e(){var t,r,n=arguments;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=n.length>0&&void 0!==n[0]?n[0]:x)&&""!==t){e.next=4;break}return m({type:"ShowNotification",notificationMessage:"Please enter a postcode before searching",notificationSeverity:"warning"}),e.abrupt("return");case 4:if(m({type:"ToggleLoadingPostcode"}),m({type:"LoadingPostcode"}),!Lt(t)){e.next=14;break}return A(),e.next=10,St(t.trim());case 10:(r=e.sent)&&r.location&&r.location.length>0?(u({type:"SetPostcodeSearch",searchPostcode:t,searchPosition:r.location}),m({type:"SetMapPosition",mapPosition:r.location,mapZoom:14})):m({type:"ShowNotification",notificationMessage:"We could not find that postcode",notificationSeverity:"error"}),e.next=15;break;case 14:m({type:"ShowNotification",notificationMessage:"We could not find that postcode",notificationSeverity:"error"});case 15:m({type:"ToggleLoadingPostcode"});case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=Pt();return Object(h.jsxs)("div",{className:F.search,children:[Object(h.jsx)(lt.a,{placeholder:"Postcode",classes:{input:F.inputInput},value:x,onChange:function(e){return O(e.target.value.toUpperCase())},onKeyDown:function(e){13===e.keyCode&&D()},inputProps:{"aria-label":"search by postcode"}}),"postcode"===s?Object(h.jsx)(Ze.a,{title:"Clear search",children:Object(h.jsx)(De.a,{"aria-label":"Clear search",className:F.iconButton,onClick:function(){return A()},children:Object(h.jsx)(ft.a,{})})}):null,Object(h.jsx)("div",{className:F.grow}),Object(h.jsx)(Ze.a,{title:"Search by postcode",children:f?Object(h.jsx)(st.a,{position:"relative",display:"inline-flex",className:F.iconProgress,children:Object(h.jsx)(R.a,{size:22})}):Object(h.jsx)(De.a,{"aria-label":"Search",color:"primary",className:F.iconButton,onClick:function(){return D()},children:Object(h.jsx)(nt.a,{})})}),Object(h.jsx)(ct.a,{orientation:"vertical",flexItem:!0}),Object(h.jsx)(Ze.a,{title:"Use your current location",children:j?Object(h.jsx)(st.a,{position:"relative",display:"inline-flex",className:F.iconProgress,children:Object(h.jsx)(R.a,{size:22})}):Object(h.jsx)(De.a,{"aria-label":"Search by current location",color:"primary",className:F.iconButton,onClick:function(){return B()},children:Object(h.jsx)(ht.a,{})})}),t?Object(h.jsx)(Ze.a,{title:"Change search settings",children:Object(h.jsx)(De.a,{"aria-label":"Open search settings menu",className:F.iconButton,color:"secondary",onClick:function(e){!function(e){P(e.currentTarget)}(e)},children:Object(h.jsx)(yt.a,{})})}):null,Object(h.jsxs)(ut.a,{id:"mnu-settings",anchorEl:C,keepMounted:!0,open:Boolean(C),onClose:function(){return T()},children:[Object(h.jsx)(E.a,{disableSticky:!0,children:"Search distance"}),Object(h.jsx)(dt.a,{onClick:function(){return z(1609)},children:"1 mile"}),Object(h.jsx)(dt.a,{onClick:function(){return z(4827)},children:"3 miles"}),Object(h.jsx)(dt.a,{onClick:function(){return z(8045)},children:"5 miles"}),Object(h.jsx)(dt.a,{onClick:function(){return z(16090)},children:"10 miles"}),Object(h.jsx)(dt.a,{onClick:function(){return z(32180)},children:"20 miles"}),Object(h.jsx)(dt.a,{onClick:function(){return z(80450)},children:"50 miles"})]})]})})),It=Object(Q.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,position:"relative"},appBarTransparent:{zIndex:e.zIndex.drawer+1,backgroundColor:"rgba(250, 250, 250, 0.8)",position:"relative"},grow:{flexGrow:1},topIcon:{backgroundColor:"rgba(250, 250, 250, 0)","&:hover":{backgroundColor:"rgba(250, 250, 250, 0)"}},topTitle:{position:"relative",zIndex:e.zIndex.drawer+1}}}));var Bt=function(e){var t=e.site,r=v(),n=Object(N.a)(r,1)[0].currentServiceSystemName,i=Object(a.useState)(!1),o=Object(N.a)(i,2),s=o[0],c=o[1],l=Object(a.useState)(t),u=Object(N.a)(l,2),d=u[0],p=u[1],b=Object(B.f)(),f=It(),j=function(e){return n?e+"?service="+n:e},m=[{title:"Library lab",url:"https://www.librarylab.uk",icon:Object(h.jsx)(it.a,{}),links:[{title:"About library lab",short:"Lab",icon:Object(h.jsx)(it.a,{}),to:"/"}]},{title:"Libraries at home",url:"https://www.librariesathome.co.uk",icon:Object(h.jsx)($e.a,{}),links:[{title:"Find service",short:"Find",icon:Object(h.jsx)(nt.a,{}),to:j("/")},{title:"Watch library TV",short:"Watch",icon:Object(h.jsx)(tt.a,{}),to:"/watch"},{title:"Read blogs",short:"Read",icon:Object(h.jsx)(We.a,{}),to:"/read"},{title:"Listen podcasts",short:"Listen",icon:Object(h.jsx)(Qe.a,{}),to:"/listen"}]},{title:"Mobile libraries",url:"https://www.mobilelibraries.org",icon:Object(h.jsx)(Ue.a,{}),links:[{title:"Find my stop",short:"Stops",icon:Object(h.jsx)(qe.a,{}),to:"/"},{title:"Mobile vans",short:"Vans",icon:Object(h.jsx)(Ue.a,{}),to:"/mobiles"},{title:"Map of stops",short:"Map",icon:Object(h.jsx)(Xe.a,{}),to:"/map"}]},{title:"Library map",url:"https://www.librarymap.co.uk",icon:Object(h.jsx)(Xe.a,{}),links:[{title:"Find my library",short:"Find",icon:Object(h.jsx)(qe.a,{}),to:j("/")},{title:"Map of libraries",short:"Map",icon:Object(h.jsx)(Xe.a,{}),to:j("/map")}]}],y="/map"===b.pathname?f.appBarTransparent:f.appBar;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(M.a,{maxWidth:"lg",className:f.topTitle,children:Object(h.jsxs)(Ee.a,{children:[Object(h.jsx)(De.a,{"aria-label":"Toggle site menu",className:f.topIcon,color:"primary",onClick:function(){c(!s),p(t)},children:s?Object(h.jsx)(X.a,{}):Object(h.jsx)(it.a,{})}),Object(h.jsx)("span",{className:f.grow})]})}),s?Object(h.jsx)(ze.a,{position:"static",color:"transparent",elevation:0,className:y,children:Object(h.jsx)(M.a,{maxWidth:"lg",children:Object(h.jsx)(Re.a,{value:d,onChange:function(e,t){p(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"secondary",children:m.map((function(e,t){return Object(h.jsx)(Fe.a,{label:e.title,icon:e.icon},"tb_site_"+t)}))})})}):null,Object(h.jsx)(ze.a,{position:"static",color:"transparent",elevation:0,className:y,children:Object(h.jsx)(M.a,{maxWidth:"lg",children:Object(h.jsxs)(Ee.a,{children:[Object(h.jsx)(Ae.a,{mdUp:!0,children:m[d].links.map((function(e,r){return Object(h.jsx)(Ze.a,{title:e.title,children:Object(h.jsx)(T.a,{component:I.b,to:d===t?e.to:m[d].url+e.to,disableRipple:b.pathname===e.to,disableFocusRipple:b.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon,children:e.short})},"icnb_menu_lg_"+r)}))}),Object(h.jsx)(Ae.a,{smDown:!0,children:m[d].links.map((function(e,r){return Object(h.jsx)(Ze.a,{title:e.title,children:Object(h.jsx)(T.a,{component:I.b,to:d===t?e.to:m[d].url+e.to,disableRipple:b.pathname===e.to,disableFocusRipple:b.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon,children:e.title})},"icnb_menu_lg_"+r)}))}),Object(h.jsx)("span",{className:f.grow}),"/map"===b.pathname?Object(h.jsx)(Nt,{}):null]})})})]})},Mt=r(546),Tt=r(547),zt=r(396),At=r.n(zt),Dt=Object(Q.a)((function(e){return{root:{paddingTop:e.spacing(5),marginTop:e.spacing(3),marginBottom:e.spacing(5),width:"100%"},bullet:{margin:e.spacing(2)},grid:{marginTop:e.spacing(2)},loveIcon:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},footerText:{verticalAlign:"middle",display:"inline-flex"},footerRight:{textAlign:"right"},tapTarget:{lineHeight:2.2,fontSize:16}}}));var Ft=function(){var e=Dt();return Object(h.jsxs)("div",{className:e.root,children:[Object(h.jsx)(ct.a,{}),Object(h.jsxs)(Mt.a,{container:!0,spacing:3,className:e.grid,children:[Object(h.jsxs)(Mt.a,{item:!0,xs:12,sm:6,md:6,lg:6,xl:6,children:[Object(h.jsxs)(q.a,{variant:"button",children:[Object(h.jsx)(Tt.a,{href:"https://www.librarylab.uk/library-map",target:"_blank",title:"About the library map library lab project",className:e.tapTarget,children:"About this project"}),Object(h.jsx)("span",{className:e.bullet,children:" \u2022 "}),Object(h.jsx)(Tt.a,{component:I.b,to:"/data",title:"Maintaining the data used on this site and licensing",className:e.tapTarget,children:"Data"}),Object(h.jsx)("span",{className:e.bullet,children:" \u2022 "}),Object(h.jsx)(Tt.a,{href:"https://github.com/LibrariesHacked/librarymap",target:"_blank",title:"Project on GitHub",className:e.tapTarget,children:"GitHub"})]}),Object(h.jsx)("br",{}),Object(h.jsx)(q.a,{variant:"body2",className:e.footerText,children:"A Library Lab project by Libraries Hacked."})]}),Object(h.jsxs)(Mt.a,{className:e.footerRight,item:!0,xs:12,sm:6,md:6,lg:6,xl:6,children:[Object(h.jsxs)(q.a,{variant:"body1",className:e.footerText,children:["In memory of Paul Rowe ",Object(h.jsx)(At.a,{color:"primary",className:e.loveIcon})]}),Object(h.jsx)("br",{}),Object(h.jsx)(q.a,{variant:"button",children:Object(h.jsx)(Tt.a,{href:"https://www.mind.org.uk/donate/",title:"Donate to Mind",className:e.tapTarget,target:"_blank",children:"Donate to Mind"})})]})]})]})},Rt=r(549),Et=r(550),Zt=r(362),Ht=r(30),Wt=r(290),Jt=r.n(Wt),Ut=r(398),Gt=r.n(Ut),qt=r(400),Yt=r.n(qt),Qt=r(399),Vt=r.n(Qt),$t=r(556),Kt=r(397),Xt=r.n(Kt),er=Object(Q.a)((function(e){return{avatar:{margin:0},avatarOn:{margin:0,cursor:"pointer",backgroundColor:e.palette.primary.main}}}));var tr=function(){var e=v(),t=Object(N.a)(e,1)[0].searchType,r=er();return Object(h.jsx)(Ze.a,{title:"Me",children:Object(h.jsx)($t.a,{className:"gps"===t?r.avatarOn:r.avatar,children:Object(h.jsx)(Xt.a,{})})})},rr=r(361),nr=r(548),ar=Object(Q.a)((function(){return{dialog:{border:"1px solid #E0E0E0"}}}));var ir=function(){var e=w(),t=Object(N.a)(e,2),r=t[0],n=r.mapSettings,a=r.mapSettingsDialogOpen,i=t[1],o=v(),s=Object(N.a)(o,2),c=s[0].displayClosedLibraries,l=s[1],u=function(){i({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!1})},d=ar(),p=Object(V.a)(),b=Object($.a)(p.breakpoints.down("sm"));return Object(h.jsxs)(z.a,{fullScreen:b,disableBackdropClick:!0,open:a,onClose:u,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:d.dialog},children:[Object(h.jsx)(F.a,{children:"Map settings"}),Object(h.jsxs)(D.a,{children:[Object(h.jsx)(E.a,{disableSticky:!0,children:"Display"}),Object(h.jsx)(rr.a,{control:Object(h.jsx)(nr.a,{checked:n.libraries,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"libraries"})},name:"sw_libraries",color:"primary"}),label:"Libraries"}),Object(h.jsx)("br",{}),Object(h.jsx)(rr.a,{control:Object(h.jsx)(nr.a,{checked:c,onChange:function(){l({type:"SetDisplayClosedLibraries",displayClosedLibraries:!c})},name:"sw_closedlibraries",color:"primary"}),label:"Closed libraries"}),Object(h.jsx)("br",{}),Object(h.jsx)(rr.a,{control:Object(h.jsx)(nr.a,{checked:n.mobileLibraryStops,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"mobileLibraryStops"})},name:"sw_mobile_library_stops",color:"primary"}),label:"Mobile library stops"}),Object(h.jsx)("br",{}),Object(h.jsx)(rr.a,{control:Object(h.jsx)(nr.a,{checked:n.authorityBoundary,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"authorityBoundary"})},name:"sw_authority_boundary",color:"primary"}),label:"Library service boundaries"})]}),Object(h.jsx)(A.a,{children:Object(h.jsx)(T.a,{onClick:u,color:"secondary",endIcon:Object(h.jsx)(X.a,{}),children:"Close"})})]})},or=r(111),sr=function(){function e(t){Object(ce.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e,t){return this.transport=t,this.geo=e,this.display=!0,this}}]),e}();function cr(e,t){return lr.apply(this,arguments)}function lr(){return(lr=Object(_.a)(L.a.mark((function e(t,r){var n,a,i;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=or.travel.filter((function(e){return e.name===r}))[0],a=or.isochroneApi+r+"?longitude="+t[0]+"&latitude="+t[1]+"&interval="+n.interval+"&duration="+n.duration,e.next=4,de.a.get(a);case 4:if(!(i=e.sent)||!i.data){e.next=9;break}return e.abrupt("return",(new sr).fromJson(i.data,r));case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ur=Object(Q.a)((function(e){return{listItemRoot:{minWidth:34},menu:{border:"1px solid #E0E0E0"},settings:{position:"absolute",bottom:e.spacing(4),right:e.spacing(4)}}})),dr=r(111),pr=Object(Ht.f)({minZoom:5,maxZoom:18,customAttribution:"Contains public sector information licensed under the Open Government Licence"}),br=[dr.libraryTiles],fr=[dr.libraryBuildingsTiles],jr=[dr.libraryAuthorityTiles],hr=[dr.stopTiles],mr=[dr.tripTiles];var yr=function(){var e=g(),t=Object(N.a)(e,2),r=t[0].isochrones,n=t[1],i=v(),o=Object(N.a)(i,2),s=o[0],c=s.searchType,l=s.searchPosition,u=s.currentStopId,d=s.currentLibraryId,p=s.currentPoint,b=s.currentService,f=s.displayClosedLibraries,j=o[1],m=w(),y=Object(N.a)(m,2),x=y[0],O=x.mapZoom,S=x.mapPosition,k=x.mapSettings,C=x.mapSettingsDialogOpen,P=x.mapBounds,I=x.isochronesMenuOpen,B=x.isochronesMenuAnchor,M=y[1];Object(a.useEffect)((function(){}),[]);var T=function(){var e=Object(_.a)(L.a.mark((function e(t){var r,n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.features&&t.features.length>0&&t.features[0].properties)){e.next=7;break}return r=t.features[0].properties.id,e.next=4,_e(r);case 4:n=e.sent,j({type:"SetCurrentLibrary",currentLibraryId:r,currentPoint:[n.longitude,n.latitude]}),M({type:"SetIsochronesMenu",isochronesMenuOpen:!0,isochronesMenuAnchor:{left:t.point.x,top:t.point.y}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(_.a)(L.a.mark((function e(t){var r,n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.features&&t.features.length>0&&t.features[0].properties)){e.next=7;break}return r=t.features[0].properties.id,e.next=4,ye(r);case 4:n=e.sent,j({type:"SetCurrentStop",currentStopId:r,currentPoint:[n.longitude,n.latitude]}),M({type:"SetIsochronesMenu",isochronesMenuOpen:!0,isochronesMenuAnchor:{left:t.point.x,top:t.point.y}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(_.a)(L.a.mark((function e(t){var a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r[p]||!r[p][t]){e.next=4;break}n({type:"SetIsochroneDisplay",point:p,transport:t,display:!r[p][t].display}),e.next=8;break;case 4:return e.next=6,cr(p,t);case 6:a=e.sent,n({type:"AddIsochrone",point:p,transport:t,isochrone:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){return M({type:"SetIsochronesMenu",isochronesMenuOpen:!1,isochronesMenuAnchor:null})},F=ur(),R={"cycling-regular":Object(h.jsx)(Gt.a,{fontSize:"small",color:r[p]&&r[p]["cycling-regular"]&&r[p]["cycling-regular"].display?"primary":"secondary"}),"driving-car":Object(h.jsx)(Vt.a,{fontSize:"small",color:r[p]&&r[p]["driving-car"]&&r[p]["driving-car"].display?"primary":"secondary"}),"foot-walking":Object(h.jsx)(Yt.a,{fontSize:"small",color:r[p]&&r[p]["foot-walking"]&&r[p]["foot-walking"].display?"primary":"secondary"})};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(pr,{style:"style.json",center:S,zoom:O,maxZoom:18,pitch:[0],bearing:[0],fitBounds:P,containerStyle:{top:0,bottom:0,right:0,left:0,height:"100vh",width:"100vw",position:"absolute"},children:[b&&b.geojson?Object(h.jsx)(Ht.a,{data:JSON.parse(b.geojson),linePaint:{"line-opacity":.4,"line-width":2,"line-color":"#455a64"}}):null,Object.keys(r).map((function(e){return Object.keys(r[e]).filter((function(t){return r[e][t]&&r[e][t].display})).map((function(t,n){return Object(h.jsxs)("span",{children:[Object(h.jsx)(Ht.a,{data:r[e][t].geo,fillPaint:{"fill-opacity":.1,"fill-antialias":!0,"fill-color":dr.travel.filter((function(e){return e.name===t}))[0].colour},fillOnClick:function(e){}}),Object(h.jsx)(Ht.a,{data:r[e][t].geo,linePaint:{"line-opacity":.4,"line-width":2,"line-color":dr.travel.filter((function(e){return e.name===t}))[0].colour}}),Object(h.jsx)(Ht.a,{data:r[e][t].geo,symbolLayout:{"text-field":["concat",["to-string",["/",["get","value"],60]]," min"],"text-font":["Source Sans Pro Bold"],"symbol-placement":"line","text-allow-overlap":!1,"text-padding":2,"text-max-angle":90,"text-size":{base:1.2,stops:[[8,12],[22,30]]},"text-letter-spacing":.1},symbolPaint:{"text-halo-color":"rgba(255, 255, 255, 0.9)","text-halo-width":4,"text-halo-blur":2,"text-color":dr.travel.filter((function(e){return e.name===t}))[0].colour}}),Object(h.jsx)(Ht.a,{data:r[e][t].geo,symbolLayout:{"text-field":["concat",["get","total_pop"]],"text-font":["Source Sans Pro Bold"],"symbol-placement":"line","text-allow-overlap":!1,"text-keep-upright":!1,"text-padding":2,"text-max-angle":0,"text-offset":[0,1],"text-size":{base:1.2,stops:[[10,8],[22,14]]},"text-letter-spacing":.1},symbolPaint:{"text-halo-color":"rgba(255, 255, 255, 0.9)","text-halo-width":0,"text-halo-blur":0,"text-color":dr.travel.filter((function(e){return e.name===t}))[0].colour}})]},"sp_isotransport_"+n)}))})),Object(h.jsx)(Ht.d,{id:"src_libraries_buildings",tileJsonSource:{type:"vector",tiles:fr}}),Object(h.jsx)(Ht.b,{id:"lyr_library_buildings_lines",type:"line",sourceId:"src_libraries_buildings",sourceLayer:"library_buildings",minZoom:14,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#455a64","line-opacity":.8,"line-width":["interpolate",["linear"],["zoom"],14,2,18,3]}}),Object(h.jsx)(Ht.b,{id:"lyr_library_buildings_fill",type:"fill",sourceId:"src_libraries_buildings",sourceLayer:"library_buildings",minZoom:14,paint:{"fill-color":"#455a64","fill-opacity":.3}}),Object(h.jsx)(Ht.d,{id:"src_library_authorities",tileJsonSource:{type:"vector",tiles:jr}}),k.authorityBoundary?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ht.b,{id:"lyr_library_authorities_lines",type:"line",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],6,1,18,4]}}),Object(h.jsx)(Ht.b,{id:"lyr_library_authorities_fill",type:"fill",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,paint:{"fill-color":"#ccc","fill-opacity":.1}})]}):null,Object(h.jsx)(Ht.d,{id:"src_trips",tileJsonSource:{type:"vector",tiles:mr}}),Object(h.jsx)(Ht.b,{id:"lyr_trips_lines",type:"line",sourceId:"src_trips",sourceLayer:"trip",minZoom:14,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-offset":["interpolate",["linear"],["zoom"],14,1,18,4],"line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],14,1,18,4],"line-dasharray":[2,.5]}}),Object(h.jsx)(Ht.d,{id:"src_stops",tileJsonSource:{type:"vector",tiles:hr}}),k.mobileLibraryStops?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ht.b,{id:"lyr_stops_circles",type:"circle",sourceId:"src_stops",sourceLayer:"stop",minZoom:5,layout:{},paint:{"circle-radius":["interpolate",["linear"],["zoom"],5,2,18,8],"circle-color":"#455a64","circle-stroke-width":["interpolate",["linear"],["zoom"],5,1,18,3],"circle-stroke-color":"#ffffff","circle-opacity":.5},onClick:z}),Object(h.jsx)(Ht.b,{id:"lyr_stops_labels",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:13,layout:{"text-ignore-placement":!1,"text-field":["concat","Mobile: ",["get","name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,12,18,18],"text-offset":["interpolate",["linear"],["zoom"],13,["literal",[0,1.5]],18,["literal",[0,2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:z}),Object(h.jsx)(Ht.b,{id:"lyr_stops_next_visiting",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:14,layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","next_visiting"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],14,10,18,16],"text-offset":["interpolate",["linear"],["zoom"],13,["literal",[0,-1.5]],18,["literal",[0,-2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:z})]}):null,Object(h.jsx)(Ht.d,{id:"src_libraries",tileJsonSource:{type:"vector",tiles:br}}),f?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ht.b,{id:"lyr_libraries_closed_name_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:12,filter:["has","Year closed"],layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","Library name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],12,10,18,14],"text-offset":["interpolate",["linear"],["zoom"],12,["literal",[0,1.5]],18,["literal",[0,2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0,"text-halo-blur":0,"text-color":"#d32f2f","text-opacity":.9},onClick:T}),Object(h.jsx)(Ht.b,{id:"lyr_libraries_closed_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:12,filter:["has","Year closed"],layout:{"text-ignore-placement":!1,"text-field":["concat","Closed ",["get","Year closed"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],12,10,18,14],"text-offset":["interpolate",["linear"],["zoom"],12,["literal",[0,-1.5]],18,["literal",[0,-2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0,"text-halo-blur":1,"text-color":"#d32f2f","text-opacity":.9},onClick:T}),Object(h.jsx)(Ht.b,{id:"lyr_libraries_closed_circles",type:"circle",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:11,filter:["has","Year closed"],paint:{"circle-radius":["interpolate",["linear"],["zoom"],12,3,18,8],"circle-color":"#b71c1c","circle-stroke-width":["interpolate",["linear"],["zoom"],12,1,18,3],"circle-stroke-color":"#ffffff","circle-stroke-opacity":.9,"circle-opacity":.6},onClick:T})]}):null,k.libraries?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ht.b,{id:"lyr_libraries_open_type_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:13,filter:["!",["has","Year closed"]],layout:{"text-ignore-placement":!1,"text-field":["match",["get","Type of library"],"LAL","Local authority library","LAL-","Local authority run - unstaffed","CL","Commissioned library","CRL","Community run library","IL","Independent library","Unknown library"],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,12,18,16],"text-offset":["interpolate",["linear"],["zoom"],13,["literal",[0,-1.5]],18,["literal",[0,-2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:T}),Object(h.jsx)(Ht.b,{id:"lyr_libraries_open_name_labels",type:"symbol",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:10,filter:["!",["has","Year closed"]],layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","Library name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],10,14,18,18],"text-offset":["interpolate",["linear"],["zoom"],10,["literal",[0,1.5]],18,["literal",[0,2]]]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73","text-opacity":1},onClick:T}),Object(h.jsx)(Ht.b,{id:"lyr_libraries_open_circles",type:"circle",sourceId:"src_libraries",sourceLayer:"libraries",minZoom:5,filter:["!",["has","Year closed"]],paint:{"circle-radius":["interpolate",["linear"],["zoom"],5,3,18,12],"circle-color":["match",["get","Type of library"],"LAL","#1b5e20","LAL-","#388e3c","CL","#0d47a1","CRL","#e65100","ICL","#bf360c","#bf360c"],"circle-stroke-width":["interpolate",["linear"],["zoom"],5,1,18,4],"circle-stroke-color":"#ffffff","circle-stroke-opacity":["interpolate",["linear"],["zoom"],5,.8,18,1],"circle-opacity":["interpolate",["linear"],["zoom"],5,.4,18,.9]},onClick:T})]}):null,l&&l.length>1?Object(h.jsx)(Ht.c,{coordinates:[l[0],l[1]],children:Object(h.jsx)(tr,{searchType:c})},"mk_me"):null,Object(h.jsx)(Ht.e,{position:"bottom-left"})]}),Object(h.jsx)(Ze.a,{title:"Map settings",children:Object(h.jsx)(Rt.a,{size:"small",className:F.settings,color:"primary",style:{color:"white",border:"1px solid #FFFFFF"},onClick:function(){return M({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!0})},children:Object(h.jsx)(Jt.a,{})})}),Object(h.jsx)(ir,{mapSettings:k,mapSettingsDialogOpen:C}),Object(h.jsxs)(ut.a,{id:"mnu-isochrones",anchorPosition:B,anchorReference:"anchorPosition",elevation:0,className:F.menu,keepMounted:!0,open:I,onClose:D,children:[Object(h.jsxs)(dt.a,{dense:!0,onClick:function(){D(),u&&M({type:"SetStopDialog",stopDialogOpen:!0}),d&&M({type:"SetLibraryDialog",libraryDialogOpen:!0})},children:[Object(h.jsx)(Et.a,{classes:{root:F.listItemRoot},children:Object(h.jsx)(Jt.a,{fontSize:"small"})}),Object(h.jsx)(Zt.a,{primary:"More info"})]}),dr.travel.map((function(e,t){return Object(h.jsxs)(dt.a,{dense:!0,onClick:function(){return A(e.name)},children:[Object(h.jsx)(Et.a,{classes:{root:F.listItemRoot},children:R[e.name]}),Object(h.jsx)(Zt.a,{primary:e.description})]},"mnu_trv_"+t)}))]})]})},gr=r(551),xr=r(401),Or=r.n(xr);var vr=function(){var e=w(),t=Object(N.a)(e,2),r=t[0],n=r.notificationOpen,a=r.notificationMessage,i=t[1],o=function(){i({type:"SetNotification",notificationOpen:!1})};return Object(h.jsx)(gr.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n,autoHideDuration:3e3,onClose:o,ContentProps:{"aria-describedby":"message-id"},message:Object(h.jsx)("span",{id:"message-id",children:a}),action:[Object(h.jsx)(De.a,{"aria-label":"close",onClick:o,children:Object(h.jsx)(Or.a,{color:"inherit"})},"close")]})},Sr=r(380),kr=r(382),wr=r(181),Cr=r.n(wr),Lr=r(233),_r=r.n(Lr),Pr=r(232),Nr=r.n(Pr),Ir=r(231),Br=r.n(Ir),Mr=r(229),Tr=r.n(Mr),zr=r(228),Ar=r.n(zr),Dr=r(230),Fr=r.n(Dr),Rr=r(234),Er=r.n(Rr),Zr=Object(Q.a)((function(e){return{closedChip:{marginTop:e.spacing(1)},table:{backgroundColor:"rgba(0, 0, 0, 0)",border:"2px solid #ffe0b2"}}}));var Hr=function(){var e=v(),t=Object(N.a)(e,2),r=t[0],n=r.searchDistance,o=r.searchPosition,s=r.serviceFilter,l=r.displayClosedLibraries,u=t[1],d=w(),p=Object(N.a)(d,2);Object(P.a)(p[0]);var b=p[1],f=i.a.createRef();Object(a.useEffect)((function(){f.current.onQueryChange()}),[o,n,s,l]);var j=Zr(),m=Object(V.a)();return Object(h.jsxs)("div",{children:[Object(h.jsx)(E.a,{disableSticky:!0,children:"Libraries"}),Object(h.jsx)(rr.a,{control:Object(h.jsx)(Sr.a,{checked:l,onChange:function(){u({type:"SetDisplayClosedLibraries",displayClosedLibraries:!l})},name:"checkedB",color:"primary"}),label:"Display permanently closed libraries"}),Object(h.jsx)(Cr.a,{tableRef:f,components:{Container:function(e){return Object(h.jsx)(Y.a,Object(c.a)(Object(c.a)({},e),{},{elevation:0,className:j.table}))}},icons:{Filter:Ar.a,FirstPage:Tr.a,LastPage:Fr.a,NextPage:Br.a,PreviousPage:Nr.a,SortArrow:_r.a},options:{padding:Object($.a)(m.breakpoints.up("sm"))?"default":"dense",search:!1,loadingType:"overlay",actionsColumnIndex:0,filtering:!1,toolbar:!1,headerStyle:{backgroundColor:"#fff3e0",color:"#e65100",border:"0px"}},columns:[{title:"",field:"name",filtering:!1,sorting:!1,render:function(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ze.a,{title:"See more details on the library",children:Object(h.jsx)(De.a,{size:"small",color:"secondary",onClick:function(){return u({type:"SetCurrentLibrary",currentLibraryId:e.id}),void b({type:"SetLibraryDialog",libraryDialogOpen:!0})},children:Object(h.jsx)(Er.a,{})})}),Object(h.jsx)(Ze.a,{title:"See this library on the library map",children:Object(h.jsx)(De.a,{size:"small",color:"primary",onClick:function(){var t;b({type:"SetMapPosition",mapPosition:[(t=e).longitude,t.latitude],mapZoom:16})},component:I.b,to:"/map",children:Object(h.jsx)(ie.a,{})})}),e.url?Object(h.jsx)(Ze.a,{title:"Go to the library website",children:Object(h.jsx)(De.a,{size:"small",color:"primary",onClick:function(){return t=e,window.open(t.url,"_blank");var t},children:Object(h.jsx)(ne.a,{})})}):null]})},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Name",field:"name",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"},render:function(e){return Object(h.jsxs)(h.Fragment,{children:[e.name,null!==e.yearClosed?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("br",{}),Object(h.jsx)(kr.a,{color:"secondary",className:j.closedChip,size:"small",label:"Closed "+e.yearClosed})]}):null]})}},{title:"Service",field:"localAuthority",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Address",field:"address1",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"},render:function(e){return[e.address1,e.address2,e.address3].filter(Boolean).join(", ")}},{title:"Postcode",field:"postcode",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Today",field:"mondayStaffedHours",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"},render:function(e){var t=Ie(e,be()().format("dddd").toLowerCase()),r=t.unstaffed?t.unstaffed.map((function(e){return e})):null;return Object(h.jsxs)(h.Fragment,{children:[null===t.staffed&&null===r?"Opening hours unknown":null,null!==t.staffed&&t.staffed.length>0?t.staffed.map((function(e){return e.map((function(e){return be()(e,"hh:mm").format("h:mma")})).join(" - ")})):"",!t.staffed||0!==t.staffed.length||null!==t.unstaffed&&0!==t.unstaffed.length?"":"Closed today",t.unstaffed&&t.unstaffed.length>0?Object(h.jsx)("br",{}):null,t.unstaffed&&t.unstaffed.length>0?"Unstaffed "+r:null]})}}],data:function(e){return new Promise((function(t){function r(){return(r=Object(_.a)(L.a.mark((function r(){var a;return L.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ce(e,o,n,s,l);case 2:a=r.sent,t({data:a.libraries,page:a.page-1,totalCount:a.total});case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}))}})]})},Wr=Object(Q.a)((function(e){return{hoursChip:{margin:e.spacing(1)},table:{backgroundColor:"rgba(0, 0, 0, 0)",border:"2px solid #ffe0b2"}}}));var Jr=function(){var e=v(),t=Object(N.a)(e,2),r=t[0],n=r.searchDistance,o=r.searchPosition,s=r.serviceFilter,l=t[1],u=w(),d=Object(N.a)(u,2);Object(P.a)(d[0]);var p=d[1],b=i.a.createRef();Object(a.useEffect)((function(){b.current.onQueryChange()}),[o,n,s]);var f=Wr(),j=Object(V.a)();return Object(h.jsxs)("div",{children:[Object(h.jsx)(E.a,{disableSticky:!0,children:"Mobile library stops"}),Object(h.jsx)(Cr.a,{tableRef:b,components:{Container:function(e){return Object(h.jsx)(Y.a,Object(c.a)(Object(c.a)({},e),{},{elevation:0,className:f.table}))}},icons:{Filter:Ar.a,FirstPage:Tr.a,LastPage:Fr.a,NextPage:Br.a,PreviousPage:Nr.a,SortArrow:_r.a},options:{padding:Object($.a)(j.breakpoints.up("sm"))?"default":"dense",search:!1,loadingType:"overlay",actionsColumnIndex:0,filtering:!1,toolbar:!1,headerStyle:{backgroundColor:"#fff3e0",color:"#e65100",border:"0px"}},columns:[{title:"",field:"name",filtering:!1,sorting:!1,render:function(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Ze.a,{title:"See more stop details",children:Object(h.jsx)(De.a,{size:"small",onClick:function(){return l({type:"SetCurrentStop",currentStopId:e.id}),void p({type:"SetStopDialog",stopDialogOpen:!0})},children:Object(h.jsx)(Er.a,{})})}),Object(h.jsx)(Ze.a,{title:"See this stop on the library map",children:Object(h.jsx)(De.a,{size:"small",color:"primary",onClick:function(){var t;p({type:"SetMapPosition",mapPosition:[(t=e).longitude,t.latitude],mapZoom:16})},component:I.b,to:"/map",children:Object(h.jsx)(ie.a,{})})}),e.url?Object(h.jsx)(Ze.a,{title:"Go to the library website",children:Object(h.jsx)(De.a,{size:"small",color:"primary",onClick:function(){return t=e,window.open(t.url,"_blank");var t},children:Object(h.jsx)(ne.a,{})})}):null]})},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Community",field:"community",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Name",field:"name",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Service",field:"organisationName",filtering:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Address",field:"address",filtering:!1,sorting:!1,hidden:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}}],data:function(e){return new Promise((function(t){function r(){return(r=Object(_.a)(L.a.mark((function r(){var a;return L.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,he(e,o,n,s);case 2:a=r.sent,t({data:a.stops,page:a.page-1,totalCount:a.total});case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}))}})]})},Ur=r(403),Gr=r.n(Ur),qr=Object(Q.a)((function(e){return{button:{marginRight:e.spacing(1)},chip:{marginRight:e.spacing(1)}}}));var Yr=Object(B.g)((function(e){var t=g(),r=Object(N.a)(t,1)[0],n=r.services,i=r.serviceLookup,o=v(),s=Object(N.a)(o,2),c=s[0].serviceFilter,l=s[1],u=w(),d=Object(N.a)(u,2);Object(P.a)(d[0]);var p=d[1],b=Object(a.useState)(null),f=Object(N.a)(b,2),j=f[0],m=f[1],y=function(){return m(null)},x=function(t){var r=JSON.parse(t.bbox).coordinates[0];l({type:"FilterByService",service:t}),p({type:"FitToBounds",bounds:[r[0],r[2]]}),function(e,t){var r=new URLSearchParams(window.location.search);r.set("service",t),e.push(window.location.pathname+"?"+r.toString())}(e.history,t.systemName),y()},O=qr();return Object(h.jsxs)(h.Fragment,{children:[0===c.length?Object(h.jsx)(Ze.a,{title:"Choose library service",children:Object(h.jsx)(T.a,{color:"primary",className:O.button,onClick:function(e){return t=e.currentTarget,m(t);var t},startIcon:Object(h.jsx)(Gr.a,{}),children:"Choose service"})}):Object(h.jsx)(kr.a,{className:O.chip,color:"primary",onDelete:function(){l({type:"ClearAll"}),_t(e.history)},label:i[c[0]].name}),Object(h.jsx)(ut.a,{id:"menu-library-service",anchorEl:j,keepMounted:!0,open:Boolean(j),onClose:function(){return y()},children:n.sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return Object(h.jsx)(dt.a,{onClick:function(){return x(e)},children:e.name},"mnu_itm_org_"+e.code)}))})]})})),Qr=Object(Q.a)((function(e){return{search:{alignContent:"center",textAlign:"center",display:"table",marginLeft:"auto",marginRight:"auto",marginBottom:"10px"},subtitle:{textAlign:"center",marginBottom:"5px"},title:{textAlign:"center"}}}));var Vr=function(){var e=Qr();return Object(h.jsxs)("div",{children:[Object(h.jsx)(q.a,{component:"h2",variant:"h3",color:"secondary",className:e.title,children:"Find my library"}),Object(h.jsx)(q.a,{component:"p",variant:"subtitle1",className:e.subtitle,children:"Search by postcode or library service"}),Object(h.jsx)("div",{className:e.search,children:Object(h.jsx)(Nt,{settings:!0})}),Object(h.jsx)("div",{className:e.search,children:Object(h.jsx)(Yr,{})}),Object(h.jsx)(Hr,{}),Object(h.jsx)("br",{}),Object(h.jsx)(Jr,{})]})},$r=r(405),Kr=r(404),Xr=r(5),en=["classes"],tn=Object(Q.a)((function(e){return{listItem:{marginTop:e.spacing(1)},root:{"& table":{display:"block",wordBreak:"normal",width:"100%",overflowX:"auto",WebkitOverflowScrolling:"touch",borderCollapse:"collapse",marginBottom:"16px",borderSpacing:0,overflow:"hidden","& .prop-name":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace'},"& .required":{color:"light"===e.palette.type?"#006500":"#a5ffa5"},"& .prop-type":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',color:"light"===e.palette.type?"#932981":"#ffb6ec"},"& .prop-default":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',borderBottom:"1px dotted ".concat(e.palette.divider)}},"& td":Object(c.a)(Object(c.a)({},e.typography.body2),{},{borderBottom:"1px solid ".concat(e.palette.divider),padding:16,color:e.palette.text.primary}),"& th":{fontSize:14,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium,color:e.palette.text.primary,whiteSpace:"pre",borderBottom:"1px solid ".concat(e.palette.divider),padding:16}}}})),rn={overrides:{h1:{component:q.a,props:{gutterBottom:!0,variant:"h4",color:"secondary"}},h2:{component:q.a,props:{gutterBottom:!0,variant:"h5",color:"textPrimary"}},h3:{component:q.a,props:{gutterBottom:!0,variant:"h6",color:"textPrimary"}},h4:{component:q.a,props:{gutterBottom:!0,variant:"h6",paragraph:!0,color:"textPrimary"}},p:{component:q.a,props:{paragraph:!0,color:"textPrimary"}},a:{component:Tt.a},li:{component:Object(Xr.a)(tn)((function(e){var t=e.classes,r=Object($r.a)(e,en);return Object(h.jsx)("li",{className:t.listItem,children:Object(h.jsx)(q.a,Object(c.a)({component:"span"},r))})}))}}};function nn(e){var t=e.page,r=Object(a.useState)(""),n=Object(N.a)(r,2),i=n[0],o=n[1],s=tn();return Object(a.useEffect)((function(){function e(){return e=Object(_.a)(L.a.mark((function e(){var r,n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t);case 2:return r=e.sent,e.next=5,r.text();case 5:n=e.sent,o(n);case 7:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),Object(h.jsx)(Kr.a,Object(c.a)(Object(c.a)({className:s.root,options:rn},e),{},{children:i}))}var an=i.a.memo(nn),on=r.p+"static/media/data.66eb81e2.md",sn=r(111),cn=function(){function e(t){Object(ce.a)(this,e),Object.assign(this,t)}return Object(le.a)(e,[{key:"fromJson",value:function(e){return this.code=e.utla19cd,this.name=e.utla19nm,this.nameWales=e.utla19nmw,this.systemName=e.utla19nm.split(", ").reverse().join(" ").replace(/[. ,:-]+/g,"-").toLowerCase(),this.geojson=e.geojson,this.bbox=e.bbox,this}}]),e}();function ln(){return un.apply(this,arguments)}function un(){return(un=Object(_.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.a.get(sn.servicesApi);case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=7;break}return e.abrupt("return",t.data.map((function(e){return(new cn).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var dn=Object(Q.a)((function(e){return{content:{flexGrow:1,padding:e.spacing(2)},root:{flexGrow:1}}}));var pn=function(){var e=g(),t=Object(N.a)(e,2);Object(P.a)(t[0]);var r=t[1],n=v(),i=Object(N.a)(n,2);Object(P.a)(i[0]);var o=i[1],s=w(),c=Object(N.a)(s,2);Object(P.a)(c[0]);var l=c[1];Object(a.useEffect)((function(){function e(){return(e=Object(_.a)(L.a.mark((function e(){var t,n,a,i,s,c,u;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ln();case 2:t=e.sent,n={},a={},t.forEach((function(e){n[e.code]=e,a[e.systemName]=e})),r({type:"AddServices",services:t,serviceLookup:n}),i=new URLSearchParams(window.location.search),(s=i.get("service"))&&a[s]&&(c=a[s],u=JSON.parse(c.bbox).coordinates[0],o({type:"FilterByService",service:c}),l({type:"FitToBounds",bounds:[u[0],u[2]]}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var u=dn();return Object(h.jsxs)(I.a,{children:[Object(h.jsxs)("div",{className:u.root,children:[Object(h.jsx)(Bt,{loading:!1,site:3}),Object(h.jsx)(M.a,{maxWidth:"lg",children:Object(h.jsx)("main",{className:u.content,children:Object(h.jsxs)(B.c,{children:[Object(h.jsx)(B.a,{path:"/",exact:!0,render:function(){return Object(h.jsx)(Vr,{})}}),Object(h.jsx)(B.a,{path:"/map",exact:!0,render:function(){return Object(h.jsx)(yr,{})}}),Object(h.jsx)(B.a,{path:"/data",exact:!0,render:function(){return Object(h.jsx)(an,{page:on})}}),Object(h.jsx)(B.a,{path:["/http:","/https:"],component:function(e){return window.location.replace(e.location.pathname.substr(1)),null}}),Object(h.jsx)(B.a,{component:function(e){e.location;return Object(h.jsx)("div",{children:Object(h.jsx)("h2",{children:"Sorry! That page was not found"})})}})]})})}),Object(h.jsx)(M.a,{maxWidth:"lg",children:Object(h.jsx)(Ft,{})}),Object(h.jsx)(vr,{})]}),Object(h.jsx)(ve,{}),Object(h.jsx)(Te,{})]})},bn={services:[],serviceLookup:{},isochrones:{}},fn=function(e,t){var r=e.isochrones;switch(t.type){case"AddServices":return Object(c.a)(Object(c.a)({},e),{},{services:t.services,serviceLookup:t.serviceLookup});case"AddIsochrone":return r[t.point]||(r[t.point]={}),r[t.point][t.transport]=t.isochrone,console.log(r),Object(c.a)(Object(c.a)({},e),{},{isochrones:r});case"SetIsochroneDisplay":return r[t.point][t.transport].display=t.display,Object(c.a)(Object(c.a)({},e),{},{isochrones:r});case"SetIsochroneLoading":return r[t.point]||(r[t.point]={}),r[t.point][t.transport]={geo:null,display:!1,loading:!0},Object(c.a)(Object(c.a)({},e),{},{isochrones:r});default:return e}},jn={searchPostcode:"",searchType:"",searchDistance:1609,searchPosition:[],currentStopId:null,currentLibraryId:null,currentPoint:[],serviceFilter:[],serviceFilterBbox:null,serviceFilterBoundary:null,currentService:null,currentServiceSystemName:null,displayClosedLibraries:!1},hn=function(e,t){switch(t.type){case"SetCurrentStop":return Object(c.a)(Object(c.a)({},e),{},{currentStopId:t.currentStopId,currentPoint:t.currentPoint});case"SetCurrentLibrary":return Object(c.a)(Object(c.a)({},e),{},{currentLibraryId:t.currentLibraryId,currentPoint:t.currentPoint});case"SetSearchDistance":return Object(c.a)(Object(c.a)({},e),{},{searchDistance:t.searchDistance});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{serviceFilter:[],currentService:null,currentServiceSystemName:null,searchPostcode:t.searchPostcode,searchPosition:t.searchPosition,searchType:"postcode"});case"SetDisplayClosedLibraries":return Object(c.a)(Object(c.a)({},e),{},{displayClosedLibraries:t.displayClosedLibraries});case"FilterByService":return Object(c.a)(Object(c.a)({},e),{},{serviceFilter:[t.service.code],currentService:t.service,currentServiceSystemName:t.service.systemName,searchPostcode:"",searchPosition:[],searchType:"service"});case"ClearAll":return Object(c.a)(Object(c.a)({},e),{},{serviceFilter:[],currentService:null,currentServiceSystemName:null,searchPostcode:"",searchPosition:[],searchType:""});default:return e}},mn={notificationOpen:!1,notificationMessage:"",mapZoom:[7],mapPosition:[-1.155414,52.691432],mapBounds:null,mapSettings:{libraries:!0,mobileLibraryStops:!0,authorityBoundary:!1},mapSettingsDialogOpen:!1,libraryDialogOpen:!1,stopDialogOpen:!1,loadingPostcode:!1,loadingServices:!1,isochronesMenuOpen:!1,isochronesMenuAnchor:null},yn=function(e,t){switch(t.type){case"SetNotificationMessage":return Object(c.a)(Object(c.a)({},e),{},{notificationMessage:t.notificationMessage});case"SetNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:t.notificationOpen});case"ShowNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:!0,notificationMessage:t.notificationMessage});case"SetStopDialog":return Object(c.a)(Object(c.a)({},e),{},{stopDialogOpen:t.stopDialogOpen});case"SetLibraryDialog":return Object(c.a)(Object(c.a)({},e),{},{libraryDialogOpen:t.libraryDialogOpen});case"SetMapSettingsDialog":return Object(c.a)(Object(c.a)({},e),{},{mapSettingsDialogOpen:t.mapSettingsDialogOpen});case"ToggleMapSetting":var r=e.mapSettings;return r[t.mapSetting]=!r[t.mapSetting],Object(c.a)(Object(c.a)({},e),{},{mapSettings:r});case"FitToBounds":return Object(c.a)(Object(c.a)({},e),{},{mapBounds:t.bounds});case"ToggleLoadingPostcode":return Object(c.a)(Object(c.a)({},e),{},{loadingPostcode:!e.loadingPostcode});case"ToggleLoadingServices":return Object(c.a)(Object(c.a)({},e),{},{loadingServices:!e.loadingServices});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{loadingPostcode:!1,mapPosition:t.mapPosition,mapZoom:[13]});case"SetMapPosition":return Object(c.a)(Object(c.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[t.mapZoom]});case"SetIsochronesMenu":return Object(c.a)(Object(c.a)({},e),{},{isochronesMenuOpen:t.isochronesMenuOpen,isochronesMenuAnchor:t.isochronesMenuAnchor});default:return e}},gn=Object(f.a)({palette:{primary:{main:b.a[900]},secondary:{main:d.a[600]},outline:{main:d.a[50]}},overrides:{MuiButton:{text:{textTransform:"none"},root:{textTransform:"none"}},MuiTypography:{button:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}}}});var xn=function(){return Object(h.jsx)(y,{initialState:bn,reducer:fn,children:Object(h.jsx)(O,{initialState:jn,reducer:hn,children:Object(h.jsx)(k,{initialState:mn,reducer:yn,children:Object(h.jsxs)(j.a,{theme:gn,children:[Object(h.jsx)(l.a,{}),Object(h.jsx)(pn,{})]})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r(509);s.a.render(Object(h.jsx)(xn,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[510,1,2]]]);
//# sourceMappingURL=main.5236d712.chunk.js.map