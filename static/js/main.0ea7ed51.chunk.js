(this.webpackJsonplibrarymap=this.webpackJsonplibrarymap||[]).push([[0],{260:function(e){e.exports=JSON.parse('{"api":"https://api.librarydata.uk/","postcodeApi":"https://api-geography.librarydata.uk/rest/postcodes/","libraryAuthorityTiles":"https://api-geography.librarydata.uk/rest/libraryauthorities/{z}/{x}/{y}.mvt"}')},288:function(e,t,a){e.exports=a(511)},511:function(e,t,a){"use strict";a.r(t);a(289),a(298);var n=a(0),r=a.n(n),o=a(15),i=a.n(o),c=a(27),l=a(577),s=a(278),m=a.n(s),u=a(277),p=a.n(u),d=a(279),b=a(576),h=Object(n.createContext)(),g=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(h.Provider,{value:Object(n.useReducer)(t,a)},o)},E=function(){return Object(n.useContext)(h)},f=Object(n.createContext)(),y=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(f.Provider,{value:Object(n.useReducer)(t,a)},o)},O=function(){return Object(n.useContext)(f)},v=Object(n.createContext)(),j=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(v.Provider,{value:Object(n.useReducer)(t,a)},o)},S=function(){return Object(n.useContext)(v)},k=a(81),w=a(21),x=a(97),N=a(25),C=a(564),T=a(559),P=a(565),_=a(569),M=a(570),B=a(580),D=a(562),L=a(566),R=a(578),z=a(567),F=a(583),I=a(280),W=a(272),Z=a.n(W),A=a(180),G=a.n(A),J=a(267),U=a.n(J),q=a(271),H=a.n(q),V=a(143),Y=a.n(V),$=a(269),K=a.n($),Q=a(270),X=a.n(Q),ee=a(268),te=a.n(ee),ae=a(140),ne=a.n(ae),re=a(273),oe=a.n(re),ie=a(75),ce=a.n(ie),le=a(112),se=a(581),me=a(563),ue=a(582),pe=a(585),de=a(177),be=a(265),he=a.n(be),ge=a(266),Ee=a.n(ge),fe=a(263),ye=a.n(fe),Oe=a(260);function ve(e){return je.apply(this,arguments)}function je(){return(je=Object(le.a)(ce.a.mark((function e(t){var a;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(Oe.postcodeApi+t);case 2:return a=e.sent,e.abrupt("return",{location:[a.data.longitude,a.data.latitude],organisation:a.data.library_service_name});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Se=Object(T.a)((function(e){return{grow:{flexGrow:1},iconButton:{padding:10},inputInput:{paddingTop:e.spacing(),paddingRight:e.spacing(),paddingBottom:e.spacing(),paddingLeft:e.spacing(2),fontWeight:500},search:{position:"relative",border:"1px solid #E0E0E0",borderRadius:e.shape.borderRadius,backgroundColor:Object(de.fade)(e.palette.common.white,.8),"&:hover":{backgroundColor:Object(de.fade)(e.palette.common.white,.9)},marginLeft:0,marginRight:e.spacing(),display:"flex",maxWidth:240}}}));var ke=function(){var e=E(),t=Object(w.a)(e,2);Object(k.a)(t[0]),t[1];var a=O(),o=Object(w.a)(a,2),i=o[0],c=i.searchType,l=i.searchPostcode,s=(i.searchDistance,o[1]),m=S(),u=Object(w.a)(m,2);Object(k.a)(u[0]);var p=u[1],d=Object(n.useState)(l),b=Object(w.a)(d,2),h=b[0],g=b[1],f=Object(n.useState)(null),y=Object(w.a)(f,2),v=y[0],j=y[1],x=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}({searchPostcode:l});Object(n.useEffect)((function(){x&&l!==x.searchPostcode&&g(l)}),[l]);var N=function(){return j(null)},C=function(e){N(),s({type:"SetSearchDistance",searchDistance:e}),"postcode"===c&&T()},T=function(){var e=Object(le.a)(ce.a.mark((function e(){var t;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==h){e.next=3;break}return p({type:"ShowNotification",notificationMessage:"You must enter a postcode"}),e.abrupt("return");case 3:return p({type:"LoadingPostcode"}),e.next=6,ve(h);case 6:(t=e.sent).location&&2===t.location.length?(s({type:"SetPostcodeSearch",searchPostcode:h,searchPosition:t.location}),p({type:"SetPostcodeSearch",mapPosition:t.location})):p({type:"ShowNotification",notificationMessage:"Could not find postcode"});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=Se();return r.a.createElement("div",{className:P.search},r.a.createElement(se.a,{placeholder:"Postcode",classes:{input:P.inputInput},value:h,onChange:function(e){return g(e.target.value)}}),r.a.createElement("div",{className:P.grow}),"postcode"===c?r.a.createElement(F.a,{title:"Clear search"},r.a.createElement(D.a,{className:P.iconButton,onClick:function(){return s({type:"ClearAll"})}},r.a.createElement(he.a,null))):null,r.a.createElement(F.a,{title:"Search by postcode"},r.a.createElement(D.a,{color:"primary",className:P.iconButton,onClick:function(){return T()}},r.a.createElement(ne.a,null))),r.a.createElement(F.a,{title:"Change search settings"},r.a.createElement(D.a,{className:P.iconButton,color:"secondary",onClick:function(e){!function(e){j(e.currentTarget)}(e)}},r.a.createElement(Ee.a,null))),r.a.createElement(ue.a,{id:"mnu-settings",anchorEl:v,keepMounted:!0,open:Boolean(v),onClose:function(){return N()}},r.a.createElement(me.a,{disableSticky:!0},"Search distance"),r.a.createElement(pe.a,{onClick:function(){return C(1609)}},"1 mile"),r.a.createElement(pe.a,{onClick:function(){return C(4827)}},"3 miles"),r.a.createElement(pe.a,{onClick:function(){return C(8045)}},"5 miles"),r.a.createElement(pe.a,{onClick:function(){return C(16090)}},"10 miles"),r.a.createElement(pe.a,{onClick:function(){return C(32180)}},"20 miles"),r.a.createElement(pe.a,{onClick:function(){return C(80450)}},"50 miles")))},we=Object(T.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"rgba(250, 250, 250, 0.8)",position:"relative"},grow:{flexGrow:1},iconTitle:{marginLeft:e.spacing(1)},progress:{margin:e.spacing(1)},tabBar:{borderTop:"1px solid #e8e8e8",borderBottom:"1px solid #e8e8e8"},title:{margin:e.spacing(2),display:"inline-block",verticalAlign:"middle"},topIcon:{backgroundColor:"rgba(250, 250, 250, 0.8)",border:"1px solid #e5e5e5","&:hover":{backgroundColor:"rgba(250, 250, 250, 0.8)"}},topTitle:{position:"relative",zIndex:e.zIndex.drawer+1}}}));var xe=function(e){var t=S(),a=Object(w.a)(t,1)[0],o=a.loadingOrganisations,i=a.loadingMobiles,c=a.loadingRoutes,l=a.loadingMobileLocations,s=a.loadingNearestMobiles,m=a.loadingPostcode,u=Object(n.useState)(!1),p=Object(w.a)(u,2),d=p[0],b=p[1],h=Object(n.useState)(e.site),g=Object(w.a)(h,2),E=g[0],f=g[1],y=o||i||c||l||s||m,O=Object(N.e)(),v=we(),j=[{title:"Libraries at home",url:"https://www.librariesathome.co.uk",icon:r.a.createElement(U.a,null),links:[{title:r.a.createElement("span",{className:v.iconTitle},"Search"),short:r.a.createElement("span",{className:v.iconTitle},"Search"),icon:r.a.createElement(ne.a,null),to:"/"},{title:r.a.createElement("span",{className:v.iconTitle},"Watch"),short:r.a.createElement("span",{className:v.iconTitle},"Watch"),icon:r.a.createElement(te.a,null),to:"/watch"},{title:r.a.createElement("span",{className:v.iconTitle},"Read"),short:r.a.createElement("span",{className:v.iconTitle},"Read"),icon:r.a.createElement(K.a,null),to:"/read"},{title:r.a.createElement("span",{className:v.iconTitle},"Listen"),short:r.a.createElement("span",{className:v.iconTitle},"Listen"),icon:r.a.createElement(X.a,null),to:"/listen"}]},{title:"Mobile libraries",url:"https://www.mobilelibraries.org",icon:r.a.createElement(G.a,null),links:[{title:r.a.createElement("span",{className:v.iconTitle},"Mobile vans"),short:r.a.createElement("span",{className:v.iconTitle},"Vans"),icon:r.a.createElement(G.a,null),to:"/"},{title:r.a.createElement("span",{className:v.iconTitle},"Stop locations"),short:r.a.createElement("span",{className:v.iconTitle},"Stops"),icon:r.a.createElement(H.a,null),to:"/stops"},{title:r.a.createElement("span",{className:v.iconTitle},"Map"),short:r.a.createElement("span",{className:v.iconTitle},"Map"),icon:r.a.createElement(Y.a,null),to:"/map"}]},{title:"Library map",url:"https://www.librarymap.co.uk",icon:r.a.createElement(Y.a,null),links:[{title:r.a.createElement("span",{className:v.iconTitle},"Libraries"),short:r.a.createElement("span",{className:v.iconTitle},"Libraries"),icon:r.a.createElement(Z.a,null),to:"/"},{title:r.a.createElement("span",{className:v.iconTitle},"Library map"),short:r.a.createElement("span",{className:v.iconTitle},"Map"),icon:r.a.createElement(Y.a,null),to:"/map"}]}],k=e.site;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{maxWidth:"lg",className:v.topTitle},r.a.createElement(D.a,{className:v.topIcon,color:"primary",onClick:function(){b(!d),f(k)}},r.a.createElement(oe.a,null)),r.a.createElement(I.a,{color:"secondary",variant:"h6",component:"h1",className:v.title},j[k].title)),d?r.a.createElement(P.a,{position:"static",color:"default",elevation:0,className:v.appBar},r.a.createElement(C.a,{maxWidth:"lg"},r.a.createElement(R.a,{className:v.tabBar,value:E,onChange:function(e,t){f(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"primary"},j.map((function(e,t){return r.a.createElement(L.a,{key:"tb_site_"+t,label:e.title,icon:e.icon})}))))):null,r.a.createElement(P.a,{position:"static",color:"inherit",elevation:0,className:v.appBar},r.a.createElement(C.a,{maxWidth:"lg"},r.a.createElement(z.a,null,r.a.createElement(B.a,{smUp:!0},j[E].links.map((function(e,t){return r.a.createElement(F.a,{title:e.title,key:"icnb_menu_md_"+t},r.a.createElement(D.a,{component:x.b,to:E===k?e.to:j[E].url+e.to,disableRipple:O.pathname===e.to,disableFocusRipple:O.pathname===e.to,color:E===k&&O.pathname===e.to?"secondary":"primary"},e.icon))}))),r.a.createElement(B.a,{xsDown:!0,mdUp:!0},j[E].links.map((function(e,t){return r.a.createElement(F.a,{title:e.title,key:"icnb_menu_lg_"+t},r.a.createElement(_.a,{component:x.b,to:E===k?e.to:j[E].url+e.to,disableRipple:O.pathname===e.to,disableFocusRipple:O.pathname===e.to,color:E===k&&O.pathname===e.to?"secondary":"primary",size:"large"},e.icon,e.short))}))),r.a.createElement(B.a,{smDown:!0},j[E].links.map((function(e,t){return r.a.createElement(F.a,{title:e.title,key:"icnb_menu_lg_"+t},r.a.createElement(_.a,{component:x.b,to:E===k?e.to:j[E].url+e.to,disableRipple:O.pathname===e.to,disableFocusRipple:O.pathname===e.to,color:E===k&&O.pathname===e.to?"secondary":"primary",size:"large"},e.icon,e.title))}))),y?r.a.createElement(M.a,{className:v.progress,color:"primary",size:30}):null,r.a.createElement("span",{className:v.grow}),"/map"===O.pathname?r.a.createElement(ke,null):null))))};var Ne=function(){return r.a.createElement("div",{style:{maxWidth:"100%"}},r.a.createElement(me.a,{disableSticky:!0},"Libraries"))},Ce=a(575),Te=a(82),Pe=a(275),_e=a.n(Pe),Me=a(587),Be=a(274),De=a.n(Be),Le=Object(T.a)((function(e){return{avatar:{margin:0},avatarOn:{margin:0,cursor:"pointer",backgroundColor:e.palette.primary.main}}}));var Re=function(){var e=O(),t=Object(w.a)(e,1)[0].searchType,a=Le();return r.a.createElement(F.a,{title:"Me"},r.a.createElement(Me.a,{className:"gps"===t?a.avatarOn:a.avatar},r.a.createElement(De.a,null)))},ze=a(586),Fe=a(574),Ie=a(572),We=a(571),Ze=a(573),Ae=a(588),Ge=a(568),Je=a(35),Ue=Object(T.a)((function(){return{dialog:{border:"1px solid #E0E0E0"}}}));var qe=function(){var e=S(),t=Object(w.a)(e,2),a=t[0],n=a.mapSettings,o=a.mapSettingsDialogOpen,i=t[1],c=function(){i({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!1})},l=Ue(),s=Object(Je.a)(),m=Object(Ge.a)(s.breakpoints.down("sm"));return r.a.createElement(ze.a,{fullScreen:m,disableBackdropClick:!0,open:o,onClose:c,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:l.dialog}},r.a.createElement(We.a,null,"Map settings"),r.a.createElement(Ie.a,null,r.a.createElement(Ze.a,{control:r.a.createElement(Ae.a,{checked:n.authorityBoundary,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"authorityBoundary"})},name:"sw_authority_boundary",color:"primary"}),label:"Library service boundaries"})),r.a.createElement(Fe.a,null,r.a.createElement(_.a,{onClick:c,color:"secondary"},"Close")))},He=Object(T.a)((function(e){return{settings:{position:"absolute",bottom:e.spacing(4),right:e.spacing(4)}}})),Ve=a(260),Ye=Object(Te.e)({minZoom:5,maxZoom:18,customAttribution:"Contains public sector information licensed under the Open Government Licence"}),$e=[Ve.libraryAuthorityTiles];var Ke=function(){var e=E(),t=Object(w.a)(e,2);Object(k.a)(t[0]),t[1];var a=O(),o=Object(w.a)(a,2),i=o[0],c=i.searchType,l=i.searchPosition,s=(o[1],S()),m=Object(w.a)(s,2),u=m[0],p=u.mapZoom,d=u.mapPosition,b=u.mapSettings,h=u.mapSettingsDialogOpen,g=m[1];Object(n.useEffect)((function(){}),[]);var f=He();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ye,{style:"style.json",center:d,zoom:p,maxZoom:17,pitch:[0],bearing:[0],fitBounds:null,containerStyle:{top:0,bottom:0,right:0,left:0,height:"100vh",width:"100vw",position:"absolute"}},r.a.createElement(Te.c,{id:"src_library_authorities",tileJsonSource:{type:"vector",tiles:$e}}),b.authorityBoundary?r.a.createElement(r.a.Fragment,null,r.a.createElement(Te.a,{id:"lyr_library_authorities_lines",type:"line",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],6,1,22,4]}}),r.a.createElement(Te.a,{id:"lyr_library_authorities_fill",type:"fill",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,paint:{"fill-color":"#ccc","fill-opacity":.1}})):null,l&&l.length>1?r.a.createElement(Te.b,{key:"mk_me",coordinates:[l[0],l[1]]},r.a.createElement(Re,{searchType:c})):null,r.a.createElement(Te.d,{position:"bottom-left"})),r.a.createElement(F.a,{title:"Map settings"},r.a.createElement(Ce.a,{size:"small",className:f.settings,color:"primary",style:{color:"white",border:"1px solid #FFFFFF"},onClick:function(){return g({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!0})}},r.a.createElement(_e.a,null))),r.a.createElement(qe,{mapSettings:b,mapSettingsDialogOpen:h}))},Qe=a(584),Xe=a(276),et=a.n(Xe);var tt=function(){var e=S(),t=Object(w.a)(e,2),a=t[0],n=a.notificationOpen,o=a.notificationMessage,i=t[1],c=function(){i({type:"SetNotification",notificationOpen:!1})};return r.a.createElement(Qe.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n,autoHideDuration:3e3,onClose:c,ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},o),action:[r.a.createElement(D.a,{key:"close","aria-label":"close",onClick:c},r.a.createElement(et.a,{color:"inherit"}))]})},at=Object(T.a)((function(e){return{content:{flexGrow:1,padding:e.spacing(2)},root:{flexGrow:1}}}));var nt=function(){var e=E(),t=Object(w.a)(e,2);Object(k.a)(t[0]),t[1],Object(n.useEffect)((function(){}),[]);var a=at();return r.a.createElement(x.a,null,r.a.createElement("div",{className:a.root},r.a.createElement(xe,{site:2}),r.a.createElement(C.a,{maxWidth:"lg"},r.a.createElement("main",{className:a.content},r.a.createElement(N.a,{path:"/",exact:!0,render:function(){return r.a.createElement(Ne,null)}}),r.a.createElement(N.a,{path:"/map",exact:!0,render:function(){return r.a.createElement(Ke,null)}}),r.a.createElement(N.a,{path:["/http:","/https:"],component:function(e){return window.location.replace(e.location.pathname.substr(1)),null}}))),r.a.createElement(tt,null)))},rt={},ot=function(e,t){return t.type,e},it={searchPostcode:"",searchType:"",searchDistance:1609,searchPosition:[]},ct=function(e,t){switch(t.type){case"SetSearchDistance":return Object(c.a)(Object(c.a)({},e),{},{searchDistance:t.searchDistance});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{searchPostcode:t.searchPostcode,searchPosition:t.searchPosition,searchType:"postcode"});default:return e}},lt={notificationOpen:!1,notificationMessage:"",mapZoom:[7],mapPosition:[-1.155414,52.691432],mapSettings:{authorityBoundary:!1},mapSettingsDialogOpen:!1,loadingPostcode:!1},st=function(e,t){switch(t.type){case"SetNotificationMessage":return Object(c.a)(Object(c.a)({},e),{},{notificationMessage:t.notificationMessage});case"SetNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:t.notificationOpen});case"ShowNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:!0,notificationMessage:t.notificationMessage});case"SetStopDialog":return Object(c.a)(Object(c.a)({},e),{},{stopDialogOpen:t.stopDialogOpen});case"SetMapSettingsDialog":return Object(c.a)(Object(c.a)({},e),{},{mapSettingsDialogOpen:t.mapSettingsDialogOpen});case"ToggleMapSetting":var a=e.mapSettings;return a[t.mapSetting]=!a[t.mapSetting],Object(c.a)(Object(c.a)({},e),{},{mapSettings:a});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{loadingPostcode:!1,mapPosition:t.mapPosition,mapZoom:[13]});case"SetMapPosition":return Object(c.a)(Object(c.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[t.mapZoom]});default:return e}},mt=Object(d.a)({palette:{primary:{main:p.a[800]},secondary:{main:m.a[700]}},overrides:{MuiButton:{text:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}},MuiTableCell:{root:{borderBottom:"none"}}}});var ut=function(){return r.a.createElement(g,{initialState:rt,reducer:ot},r.a.createElement(y,{initialState:it,reducer:ct},r.a.createElement(j,{initialState:lt,reducer:st},r.a.createElement(b.a,{theme:mt},r.a.createElement(l.a,null),r.a.createElement(nt,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ut,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[288,1,2]]]);
//# sourceMappingURL=main.0ea7ed51.chunk.js.map